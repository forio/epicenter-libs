/*! Epicenter v3.0.0 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.epicenter=e():t.epicenter=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=19)}([function(t,e,n){t.exports=n(20)},function(t,e){function n(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function s(t){n(a,o,i,s,c,"next",t)}function c(t){n(a,o,i,s,c,"throw",t)}s(void 0)}))}}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){var r=n(12),o=n(24);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?o(t):e}},function(t,e,n){var r=n(15);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){var r=n(21),o=n(22),i=n(23);t.exports=function(t,e){return r(t)||o(t,e)||i()}},function(t,e,n){var r=n(25);function o(e,n,i){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=o=Reflect.get:t.exports=o=function(t,e,n){var o=r(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},o(e,n,i||e)}t.exports=o},function(t,e,n){var r=n(29),o=n(30),i=n(31);t.exports=function(t){return r(t)||o(t)||i()}},function(t,e,n){var r=n(5),o=n(15),i=n(26),a=n(27);function s(e){var n="function"==typeof Map?new Map:void 0;return t.exports=s=function(t){if(null===t||!i(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return a(t,arguments,r(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o(e,t)},s(e)}t.exports=s},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=r=function(t){return n(t)}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},r(e)}t.exports=r},function(t,e,n){var r=n(28);t.exports=function(t,e){if(null==t)return{};var n,o,i=r(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}},function(t,e){var n=function(t){function e(){this.fetch=!1,this.DOMException=t.DOMException}return e.prototype=t,new e}("undefined"!=typeof self?self:this);!function(t){!function(e){var n={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(n.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(t){return t&&r.indexOf(Object.prototype.toString.call(t))>-1};function i(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function a(t){return"string"!=typeof t&&(t=String(t)),t}function s(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n.iterable&&(e[Symbol.iterator]=function(){return e}),e}function c(t){this.map={},t instanceof c?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function u(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function h(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function l(t){var e=new FileReader,n=h(e);return e.readAsArrayBuffer(t),n}function f(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:n.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:n.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():n.arrayBuffer&&n.blob&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=f(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||o(t))?this._bodyArrayBuffer=f(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var t=u(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(l)}),this.text=function(){var t,e,n,r=u(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=h(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(t,e){t=i(t),e=a(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},c.prototype.delete=function(t){delete this.map[i(t)]},c.prototype.get=function(t){return t=i(t),this.has(t)?this.map[t]:null},c.prototype.has=function(t){return this.map.hasOwnProperty(i(t))},c.prototype.set=function(t,e){this.map[i(t)]=a(e)},c.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},c.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),s(t)},c.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),s(t)},c.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),s(t)},n.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function m(t,e){var n,r,o=(e=e||{}).body;if(t instanceof m){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new c(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new c(e.headers)),this.method=(n=e.method||this.method||"GET",r=n.toUpperCase(),d.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function g(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}})),e}function y(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new c(e.headers),this.url=e.url||"",this._initBody(t)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},p.call(m.prototype),p.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},y.error=function(){var t=new y(null,{status:0,statusText:""});return t.type="error",t};var v=[301,302,303,307,308];y.redirect=function(t,e){if(-1===v.indexOf(e))throw new RangeError("Invalid status code");return new y(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function b(t,r){return new Promise((function(o,i){var a=new m(t,r);if(a.signal&&a.signal.aborted)return i(new e.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var t,e,n={status:s.status,statusText:s.statusText,headers:(t=s.getAllResponseHeaders()||"",e=new c,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}})),e)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var r="response"in s?s.response:s.responseText;o(new y(r,n))},s.onerror=function(){i(new TypeError("Network request failed"))},s.ontimeout=function(){i(new TypeError("Network request failed"))},s.onabort=function(){i(new e.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&n.blob&&(s.responseType="blob"),a.headers.forEach((function(t,e){s.setRequestHeader(e,t)})),a.signal&&(a.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",u)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}b.polyfill=!0,t.fetch||(t.fetch=b,t.Headers=c,t.Request=m,t.Response=y),e.Headers=c,e.Request=m,e.Response=y,e.fetch=b}({})}(n),delete n.fetch.polyfill,(e=n.fetch).default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,t.exports=e},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e,n){t.exports=function(){var t=function(){var t=0,e={};this.register=function(n){var r=++t;return e[r]=n,r},this.unregister=function(t){var n=e[t];return delete e[t],n},this.setTimeout=function(t,e){return window.setTimeout(t,e)},this.clearTimeout=function(t){window.clearTimeout(t)}};function e(){var t={};self.onmessage=function(e){var n=e.data,r=t[n.id];switch(n.type){case"setTimeout":t[n.id]=self.setTimeout((function(){delete t[n.id],self.postMessage({id:n.id})}),n.delay);break;case"clearTimeout":delete t[n.id],r&&self.clearTimeout(r);break;default:throw"Unknown command "+n.type}}}var n={isString:function(t){return null!=t&&("string"==typeof t||t instanceof String)},isArray:function(t){return null!=t&&t instanceof Array},inArray:function(t,e){for(var n=0;n<e.length;++n)if(t===e[n])return n;return-1}},r=function(){var t=[],e={};this.getTransportTypes=function(){return t.slice(0)},this.findTransportTypes=function(n,r,o){for(var i=[],a=0;a<t.length;++a){var s=t[a];!0===e[s].accept(n,r,o)&&i.push(s)}return i},this.negotiateTransport=function(n,r,o,i){for(var a=0;a<t.length;++a)for(var s=t[a],c=0;c<n.length;++c)if(s===n[c]){var u=e[s];if(!0===u.accept(r,o,i))return u}return null},this.add=function(n,r,o){for(var i=!1,a=0;a<t.length;++a)if(t[a]===n){i=!0;break}return i||("number"!=typeof o?t.push(n):t.splice(o,0,n),e[n]=r),!i},this.find=function(n){for(var r=0;r<t.length;++r)if(t[r]===n)return e[n];return null},this.remove=function(n){for(var r=0;r<t.length;++r)if(t[r]===n){t.splice(r,1);var o=e[n];return delete e[n],o}return null},this.clear=function(){t=[],e={}},this.reset=function(n){for(var r=0;r<t.length;++r)e[t[r]].reset(n)}},o=function(){var t,e,r;this.registered=function(n,r){t=n,e=r},this.unregistered=function(){t=null,e=null},this._debug=function(){e._debug.apply(e,arguments)},this._mixin=function(){return e._mixin.apply(e,arguments)},this.getConfiguration=function(){return e.getConfiguration()},this.getAdvice=function(){return e.getAdvice()},this.setTimeout=function(t,n){return e.setTimeout(t,n)},this.clearTimeout=function(t){e.clearTimeout(t)},this.convertToMessages=function(t){if(n.isString(t))try{return JSON.parse(t)}catch(e){throw this._debug("Could not convert to JSON the following string",'"'+t+'"'),e}if(n.isArray(t))return t;if(null==t)return[];if(t instanceof Object)return[t];throw"Conversion Error "+t+", typeof "+typeof t},this.accept=function(t,e,n){throw"Abstract"},this.getType=function(){return t},this.getURL=function(){return r},this.setURL=function(t){r=t},this.send=function(t,e){throw"Abstract"},this.reset=function(e){this._debug("Transport",t,"reset",e?"initial":"retry")},this.abort=function(){this._debug("Transport",t,"aborted")},this.toString=function(){return this.getType()}};o.derive=function(t){function e(){}return e.prototype=t,new e};var i=function(){var t=new o,e=o.derive(t),r=0,i=null,a=[],s=[];function c(t){for(;s.length>0;){var e=s[0],n=e[0],r=e[1];if(n.url!==t.url||n.sync!==t.sync)break;s.shift(),t.messages=t.messages.concat(n.messages),this._debug("Coalesced",n.messages.length,"messages from request",r.id)}}function u(t,e){if(this.transportSend(t,e),e.expired=!1,!t.sync){var n=this.getConfiguration().maxNetworkDelay,r=n;!0===e.metaConnect&&(r+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",r,"ms for the response, maxNetworkDelay",n);var o=this;e.timeout=this.setTimeout((function(){e.expired=!0;var n="Request "+e.id+" of transport "+o.getType()+" exceeded "+r+" ms max network delay",i={reason:n},a=e.xhr;i.httpCode=o.xhrStatus(a),o.abortXHR(a),o._debug(n),o.complete(e,!1,e.metaConnect),t.onFailure(a,t.messages,i)}),r)}}function h(t){var e=++r,n={id:e,metaConnect:!1,envelope:t};a.length<this.getConfiguration().maxConnections-1?(a.push(n),u.call(this,t,n)):(this._debug("Transport",this.getType(),"queueing request",e,"envelope",t),s.push([t,n]))}function l(t){var e=t.id;if(this._debug("Transport",this.getType(),"/meta/connect complete, request",e),null!==i&&i.id!==e)throw"/meta/connect request mismatch, completing request "+e;i=null}function f(t,e){var r=n.inArray(t,a);if(r>=0&&a.splice(r,1),s.length>0){var o=s.shift(),i=o[0],u=o[1];if(this._debug("Transport dequeued request",u.id),e)this.getConfiguration().autoBatch&&c.call(this,i),h.call(this,i),this._debug("Transport completed request",t.id,i);else{var l=this;this.setTimeout((function(){l.complete(u,!1,u.metaConnect);var t={reason:"Previous request failed"},e=u.xhr;t.httpCode=l.xhrStatus(e),i.onFailure(e,i.messages,t)}),0)}}}function p(t){if(null!==i)throw"Concurrent /meta/connect requests not allowed, request id="+i.id+" not yet completed";var e=++r;this._debug("Transport",this.getType(),"/meta/connect send, request",e,"envelope",t);var n={id:e,metaConnect:!0,envelope:t};u.call(this,t,n),i=n}return e.complete=function(t,e,n){n?l.call(this,t):f.call(this,t,e)},e.transportSend=function(t,e){throw"Abstract"},e.transportSuccess=function(t,e,n){e.expired||(this.clearTimeout(e.timeout),this.complete(e,!0,e.metaConnect),n&&n.length>0?t.onSuccess(n):t.onFailure(e.xhr,t.messages,{httpCode:204}))},e.transportFailure=function(t,e,n){e.expired||(this.clearTimeout(e.timeout),this.complete(e,!1,e.metaConnect),t.onFailure(e.xhr,t.messages,n))},e.send=function(t,e){e?p.call(this,t):h.call(this,t)},e.abort=function(){t.abort();for(var e=0;e<a.length;++e){var n=a[e];n&&(this._debug("Aborting request",n),this.abortXHR(n.xhr)||this.transportFailure(n.envelope,n,{reason:"abort"}))}var r=i;r&&(this._debug("Aborting /meta/connect request",r),this.abortXHR(r.xhr)||this.transportFailure(r.envelope,r,{reason:"abort"})),this.reset(!0)},e.reset=function(e){t.reset(e),i=null,a=[],s=[]},e.abortXHR=function(t){if(t)try{var e=t.readyState;return t.abort(),e!==window.XMLHttpRequest.UNSENT}catch(t){this._debug(t)}return!1},e.xhrStatus=function(t){if(t)try{return t.status}catch(t){this._debug(t)}return-1},e},a=function(){var t=new i,e=o.derive(t),n=!0;return e.accept=function(t,e,r){return n||!e},e.newXMLHttpRequest=function(){return new window.XMLHttpRequest},e.xhrSend=function(t){var n=e.newXMLHttpRequest();n.context=e.context,n.withCredentials=!0,n.open("POST",t.url,!0!==t.sync);var r=t.headers;if(r)for(var o in r)r.hasOwnProperty(o)&&n.setRequestHeader(o,r[o]);return n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.onload=function(){200===n.status?t.onSuccess(n.responseText):t.onError(n.statusText)},n.onabort=n.onerror=function(){t.onError(n.statusText)},n.send(t.body),n},e.transportSend=function(t,e){this._debug("Transport",this.getType(),"sending request",e.id,"envelope",t);var r=this;try{var o=!0;e.xhr=this.xhrSend({transport:this,url:t.url,sync:t.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(t.messages),onSuccess:function(o){r._debug("Transport",r.getType(),"received response",o);var i=!1;try{var a=r.convertToMessages(o);0===a.length?(n=!1,r.transportFailure(t,e,{httpCode:204})):(i=!0,r.transportSuccess(t,e,a))}catch(o){if(r._debug(o),!i){n=!1;var s={exception:o};s.httpCode=r.xhrStatus(e.xhr),r.transportFailure(t,e,s)}}},onError:function(i,a){r._debug("Transport",r.getType(),"received error",i,a),n=!1;var s={reason:i,exception:a};s.httpCode=r.xhrStatus(e.xhr),o?r.setTimeout((function(){r.transportFailure(t,e,s)}),0):r.transportFailure(t,e,s)}}),o=!1}catch(o){n=!1,this.setTimeout((function(){r.transportFailure(t,e,{exception:o})}),0)}},e.reset=function(e){t.reset(e),n=!0},e},s=function(){var t=new i,e=o.derive(t),n=0;function r(t,e,n){var r=this;return function(){r.transportFailure(t,e,"error",n)}}return e.accept=function(t,e,n){return!0},e.jsonpSend=function(t){var e=document.getElementsByTagName("head")[0],r=document.createElement("script"),o="_cometd_jsonp_"+n++;window[o]=function(n){e.removeChild(r),delete window[o],t.onSuccess(n)};var i=t.url;i+=i.indexOf("?")<0?"?":"&",i+="jsonp="+o,i+="&message="+encodeURIComponent(t.body),r.src=i,r.async=!0!==t.sync,r.type="application/javascript",r.onerror=function(e){t.onError("jsonp "+e.type)},e.appendChild(r)},e.transportSend=function(t,e){for(var n=this,o=0,i=t.messages.length,a=[];i>0;){var s=JSON.stringify(t.messages.slice(o,o+i)),c=t.url.length+encodeURI(s).length,u=this.getConfiguration().maxURILength;if(c>u){if(1===i){var h="Bayeux message too big ("+c+" bytes, max is "+u+") for transport "+this.getType();return void this.setTimeout(r.call(this,t,e,h),0)}--i}else a.push(i),o+=i,i=t.messages.length-o}var l=t;if(a.length>1){var f=0,p=a[0];this._debug("Transport",this.getType(),"split",t.messages.length,"messages into",a.join(" + ")),(l=this._mixin(!1,{},t)).messages=t.messages.slice(f,p),l.onSuccess=t.onSuccess,l.onFailure=t.onFailure;for(var d=1;d<a.length;++d){var m=this._mixin(!1,{},t);f=p,p+=a[d],m.messages=t.messages.slice(f,p),m.onSuccess=t.onSuccess,m.onFailure=t.onFailure,this.send(m,e.metaConnect)}}this._debug("Transport",this.getType(),"sending request",e.id,"envelope",l);try{var g=!0;this.jsonpSend({transport:this,url:l.url,sync:l.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(l.messages),onSuccess:function(t){var r=!1;try{var o=n.convertToMessages(t);0===o.length?n.transportFailure(l,e,{httpCode:204}):(r=!0,n.transportSuccess(l,e,o))}catch(t){n._debug(t),r||n.transportFailure(l,e,{exception:t})}},onError:function(t,r){var o={reason:t,exception:r};g?n.setTimeout((function(){n.transportFailure(l,e,o)}),0):n.transportFailure(l,e,o)}}),g=!1}catch(t){this.setTimeout((function(){n.transportFailure(l,e,{exception:t})}),0)}},e},c=function(){var t,e=new o,r=o.derive(e),i=!0,a=!1,s=!0,c=null,u=null,h=!1,l=null;function f(t,e){t&&(this.webSocketClose(t,e.code,e.reason),this.onClose(t,e))}function p(t){return t===u||t===c}function d(t,e,n){for(var r=[],o=0;o<e.messages.length;++o){var i=e.messages[o];i.id&&r.push(i.id)}t.envelopes[r.join(",")]=[e,n],this._debug("Transport",this.getType(),"stored envelope, envelopes",t.envelopes)}function m(e){if(!u){var n=t.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",n);try{var r=t.getConfiguration().protocol;e.webSocket=r?new window.WebSocket(n,r):new window.WebSocket(n),u=e}catch(t){throw i=!1,this._debug("Exception while creating WebSocket object",t),t}s=!1!==t.getConfiguration().stickyReconnect;var o=this,h=t.getConfiguration().connectTimeout;h>0&&(e.connectTimer=this.setTimeout((function(){t._debug("Transport",o.getType(),"timed out while connecting to URL",n,":",h,"ms"),f.call(o,e,{code:1e3,reason:"Connect Timeout"})}),h));var l=function(n){n=n||{code:1e3},t._debug("WebSocket onclose",e,n,"connecting",u,"current",c),e.connectTimer&&o.clearTimeout(e.connectTimer),o.onClose(e,n)};e.webSocket.onopen=function(){t._debug("WebSocket onopen",e),e.connectTimer&&o.clearTimeout(e.connectTimer),p(e)?(u=null,c=e,a=!0,o.onOpen(e)):(t._warn("Closing extra WebSocket connection",this,"active connection",c),f.call(o,e,{code:1e3,reason:"Extra Connection"}))},e.webSocket.onclose=l,e.webSocket.onerror=function(){l({code:1e3,reason:"Error"})},e.webSocket.onmessage=function(n){t._debug("WebSocket onmessage",n,e),o.onMessage(e,n)},this._debug("Transport",this.getType(),"configured callbacks on",e)}}function g(e,n,r){var o=JSON.stringify(n.messages);e.webSocket.send(o),this._debug("Transport",this.getType(),"sent",n,"/meta/connect =",r);var i=this.getConfiguration().maxNetworkDelay,a=i;r&&(a+=this.getAdvice().timeout,h=!0);for(var s=this,c=[],u=0;u<n.messages.length;++u)!function(){var r=n.messages[u];r.id&&(c.push(r.id),e.timeouts[r.id]=s.setTimeout((function(){t._debug("Transport",s.getType(),"timing out message",r.id,"after",a,"on",e),f.call(s,e,{code:1e3,reason:"Message Timeout"})}),a))}();this._debug("Transport",this.getType(),"waiting at most",a,"ms for messages",c,"maxNetworkDelay",i,", timeouts:",e.timeouts)}function y(t,e,n){try{null===t?(t=u||{envelopes:{},timeouts:{}},d.call(this,t,e,n),m.call(this,t)):(d.call(this,t,e,n),g.call(this,t,e,n))}catch(e){var r=this;this.setTimeout((function(){f.call(r,t,{code:1e3,reason:"Exception",exception:e})}),0)}}return r.reset=function(t){e.reset(t),i=!0,t&&(a=!1),s=!0,c=null,u=null,h=!1},r._notifySuccess=function(t,e){t.call(this,e)},r._notifyFailure=function(t,e,n,r){t.call(this,e,n,r)},r.onOpen=function(t){var e=t.envelopes;for(var n in this._debug("Transport",this.getType(),"opened",t,"pending messages",e),e)if(e.hasOwnProperty(n)){var r=e[n],o=r[0],i=r[1];l=o.onSuccess,g.call(this,t,o,i)}},r.onMessage=function(t,e){this._debug("Transport",this.getType(),"received websocket message",e,t);for(var r=!1,o=this.convertToMessages(e.data),i=[],a=0;a<o.length;++a){var s=o[a];if((/^\/meta\//.test(s.channel)||void 0===s.data)&&s.id){i.push(s.id);var c=t.timeouts[s.id];c&&(this.clearTimeout(c),delete t.timeouts[s.id],this._debug("Transport",this.getType(),"removed timeout for message",s.id,", timeouts",t.timeouts))}"/meta/connect"===s.channel&&(h=!1),"/meta/disconnect"!==s.channel||h||(r=!0)}for(var u=!1,f=t.envelopes,p=0;p<i.length;++p){var d=i[p];for(var m in f)if(f.hasOwnProperty(m)){var g=m.split(","),y=n.inArray(d,g);if(y>=0){u=!0,g.splice(y,1);var v=f[m][0],b=f[m][1];delete f[m],g.length>0&&(f[g.join(",")]=[v,b]);break}}}u&&this._debug("Transport",this.getType(),"removed envelope, envelopes",f),this._notifySuccess(l,o),r&&this.webSocketClose(t,1e3,"Disconnect")},r.onClose=function(t,e){this._debug("Transport",this.getType(),"closed",t,e),p(t)&&(i=s&&a,u=null,c=null);var n=t.timeouts;for(var r in t.timeouts={},n)n.hasOwnProperty(r)&&this.clearTimeout(n[r]);var o=t.envelopes;for(var l in t.envelopes={},o)if(o.hasOwnProperty(l)){var f=o[l][0];o[l][1]&&(h=!1);var d={websocketCode:e.code,reason:e.reason};e.exception&&(d.exception=e.exception),this._notifyFailure(f.onFailure,t,f.messages,d)}},r.registered=function(n,r){e.registered(n,r),t=r},r.accept=function(e,n,r){return this._debug("Transport",this.getType(),"accept, supported:",i),i&&!!window.WebSocket&&!1!==t.websocketEnabled},r.send=function(t,e){this._debug("Transport",this.getType(),"sending",t,"/meta/connect =",e),y.call(this,c,t,e)},r.webSocketClose=function(t,e,n){try{t.webSocket&&t.webSocket.close(e,n)}catch(t){this._debug(t)}},r.abort=function(){e.abort(),f.call(this,c,{code:1e3,reason:"Abort"}),this.reset(!0)},r},u=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",".","-",":","+","=","^","!","/","*","?","&","<",">","(",")","[","]","{","}","@","%","$","#"],h=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0];return{CometD:function(o){var i,u,h,l,f,p=new t,d=this,m=o||"default",g=!1,y=new r,v="disconnected",b=0,w=null,x=0,k=[],S=!1,T=0,_={},E=0,O=null,N=[],j={},A={},P={},R=!1,C=!1,I=0,L=0,U=null,D={useWorkerScheduler:!0,protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,urls:{},maxURILength:2e3,advice:{timeout:6e4,interval:0,reconnect:void 0,maxInterval:0}};function B(t,e){try{return t[e]}catch(t){return}}function M(t){return n.isString(t)}function F(t){return null!=t&&"function"==typeof t}function q(t,e){for(var n="";--e>0&&!(t>=Math.pow(10,e));)n+="0";return n+=t}function H(t,e){if(window.console){var n=window.console[t];if(F(n)){var r=new Date;[].splice.call(e,0,0,q(r.getHours(),2)+":"+q(r.getMinutes(),2)+":"+q(r.getSeconds(),2)+"."+q(r.getMilliseconds(),3)),n.apply(window.console,e)}}}function K(t){return new RegExp("(^https?://)?(((\\[[^\\]]+])|([^:/?#]+))(:(\\d+))?)?([^?#]*)(.*)?").exec(t)}function X(t){d._debug("Configuring cometd object with",t),M(t)&&(t={url:t}),t||(t={}),D=d._mixin(!1,D,t);var n=d.getURL();if(!n)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var r=K(n),o=r[2],i=r[8],a=r[9];if(g=d._isCrossDomain(o),D.appendMessageTypeToURL)if(void 0!==a&&a.length>0)d._info("Appending message type to URI "+i+a+" is not supported, disabling 'appendMessageTypeToURL' configuration"),D.appendMessageTypeToURL=!1;else{var s=i.split("/"),c=s.length-1;i.match(/\/$/)&&(c-=1),s[c].indexOf(".")>=0&&(d._info("Appending message type to URI "+i+" is not supported, disabling 'appendMessageTypeToURL' configuration"),D.appendMessageTypeToURL=!1)}if(window.Worker&&window.Blob&&window.URL&&D.useWorkerScheduler){var u=e.toString();u=u.substring(u.indexOf("{")+1,u.lastIndexOf("}"));var h=new window.Blob([u],{type:"application/json"}),l=window.URL.createObjectURL(h),f=new window.Worker(l);p.setTimeout=function(t,e){var n=p.register(t);return f.postMessage({id:n,type:"setTimeout",delay:e}),n},p.clearTimeout=function(t){p.unregister(t),f.postMessage({id:t,type:"clearTimeout"})},f.onmessage=function(t){var e=t.data.id,n=p.unregister(e);n&&n()}}}function W(t){if(t){var e=_[t.channel];e&&e[t.id]&&(delete e[t.id],d._debug("Removed",t.listener?"listener":"subscription",t))}}function G(t){t&&!t.listener&&W(t)}function J(){for(var t in _)if(_.hasOwnProperty(t)){var e=_[t];if(e)for(var n in e)e.hasOwnProperty(n)&&G(e[n])}}function V(t){v!==t&&(d._debug("Status",v,"->",t),v=t)}function z(){return"disconnecting"===v||"disconnected"===v}function Y(){return""+ ++b}function $(t,e,n,r,o){try{return e.call(t,r)}catch(t){var i=d.onExtensionException;if(F(i)){d._debug("Invoking extension exception handler",n,t);try{i.call(d,t,n,o,r)}catch(t){d._info("Exception during execution of extension exception handler",n,t)}}else d._info("Exception during execution of extension",n,t);return r}}function Z(t){for(var e=N.length-1;e>=0&&null!=t;--e){var n=N[e],r=n.extension.outgoing;if(F(r)){var o=$(n.extension,r,n.name,t,!0);t=void 0===o?t:o}}return t}function Q(t,e){var n=_[t];if(n)for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];if(o)try{o.callback.call(o.scope,e)}catch(t){var i=d.onListenerException;if(F(i)){d._debug("Invoking listener exception handler",o,t);try{i.call(d,t,o,o.listener,e)}catch(t){d._info("Exception during execution of listener exception handler",o,t)}}else d._info("Exception during execution of listener",o,e,t)}}}function tt(t,e){Q(t,e);for(var n=t.split("/"),r=n.length-1,o=r;o>0;--o){var i=n.slice(0,o).join("/")+"/*";o===r&&Q(i,e),Q(i+="*",e)}}function et(){null!==O&&d.clearTimeout(O),O=null}function nt(t,e){et();var n=j.interval+e;d._debug("Function scheduled in",n,"ms, interval =",j.interval,"backoff =",E,t),O=d.setTimeout(t,n)}function rt(t,e,n,r){for(var o=0;o<e.length;++o){var a=e[o],s=a.id;w&&(a.clientId=w),null!=(a=Z(a))?(a.id=s,e[o]=a):(delete A[s],e.splice(o--,1))}if(0!==e.length){n&&(U=e[0]);var c=d.getURL();D.appendMessageTypeToURL&&(c.match(/\/$/)||(c+="/"),r&&(c+=r));var u={url:c,sync:t,messages:e,onSuccess:function(t){try{l.call(d,t)}catch(t){d._info("Exception during handling of messages",t)}},onFailure:function(t,e,n){try{var r=d.getTransport();n.connectionType=r?r.getType():"unknown",f.call(d,t,e,n)}catch(t){d._info("Exception during handling of failure",t)}}};d._debug("Send",u),i.send(u,n)}}function ot(t){x>0||!0===S?k.push(t):rt(!1,[t],!1)}function it(){E=0}function at(){var t=k;k=[],t.length>0&&rt(!1,t,!1)}function st(t){V("connecting"),nt((function(){!function(){if(!z()){var t={id:Y(),channel:"/meta/connect",connectionType:i.getType()};C||(t.advice={timeout:0}),V("connecting"),d._debug("Connect sent",t),rt(!1,[t],!0,"connect"),V("connected")}}()}),t)}function ct(t){t&&(j=d._mixin(!1,{},D.advice,t),d._debug("New advice",j))}function ut(t){if(et(),t&&i&&i.abort(),g=!1,i=null,V("disconnected"),w=null,x=0,it(),R=!1,C=!1,I=0,U=null,k.length>0){var e=k;k=[],f.call(d,void 0,e,{reason:"Disconnected"})}}function ht(t,e,n){var r=d.onTransportException;if(F(r)){d._debug("Invoking transport exception handler",t,e,n);try{r.call(d,n,t,e)}catch(t){d._info("Exception during execution of transport exception handler",t)}}}function lt(t,e){F(t)&&(e=t,t=void 0),w=null,J(),z()&&y.reset(!0),ct({}),x=0,S=!0,u=t,h=e;var n=d.getURL(),r=y.findTransportTypes("1.0",g,n),o={id:Y(),version:"1.0",minimumVersion:"1.0",channel:"/meta/handshake",supportedConnectionTypes:r,advice:{timeout:j.timeout,interval:j.interval}},a=d._mixin(!1,{},u,o);if(d._putCallback(a.id,e),!i&&!(i=y.negotiateTransport(r,"1.0",g,n))){var s="Could not find initial transport among: "+y.getTransportTypes();throw d._warn(s),s}d._debug("Initial transport is",i.getType()),V("handshaking"),d._debug("Handshake sent",a),rt(!1,[a],!1,"handshake")}function ft(t,e){try{t.call(d,e)}catch(t){var n=d.onCallbackException;if(F(n)){d._debug("Invoking callback exception handler",t);try{n.call(d,t,e)}catch(t){d._info("Exception during execution of callback exception handler",t)}}else d._info("Exception during execution of message callback",t)}}function pt(t){var e=d._getCallback([t.id]);F(e)&&(delete A[t.id],ft(e,t))}function dt(t){var e=P[t.id];if(delete P[t.id],e){d._debug("Handling remote call response for",t,"with context",e);var n=e.timeout;n&&d.clearTimeout(n);var r=e.callback;if(F(r))return ft(r,t),!0}return!1}function mt(t){d._debug("Transport failure handling",t),t.transport&&(i=t.transport),t.url&&i.setURL(t.url);var e=t.action,n=t.delay||0;switch(e){case"handshake":!function(t){V("handshaking"),S=!0,nt((function(){lt(u,h)}),t)}(n);break;case"retry":st(n);break;case"none":ut(!0);break;default:throw"Unknown action "+e}}function gt(t,e){pt(t),tt("/meta/handshake",t),tt("/meta/unsuccessful",t),z()&&(e.action="none"),d.onTransportFailure.call(d,t,e,mt)}function yt(t){gt(t,{cause:"failure",action:"handshake",transport:null})}function vt(t){return"disconnected"===v||!(!U||U.id!==t.id)&&(U=null,!0)}function bt(t,e){tt("/meta/connect",t),tt("/meta/unsuccessful",t),z()&&(e.action="none"),d.onTransportFailure.call(d,t,e,mt)}function wt(t){vt(t)?(C=!1,bt(t,{cause:"failure",action:"retry",transport:null})):d._debug("Mismatched /meta/connect failure",t)}function xt(t){ut(!0),pt(t),tt("/meta/disconnect",t),tt("/meta/unsuccessful",t)}function kt(t){xt(t)}function St(t){var e=_[t.subscription];if(e)for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r&&!r.listener&&(delete e[n],d._debug("Removed failed subscription",r))}pt(t),tt("/meta/subscribe",t),tt("/meta/unsuccessful",t)}function Tt(t){St(t)}function _t(t){pt(t),tt("/meta/unsubscribe",t),tt("/meta/unsuccessful",t)}function Et(t){_t(t)}function Ot(t){dt(t)||(pt(t),tt("/meta/publish",t),tt("/meta/unsuccessful",t))}function Nt(t){Ot(t)}function jt(t){if(I=0,null!=(t=function(t){for(var e=0;e<N.length&&null!=t;++e){var n=N[e],r=n.extension.incoming;if(F(r)){var o=$(n.extension,r,n.name,t,!1);t=void 0===o?t:o}}return t}(t)))switch(ct(t.advice),t.channel){case"/meta/handshake":!function(t){var e=d.getURL();if(t.successful){var n=d._isCrossDomain(K(e)[2]),r=y.negotiateTransport(t.supportedConnectionTypes,t.version,n,e);if(null===r)return t.successful=!1,void gt(t,{cause:"negotiation",action:"none",transport:null});i!==r&&(d._debug("Transport",i.getType(),"->",r.getType()),i=r),w=t.clientId,S=!1,at(),t.reestablish=R,R=!0,pt(t),tt("/meta/handshake",t),L=t["x-messages"]||0;var o=z()?"none":j.reconnect||"retry";switch(o){case"retry":it(),0===L?st(0):d._debug("Processing",L,"handshake-delivered messages");break;case"none":ut(!0);break;default:throw"Unrecognized advice action "+o}}else gt(t,{cause:"unsuccessful",action:j.reconnect||"handshake",transport:i})}(t);break;case"/meta/connect":!function(t){if(vt(t))if(C=t.successful){tt("/meta/connect",t);var e=z()?"none":j.reconnect||"retry";switch(e){case"retry":it(),st(E);break;case"none":ut(!1);break;default:throw"Unrecognized advice action "+e}}else bt(t,{cause:"unsuccessful",action:j.reconnect||"retry",transport:i});else d._debug("Mismatched /meta/connect reply",t)}(t);break;case"/meta/disconnect":!function(t){t.successful?(ut(!1),pt(t),tt("/meta/disconnect",t)):xt(t)}(t);break;case"/meta/subscribe":!function(t){t.successful?(pt(t),tt("/meta/subscribe",t)):St(t)}(t);break;case"/meta/unsubscribe":!function(t){t.successful?(pt(t),tt("/meta/unsubscribe",t)):_t(t)}(t);break;default:!function(t){void 0!==t.data?dt(t)||(tt(t.channel,t),L>0&&0==--L&&(d._debug("Processed last handshake-delivered message"),st(0))):void 0===t.successful?d._warn("Unknown Bayeux Message",t):t.successful?(pt(t),tt("/meta/publish",t)):Ot(t)}(t)}}function At(t){var e=_[t];if(e)for(var n in e)if(e.hasOwnProperty(n)&&e[n])return!0;return!1}function Pt(t,e){var n={scope:t,method:e};if(F(t))n.scope=void 0,n.method=t;else if(M(e)){if(!t)throw"Invalid scope "+t;if(n.method=t[e],!F(n.method))throw"Invalid callback "+e+" for scope "+t}else if(!F(e))throw"Invalid callback "+e;return n}function Rt(t,e,n,r){var o=Pt(e,n);d._debug("Adding",r?"listener":"subscription","on",t,"with scope",o.scope,"and callback",o.method);var i=++T,a={id:i,channel:t,scope:o.scope,callback:o.method,listener:r},s=_[t];return s||(s={},_[t]=s),s[i]=a,d._debug("Added",r?"listener":"subscription",a),a}this._mixin=function(t,e,n){for(var r=e||{},o=2;o<arguments.length;++o){var i=arguments[o];if(null!=i)for(var a in i)if(i.hasOwnProperty(a)){var s=B(i,a),c=B(r,a);if(s===e)continue;if(void 0===s)continue;if(t&&"object"==typeof s&&null!==s)if(s instanceof Array)r[a]=this._mixin(t,c instanceof Array?c:[],s);else{var u="object"!=typeof c||c instanceof Array?{}:c;r[a]=this._mixin(t,u,s)}else r[a]=s}}return r},this._warn=function(){H("warn",arguments)},this._info=function(){"warn"!==D.logLevel&&H("info",arguments)},this._debug=function(){"debug"===D.logLevel&&H("debug",arguments)},this._isCrossDomain=function(t){return!!(window.location&&window.location.host&&t)&&t!==window.location.host},this.send=ot,this._getCallback=function(t){return A[t]},this._putCallback=function(t,e){var n=this._getCallback(t);return F(e)&&(A[t]=e),n},this.onTransportFailure=function(t,e,n){this._debug("Transport failure",e,"for",t);var r=this.getTransportRegistry(),o=this.getURL(),a=this._isCrossDomain(K(o)[2]),s=r.findTransportTypes("1.0",a,o);if("none"===e.action){if("/meta/handshake"===t.channel&&!e.transport){var c="Could not negotiate transport, client=["+s+"], server=["+t.supportedConnectionTypes+"]";this._warn(c),ht(i.getType(),null,{reason:c,connectionType:i.getType(),transport:i})}}else if(e.delay=this.getBackoffPeriod(),"/meta/handshake"===t.channel){if(!e.transport){var u=r.negotiateTransport(s,"1.0",a,o);u?(this._debug("Transport",i.getType(),"->",u.getType()),ht(i.getType(),u.getType(),t.failure),e.action="handshake",e.transport=u):(this._warn("Could not negotiate transport, client=["+s+"]"),ht(i.getType(),null,t.failure),e.action="none")}"none"!==e.action&&this.increaseBackoffPeriod()}else{var h=(new Date).getTime();if(0===I&&(I=h),"retry"===e.action){e.delay=this.increaseBackoffPeriod();var l=j.maxInterval;if(l>0){var f=j.timeout+j.interval+l;h-I+E>f&&(e.action="handshake")}}"handshake"===e.action&&(e.delay=0,r.reset(!1),this.resetBackoffPeriod())}n.call(d,e)},this.receive=jt,l=function(t){d._debug("Received",t);for(var e=0;e<t.length;++e)jt(t[e])},f=function(t,e,n){d._debug("handleFailure",t,e,n),n.transport=t;for(var r=0;r<e.length;++r){var o=e[r],i={id:o.id,successful:!1,channel:o.channel,failure:n};switch(n.message=o,o.channel){case"/meta/handshake":yt(i);break;case"/meta/connect":wt(i);break;case"/meta/disconnect":kt(i);break;case"/meta/subscribe":i.subscription=o.subscription,Tt(i);break;case"/meta/unsubscribe":i.subscription=o.subscription,Et(i);break;default:Nt(i)}}},this.registerTransport=function(t,e,n){var r=y.add(t,e,n);return r&&(this._debug("Registered transport",t),F(e.registered)&&e.registered(t,this)),r},this.unregisterTransport=function(t){var e=y.remove(t);return null!==e&&(this._debug("Unregistered transport",t),F(e.unregistered)&&e.unregistered()),e},this.unregisterTransports=function(){y.clear()},this.getTransportTypes=function(){return y.getTransportTypes()},this.findTransport=function(t){return y.find(t)},this.getTransportRegistry=function(){return y},this.configure=function(t){X.call(this,t)},this.init=function(t,e){this.configure(t),this.handshake(e)},this.handshake=function(t,e){if("disconnected"!==v)throw"Illegal state: handshaken";lt(t,e)},this.disconnect=function(t,e,n){if(!z()){"boolean"!=typeof t&&(n=e,e=t,t=!1),F(e)&&(n=e,e=void 0);var r={id:Y(),channel:"/meta/disconnect"},o=this._mixin(!1,{},e,r);d._putCallback(o.id,n),V("disconnecting"),rt(!0===t,[o],!1,"disconnect")}},this.startBatch=function(){++x,d._debug("Starting batch, depth",x)},this.endBatch=function(){!function(){if(--x,d._debug("Ending batch, depth",x),x<0)throw"Calls to startBatch() and endBatch() are not paired";0!==x||z()||S||at()}()},this.batch=function(t,e){var n=Pt(t,e);this.startBatch();try{n.method.call(n.scope),this.endBatch()}catch(t){throw this._info("Exception during execution of batch",t),this.endBatch(),t}},this.addListener=function(t,e,n){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!M(t))throw"Illegal argument type: channel must be a string";return Rt(t,e,n,!0)},this.removeListener=function(t){if(!(t&&t.channel&&"id"in t))throw"Invalid argument: expected subscription, not "+t;W(t)},this.clearListeners=function(){_={}},this.subscribe=function(t,e,n,r,o){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!M(t))throw"Illegal argument type: channel must be a string";if(z())throw"Illegal state: disconnected";F(e)&&(o=r,r=n,n=e,e=void 0),F(r)&&(o=r,r=void 0);var i=!At(t),a=Rt(t,e,n,!1);if(i){var s={id:Y(),channel:"/meta/subscribe",subscription:t},c=this._mixin(!1,{},r,s);d._putCallback(c.id,o),ot(c)}return a},this.unsubscribe=function(t,e,n){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(z())throw"Illegal state: disconnected";F(e)&&(n=e,e=void 0),this.removeListener(t);var r=t.channel;if(!At(r)){var o={id:Y(),channel:"/meta/unsubscribe",subscription:r},i=this._mixin(!1,{},e,o);d._putCallback(i.id,n),ot(i)}},this.resubscribe=function(t,e){if(G(t),t)return this.subscribe(t.channel,t.scope,t.callback,e)},this.clearSubscriptions=function(){J()},this.publish=function(t,e,n,r){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!M(t))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(t))throw"Illegal argument: cannot publish to meta channels";if(z())throw"Illegal state: disconnected";F(e)?(r=e,e={},n=void 0):F(n)&&(r=n,n=void 0);var o={id:Y(),channel:t,data:e},i=this._mixin(!1,{},n,o);d._putCallback(i.id,r),ot(i)},this.publishBinary=function(t,e,n,r,o){F(e)?(o=e,e=new ArrayBuffer(0),n=!0,r=void 0):F(n)?(o=n,n=!0,r=void 0):F(r)&&(o=r,r=void 0);var i={meta:r,data:e,last:n};this.publish(t,i,{ext:{binary:{}}},o)},this.remoteCall=function(t,e,n,r,o){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!M(t))throw"Illegal argument type: target must be a string";if(z())throw"Illegal state: disconnected";if(F(e)?(o=e,e={},n=D.maxNetworkDelay,r=void 0):F(n)?(o=n,n=D.maxNetworkDelay,r=void 0):F(r)&&(o=r,r=void 0),"number"!=typeof n)throw"Illegal argument type: timeout must be a number";t.match(/^\//)||(t="/"+t);var i="/service"+t,a={id:Y(),channel:i,data:e},s=this._mixin(!1,{},r,a),c={callback:o};n>0&&(c.timeout=d.setTimeout((function(){d._debug("Timing out remote call",s,"after",n,"ms"),Ot({id:s.id,error:"406::timeout",successful:!1,failure:{message:s,reason:"Remote Call Timeout"}})}),n),d._debug("Scheduled remote call timeout",s,"in",n,"ms")),P[s.id]=c,ot(s)},this.remoteCallBinary=function(t,e,n,r,o,i){F(e)?(i=e,e=new ArrayBuffer(0),n=!0,r=void 0,o=D.maxNetworkDelay):F(n)?(i=n,n=!0,r=void 0,o=D.maxNetworkDelay):F(r)?(i=r,r=void 0,o=D.maxNetworkDelay):F(o)&&(i=o,o=D.maxNetworkDelay);var a={meta:r,data:e,last:n};this.remoteCall(t,a,o,{ext:{binary:{}}},i)},this.getStatus=function(){return v},this.isDisconnected=z,this.setBackoffIncrement=function(t){D.backoffIncrement=t},this.getBackoffIncrement=function(){return D.backoffIncrement},this.getBackoffPeriod=function(){return E},this.increaseBackoffPeriod=function(){return E<D.maxBackoff&&(E+=D.backoffIncrement),E},this.resetBackoffPeriod=function(){it()},this.setLogLevel=function(t){D.logLevel=t},this.registerExtension=function(t,e){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!M(t))throw"Illegal argument type: extension name must be a string";for(var n=!1,r=0;r<N.length;++r){var o=N[r];if(o.name===t){n=!0;break}}return n?(this._info("Could not register extension with name",t,"since another extension with the same name already exists"),!1):(N.push({name:t,extension:e}),this._debug("Registered extension",t),F(e.registered)&&e.registered(t,this),!0)},this.unregisterExtension=function(t){if(!M(t))throw"Illegal argument type: extension name must be a string";for(var e=!1,n=0;n<N.length;++n){var r=N[n];if(r.name===t){N.splice(n,1),e=!0,this._debug("Unregistered extension",t);var o=r.extension;F(o.unregistered)&&o.unregistered();break}}return e},this.getExtension=function(t){for(var e=0;e<N.length;++e){var n=N[e];if(n.name===t)return n.extension}return null},this.getName=function(){return m},this.getClientId=function(){return w},this.getURL=function(){if(i){var t=i.getURL();if(t)return t;if(t=D.urls[i.getType()])return t}return D.url},this.getTransport=function(){return i},this.getConfiguration=function(){return this._mixin(!0,{},D)},this.getAdvice=function(){return this._mixin(!0,{},j)},this.setTimeout=function(t,e){return p.setTimeout((function(){try{d._debug("Invoking timed function",t),t()}catch(e){d._debug("Exception invoking timed function",t,e)}}),e)},this.clearTimeout=function(t){p.clearTimeout(t)},window.WebSocket&&this.registerTransport("websocket",new c),this.registerTransport("long-polling",new a),this.registerTransport("callback-polling",new s)},Transport:o,RequestTransport:i,LongPollingTransport:a,CallbackPollingTransport:s,WebSocketTransport:c,Utils:n,Z85:{encode:function(t){var e=null;if(t instanceof ArrayBuffer?e=t:t.buffer instanceof ArrayBuffer?e=t.buffer:Array.isArray(t)&&(e=new Uint8Array(t).buffer),null==e)throw"Cannot Z85 encode "+t;for(var n=e.byteLength,r=n%4,o=4-(0===r?4:r),i=new DataView(e),a="",s=0,c=0;c<n+o;++c){var h=c>=n;if(s=256*s+(h?0:i.getUint8(c)),(c+1)%4==0){for(var l=52200625,f=5;f>0;--f){if(!h||f>o){var p=Math.floor(s/l)%85;a+=u[p]}l/=85}s=0}}return a},decode:function(t){for(var e=t.length%5,n=5-(0===e?5:e),r=0;r<n;++r)t+=u[u.length-1];for(var o=t.length,i=new ArrayBuffer(4*o/5-n),a=new DataView(i),s=0,c=0,l=0,f=0;f<o;++f){var p=t.charCodeAt(c++)-32;if(s=85*s+h[p],c%5==0){for(var d=16777216;d>=1;)l<a.byteLength&&a.setUint8(l++,Math.floor(s/d)%256),d/=256;s=0}}return i}}}}()},function(t,e,n){t.exports=n(16).AckExtension=function(){var t,e,n=!1;function r(e,n){t._debug(e,n)}this.registered=function(e,n){t=n,r("AckExtension: executing registration callback")},this.unregistered=function(){r("AckExtension: executing unregistration callback"),t=null},this.incoming=function(t){var o=t.channel,i=t.ext;if("/meta/handshake"===o){if(i){var a=i.ack;if("object"==typeof a){n=!0===a.enabled;var s=a.batch;"number"==typeof s&&(e=s)}else n=!0===a}r("AckExtension: server supports acknowledgements",n)}else"/meta/connect"===o&&t.successful&&n&&i&&"number"==typeof i.ack&&r("AckExtension: server sent batch",e=i.ack);return t},this.outgoing=function(o){var i=o.channel;return o.ext||(o.ext={}),"/meta/handshake"===i?(o.ext.ack=t&&!1!==t.ackEnabled,n=!1,e=0):"/meta/connect"===i&&n&&(o.ext.ack=e,r("AckExtension: client sending batch",e)),o}}},function(t,e,n){t.exports=n(16).ReloadExtension=function(t){var e,n,r={},o="org.cometd.reload",i=!1,a=!1;function s(t){if(r.handshakeResponse){a=!0;var i=e.getTransport();i&&i.abort(),c(t);var s=JSON.stringify(r);n("Reload extension saving state",s),window.sessionStorage.setItem(o,s)}}function c(t){t&&"string"==typeof t.name&&(o=t.name)}this.configure=c,this._receive=function(t){e.receive(t)},this.registered=function(t,r){(e=r).reload=s,n=e._debug},this.unregistered=function(){delete e.reload,e=null},this.outgoing=function(t){switch(t.channel){case"/meta/handshake":(r={}).url=e.getURL();var s=window.sessionStorage.getItem(o);if(n("Reload extension found state",s),s)try{var c=JSON.parse(s);if(window.sessionStorage.removeItem(o),c.handshakeResponse&&function(t){return r.url===t.url}(c)){n("Reload extension restoring state",c);var u=e._getCallback(t.id),h=this;return setTimeout((function(){n("Reload extension replaying handshake response",c.handshakeResponse),r.handshakeResponse=c.handshakeResponse,r.transportType=c.transportType,e._putCallback(t.id,u);var o=e._mixin(!0,{},r.handshakeResponse,{id:t.id,ext:{reload:!0}});o.supportedConnectionTypes=[r.transportType],h._receive(o),n("Reload extension replayed handshake response",o)}),0),i||(i=!0,e.startBatch()),null}n("Reload extension could not restore state",c)}catch(t){n("Reload extension error while trying to restore state",t)}break;case"/meta/connect":if(!0===a)return n("Reload extension aborting /meta/connect during reload"),null;r.transportType||(r.transportType=t.connectionType,n("Reload extension tracked transport type",r.transportType));break;case"/meta/disconnect":r={}}return t},this.incoming=function(t){if(t.successful)switch(t.channel){case"/meta/handshake":r.handshakeResponse||(r.handshakeResponse=t,n("Reload extension tracked handshake response",t));break;case"/meta/connect":i&&(i=!1,e.endBatch());break;case"/meta/disconnect":r={}}return t},c(t)}},function(t,e,n){t.exports=n(32)},function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n,r){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),a=new O(r||[]);return i._invoke=function(t,e,n){var r=h;return function(o,i){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var c=u(t,e,n);if("normal"===c.type){if(r=n.done?p:l,c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}(t,n,a),i}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h="suspendedStart",l="suspendedYield",f="executing",p="completed",d={};function m(){}function g(){}function y(){}var v={};v[i]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(N([])));w&&w!==n&&r.call(w,i)&&(v=w);var x=y.prototype=m.prototype=Object.create(v);function k(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function S(t){var e;this._invoke=function(n,o){function i(){return new Promise((function(e,i){!function e(n,o,i,a){var s=u(t[n],t,o);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?Promise.resolve(h.__await).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):Promise.resolve(h).then((function(t){c.value=t,i(c)}),(function(t){return e("throw",t,i,a)}))}a(s.arg)}(n,o,e,i)}))}return e=e?e.then(i,i):i()}}function T(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method))return d;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var o=u(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function N(t){if(t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:j}}function j(){return{value:e,done:!0}}return g.prototype=x.constructor=y,y.constructor=g,y[s]=g.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},k(S.prototype),S.prototype[a]=function(){return this},t.AsyncIterator=S,t.async=function(e,n,r,o){var i=new S(c(e,n,r,o));return t.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},k(x),x[s]="Generator",x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=N,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:N(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){var r=n(5);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(t,e,n){var r=n(15);function o(e,n,i){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()?t.exports=o=function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&r(i,n.prototype),i}:t.exports=o=Reflect.construct,o.apply(null,arguments)}t.exports=o},function(t,e){t.exports=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}},function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"createAccount",(function(){return et})),n.d(r,"updateAccount",(function(){return rt})),n.d(r,"removeAccount",(function(){return it}));var o={};n.r(o),n.d(o,"logout",(function(){return st})),n.d(o,"login",(function(){return ut})),n.d(o,"upgrade",(function(){return lt})),n.d(o,"sso",(function(){return pt})),n.d(o,"getSession",(function(){return mt})),n.d(o,"getLocalSession",(function(){return yt}));var i={};n.r(i),n.d(i,"forGroup",(function(){return vt})),n.d(i,"forWorld",(function(){return wt})),n.d(i,"connect",(function(){return kt}));var a={};n.r(a),n.d(a,"channelsEnabled",(function(){return Tt}));var s={};n.r(s),n.d(s,"create",(function(){return Nt})),n.d(s,"clone",(function(){return At})),n.d(s,"restore",(function(){return Rt})),n.d(s,"rewind",(function(){return It})),n.d(s,"update",(function(){return Ut})),n.d(s,"remove",(function(){return Bt})),n.d(s,"get",(function(){return Ft})),n.d(s,"query",(function(){return Kt})),n.d(s,"introspect",(function(){return Wt})),n.d(s,"operation",(function(){return Jt})),n.d(s,"getVariables",(function(){return zt})),n.d(s,"getVariable",(function(){return $t})),n.d(s,"updateVariables",(function(){return Qt})),n.d(s,"getMetadata",(function(){return ee})),n.d(s,"updateMetadata",(function(){return re})),n.d(s,"action",(function(){return ie}));var c=n(0),u=n.n(c),h=n(1),l=n.n(h),f=n(8),p=n.n(f),d=n(3),m=n.n(d),g=n(4),y=n.n(g),v=n(2),b=n.n(v),w=n(14),x=n.n(w),k={COOKIE:"COOKIE",SESSION:"SESSION"},S={PROJECT:"PROJECT",GROUP:"GROUP",EPISODE:"EPISODE",WORLD:"WORLD",RUN:"RUN"},T={NONE:"NONE",INTER:"INTER",REANIMATE:"REANIMATE",EXORCISE:"EXORCISE"},_={CHAT:"CHAT",CONSENSUS:"CONSENSUS",CONTROL:"CONTROL",PRESENCE:"PRESENCE",RUN:"RUN",SYSTEM:"SYSTEM"},E={SYSTEM:"SYSTEM",MONITER:"MONITER",AUTHOR:"AUTHOR",SUPPORT:"SUPPORT",FACILITATOR:"FACILITATOR",REVIEWER:"REVIEWER",USER:"USER",LEADER:"LEADER",PARTICIPANT:"PARTICIPANT",ANONYMOUS:"ANONYMOUS"},O=n(12),N=n.n(O),j=new Function("try {return this===window;}catch(e){ return false;}"),A=new Function("try {return this===global;}catch(e){return false;}"),P=function(t,e){return e.startsWith(t)?e:"".concat(t).concat(e)},R=n(6),C=n.n(R),I=n(5),L=n.n(I),U=n(9),D=n.n(U),B=n(7),M=n.n(B);function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var q=function(){function t(e){m()(this,t),b()(this,"_store",void 0),this._store=e}return y()(t,[{key:"clear",value:function(){this._store.clear()}},{key:"store",get:function(){return this._store},set:function(t){this._store=t}}]),t}(),H=new Map,K=function(t){function e(){return m()(this,e),C()(this,L()(e).call(this,H))}return M()(e,t),y()(e,[{key:"getItem",value:function(t){return D()(L()(e.prototype),"store",this).get(t)}},{key:"setItem",value:function(t,n){return D()(L()(e.prototype),"store",this).set(t,n)}},{key:"removeItem",value:function(t){return D()(L()(e.prototype),"store",this).delete(t)}}]),e}(q),X=function(t){function e(){return m()(this,e),C()(this,L()(e).call(this,window.sessionStorage))}return M()(e,t),y()(e,[{key:"getItem",value:function(t){return JSON.parse(D()(L()(e.prototype),"store",this).getItem(t.toString()))}},{key:"setItem",value:function(t,n){return D()(L()(e.prototype),"store",this).setItem(t.toString(),JSON.stringify(n))}},{key:"removeItem",value:function(t){return D()(L()(e.prototype),"store",this).removeItem(t.toString())}}]),e}(q),W=function(){function t(e){m()(this,t);var n={domain:".".concat(window.location.hostname),path:"/"};this.options=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(n,!0).forEach((function(e){b()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n,{},e)}return y()(t,[{key:"getItem",value:function(t){return JSON.parse(J.getItem(t.toString()))}},{key:"setItem",value:function(t,e){return J.setItem(t.toString(),JSON.stringify(e),this.options)}},{key:"removeItem",value:function(t){return J.removeItem(t.toString(),this.options)}},{key:"clear",value:function(){return J.clear()}}]),t}(),G=function(t){if(!t)return"";switch(t.constructor){case Number:return t===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age=".concat(t);case String:return"; expires=".concat(t);case Date:return"; expires=".concat(t.toUTCString());default:return""}},J={getItem:function(t){return t&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*".concat(encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&"),"\\s*\\=\\s*([^;]*).*$)|^.*$")),"$1"))||null},setItem:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))return!1;var r=n.path,o=n.domain,i=n.end,a=n.secure,s=n.samesite,c=G(i),u=o?"; domain=".concat(o):"",h=r?"; path=".concat(r):"",l=a?"; secure":"",f=s?"; samesite":"";return document.cookie="".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e)).concat(c).concat(u).concat(h).concat(l).concat(f),!0},removeItem:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.hasItem(t))return!1;var n=e.path,r=e.domain,o=r?"; domain=".concat(r):"",i=n?"; path=".concat(n):"";return document.cookie="".concat(encodeURIComponent(t),"=; expires=Thu, 01 Jan 1970 00:00:00 GMT").concat(o).concat(i),!0},hasItem:function(t){return!(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))&&new RegExp("(?:^|;\\s*)".concat(encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&"),"\\s*\\=")).test(document.cookie)},clear:function(){for(var t=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),e=t.length,n=0;n<e;n++)t[n]=decodeURIComponent(t[n]),this.removeItem(t[n]);return t}},V=n(11),z=n.n(V),Y=function(t){function e(t){return m()(this,e),C()(this,L()(e).call(this,t))}return M()(e,t),e}(z()(Error)),$=n(13),Z=n.n($),Q=function(t){function e(t,n){var r;m()(this,e),r=C()(this,L()(e).call(this));var o=n.information,i=n.message,a=n.cause;if(r.status=t,r.message=i,o){var s=o.code,c=Z()(o,["code"]);r.code=s,r.information=c}return a&&(r.cause=new e(a)),r}return M()(e,t),e}(z()(Error)),tt=function t(e,n,r){m()(this,t),this.status=e,this.headers=n,this.body=r};function et(t){return nt.apply(this,arguments)}function nt(){return(nt=l()(u.a.mark((function t(e){var n,r,o,i,a,s,c,h;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.objectType,r=void 0===n?"personal":n,o=e.name,i=e.shortName,a=e.adminKey,s=e.subscriptionPlan,c=e.billingInterval,t.next=3,(new Ne).post("/account",{body:{objectType:r,name:o,shortName:i,adminKey:a,subscriptionPlan:s,billingInterval:c}});case 3:return h=t.sent,t.abrupt("return",h);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function rt(t){return ot.apply(this,arguments)}function ot(){return(ot=l()(u.a.mark((function t(e){var n,r,o,i,a,s,c,h;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.objectType,r=void 0===n?"personal":n,o=e.name,i=e.shortName,a=e.adminKey,s=e.subscriptionPlan,c=e.billingInterval,t.next=3,(new Ne).patch("/account",{body:{objectType:r,name:o,shortName:i,adminKey:a,subscriptionPlan:s,billingInterval:c}});case 3:return h=t.sent,t.abrupt("return",h);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function it(t){return at.apply(this,arguments)}function at(){return(at=l()(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new Ne).withAccountShortName(e).delete("/account");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function st(){return ct.apply(this,arguments)}function ct(){return(ct=l()(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Se.session=void 0,t.next=3,de.disconnect();case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ut(t){return ht.apply(this,arguments)}function ht(){return(ht=l()(u.a.mark((function t(e){var n,r,o,i,a,s,c,h,l;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.handle,r=e.password,o=e.groupKey,i=e.objectType,a=void 0===i?"user":i,s=Z()(e,["handle","password","groupKey","objectType"]),c=s.accountShortName,h=s.projectShortName,t.next=4,(new Ne).withAccountShortName(c).withProjectShortName(h).post("/authentication",{body:{handle:n,password:r,groupKey:o,objectType:a},includeAuthorization:!1,inert:!0});case 4:return l=t.sent,t.next=7,st();case 7:return Se.session=l.body,t.abrupt("return",l);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function lt(t){return ft.apply(this,arguments)}function ft(){return(ft=l()(u.a.mark((function t(e){var n,r,o,i,a,s,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.objectType,r=void 0===n?"admin":n,o=e.inert,i=Z()(e,["objectType","inert"]),a=i.accountShortName,s=i.projectShortName,t.next=4,(new Ne).withAccountShortName(a).withProjectShortName(s).patch("/authentication",{body:{objectType:r},inert:o});case 4:return c=t.sent,t.next=7,st();case 7:return Se.session=c.body,t.abrupt("return",c);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function pt(t){return dt.apply(this,arguments)}function dt(){return(dt=l()(u.a.mark((function t(e){var n,r,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.accountShortName,r=e.projectShortName,t.next=3,(new Ne).withAccountShortName(n).withProjectShortName(r).get("/registration/sso");case 3:return o=t.sent,Se.session=o.body,t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mt(){return gt.apply(this,arguments)}function gt(){return(gt=l()(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new Ne).get("/authentication");case 2:return e=t.sent,Se.session=e.body,t.abrupt("return",e);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yt(){return Se.session}function vt(t){return bt.apply(this,arguments)}function bt(){return(bt=l()(u.a.mark((function t(e){var n,r,o,i=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=n.accountShortName,o=n.projectShortName,t.next=4,(new Ne).withAccountShortName(r).withProjectShortName(o).get("/presence/group/".concat(e));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function wt(t){return xt.apply(this,arguments)}function xt(){return(xt=l()(u.a.mark((function t(e){var n,r,o,i=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=n.accountShortName,o=n.projectShortName,t.next=4,(new Ne).withAccountShortName(r).withProjectShortName(o).get("/presence/world/".concat(e));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function kt(){return St.apply(this,arguments)}function St(){return(St=l()(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:de.handshake();case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Tt(){return _t.apply(this,arguments)}function _t(){return(_t=l()(u.a.mark((function t(){var e,n,r,o,i=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:{},n=e.accountShortName,r=e.projectShortName,t.next=4,(new Ne).withAccountShortName(n).withProjectShortName(r).get("/project/channel/isEnabled");case 4:return o=t.sent,t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Et=n(10),Ot=n.n(Et);function Nt(t,e){return jt.apply(this,arguments)}function jt(){return(jt=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h,l,f,p,d,m,g,y,v=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=v.length>2&&void 0!==v[2]?v[2]:{},o=n.scopeBoundary,i=n.scopeKey,a=n.pseudonymKey,s=r.accountShortName,c=r.projectShortName,h=r.readLock,l=r.writeLock,f=r.morphology,p=r.ephemeral,d=r.trackingKey,m=r.modelContext,g=r.executionContext,y=o===S.WORLD?E.PARTICIPANT:E.USER,t.next=6,(new Ne).withAccountShortName(s).withProjectShortName(c).post("/run",{body:{scope:{scopeBoundary:o,scopeKey:i,pseudonymKey:a},permit:{readLock:h||y,writeLock:l||y},morphology:f,trackingKey:d,modelFile:e,modelContext:m||{},executionContext:g||{},ephemeral:p}});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function At(t){return Pt.apply(this,arguments)}function Pt(){return(Pt=l()(u.a.mark((function t(e){var n,r,o,i,a,s,c,h,l,f=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:{},r=n.accountShortName,o=n.projectShortName,i=n.ephemeral,a=n.trackingKey,s=n.modelContext,c=void 0===s?{}:s,h=n.executionContext,l=void 0===h?{}:h,t.next=4,(new Ne).withAccountShortName(r).withProjectShortName(o).post("/run/clone/".concat(e),{body:{trackingKey:a,modelContext:c,executionContext:l,ephemeral:i}});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Rt(t){return Ct.apply(this,arguments)}function Ct(){return(Ct=l()(u.a.mark((function t(e){var n,r,o,i,a,s,c,h,l=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=n.accountShortName,o=n.projectShortName,i=n.ephemeral,a=n.modelContext,s=void 0===a?{}:a,c=n.executionContext,h=void 0===c?{}:c,t.next=4,(new Ne).withAccountShortName(r).withProjectShortName(o).post("/run/restore/".concat(e),{body:{modelContext:s,executionContext:h,ephemeral:i}});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function It(t,e){return Lt.apply(this,arguments)}function Lt(){return(Lt=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.length>2&&void 0!==h[2]?h[2]:{},o=r.accountShortName,i=r.projectShortName,a=r.ephemeral,s=r.modelContext,c=void 0===s?{}:s,t.next=4,(new Ne).withAccountShortName(o).withProjectShortName(i).post("/run/rewind/".concat(e),{body:{rewindCount:n,modelContext:c,ephemeral:a}});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ut(t,e){return Dt.apply(this,arguments)}function Dt(){return(Dt=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h,l,f,p,d,m=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=m.length>2&&void 0!==m[2]?m[2]:{},o=n.readLock,i=n.writeLock,a=n.trackingKey,s=n.marked,c=n.hidden,h=n.closed,l=r.accountShortName,f=r.projectShortName,p=Array.isArray(e)&&e.length>1,d=p?"":"/".concat(1===e.length?e[0]:e),t.next=7,(new Ne).withAccountShortName(l).withProjectShortName(f).withSearchParams(p?{runKey:e}:"").patch("/run".concat(d),{body:{readLock:o,writeLock:i,trackingKey:a,marked:s,hidden:c,closed:h}});case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Bt(t){return Mt.apply(this,arguments)}function Mt(){return(Mt=l()(u.a.mark((function t(e){var n,r,o,i=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=n.accountShortName,o=n.projectShortName,t.next=4,(new Ne).withAccountShortName(r).withProjectShortName(o).delete("/run/".concat(e));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ft(t){return qt.apply(this,arguments)}function qt(){return(qt=l()(u.a.mark((function t(e){var n,r,o,i=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=n.accountShortName,o=n.projectShortName,t.next=4,(new Ne).withAccountShortName(r).withProjectShortName(o).get("/run/".concat(e));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ht=2048;function Kt(t,e){return Xt.apply(this,arguments)}function Xt(){return(Xt=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h,l,f,p,d,m,g,y,v,b,w,x,k=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=k.length>2&&void 0!==k[2]?k[2]:{},o=n.scopeBoundary,i=n.scopeKey,a=r.filter,s=void 0===a?{}:a,c=r.sort,h=void 0===c?[]:c,l=r.first,f=r.max,p=r.timeout,d=r.projections,m=void 0===d?{}:d,g=r.accountShortName,y=r.projectShortName,v={filter:[].concat(Ot()((s.variables||[]).map((function(t){return P("var.",t)}))),Ot()((s.metadata||[]).map((function(t){return P("meta.",t)}))),Ot()((s.attr||[]).map((function(t){return P("run.",t)})))).join(";"),sort:h.join(";"),first:l,max:f,timeout:p,projections:[].concat(Ot()((m.variables||[]).map((function(t){return P("var.",t)}))),Ot()((m.metadata||[]).map((function(t){return P("meta.",t)}))),Ot()((m.attr||[]).map((function(t){return P("run.",t)})))).join(";")},b="/run/".concat(o,"/").concat(i,"/").concat(e),w=(new Ne).withAccountShortName(g).withProjectShortName(y).withSearchParams(v),t.next=8,w.getURL(b);case 8:return x=t.sent,t.abrupt("return",encodeURI(x.toString()).length<Ht?w.get(b):(new Ne).withAccountShortName(g).withProjectShortName(y).post(b,{body:{}}));case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Wt(t){return Gt.apply(this,arguments)}function Gt(){return(Gt=l()(u.a.mark((function t(e){var n,r,o,i=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=n.accountShortName,o=n.projectShortName,t.next=4,(new Ne).withAccountShortName(r).withProjectShortName(o).get("/run/introspect/".concat(e));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Jt(t,e){return Vt.apply(this,arguments)}function Vt(){return(Vt=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h,l,f,p=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=p.length>2&&void 0!==p[2]?p[2]:[],o=p.length>3&&void 0!==p[3]?p[3]:{},i=o.accountShortName,a=o.projectShortName,s=o.timeout,c=o.ritual,h=Array.isArray(e)&&e.length>1,l=h?"":"/".concat(1===e.length?e[0]:e),f=h?{runKey:e,timeout:s}:{ritual:c,timeout:s},c!==T.EXORCISE&&h&&console.warn("Detected ritual: ".concat(c," usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE")),t.next=9,(new Ne).withAccountShortName(i).withProjectShortName(a).withSearchParams(f).post("/run/operation".concat(l),{body:{name:n,arguments:r}});case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function zt(t,e,n){return Yt.apply(this,arguments)}function Yt(){return(Yt=l()(u.a.mark((function t(e,n,r){var o,i,a,s,c,h,l,f;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.accountShortName,i=r.projectShortName,a=r.timeout,s=r.ritual,c=n.join(";"),h=Array.isArray(e)&&e.length>1,l=h?"":"/".concat(1===e.length?e[0]:e),f=h?{runKey:e,timeout:a,include:c}:{ritual:s,timeout:a,include:c},s!==T.EXORCISE&&h&&console.warn("Detected ritual: ".concat(s," usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE")),t.next=8,(new Ne).withAccountShortName(o).withProjectShortName(i).withSearchParams(f).get("/run/variable".concat(l));case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $t(t,e){return Zt.apply(this,arguments)}function Zt(){return(Zt=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=h.length>2&&void 0!==h[2]?h[2]:{},o=r.accountShortName,i=r.projectShortName,a=r.timeout,s=r.ritual,!Array.isArray(e)&&!Array.isArray(n)){t.next=5;break}return c=Array.isArray(n)?n:[n],t.abrupt("return",zt(e,c,r));case 5:return t.next=7,(new Ne).withAccountShortName(o).withProjectShortName(i).withSearchParams({timeout:a,ritual:s}).get("/run/variable/".concat(e,"/").concat(n));case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Qt(t,e){return te.apply(this,arguments)}function te(){return(te=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h,l,f=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=f.length>2&&void 0!==f[2]?f[2]:{},o=r.accountShortName,i=r.projectShortName,a=r.timeout,s=r.ritual,c=Array.isArray(e)&&e.length>1,h=c?"":"/".concat(1===e.length?e[0]:e),l=c?{runKey:e,timeout:a}:{ritual:s,timeout:a},s!==T.EXORCISE&&c&&console.warn("Detected ritual: ".concat(s," usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE")),t.next=8,(new Ne).withAccountShortName(o).withProjectShortName(i).withSearchParams(l).patch("/run/variable".concat(h),{body:n});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ee(t,e){return ne.apply(this,arguments)}function ne(){return(ne=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h,l,f,p=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=p.length>2&&void 0!==p[2]?p[2]:{},o=r.accountShortName,i=r.projectShortName,a=r.timeout,s=r.ritual,c=n.join(";"),h=Array.isArray(e)&&e.length>1,l=h?"":"/".concat(1===e.length?e[0]:e),f=h?{runKey:e,timeout:a,include:c}:{ritual:s,timeout:a,include:c},s!==T.EXORCISE&&h&&console.warn("Detected ritual: ".concat(s," usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE")),t.next=9,(new Ne).withAccountShortName(o).withProjectShortName(i).withSearchParams(f).get("/run/meta".concat(l));case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function re(t,e){return oe.apply(this,arguments)}function oe(){return(oe=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h,l,f=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=f.length>2&&void 0!==f[2]?f[2]:{},o=r.accountShortName,i=r.projectShortName,a=r.timeout,s=r.ritual,c=Array.isArray(e)&&e.length>1,h=c?"":"/".concat(1===e.length?e[0]:e),l=c?{runKey:e,timeout:a}:{ritual:s,timeout:a},s!==T.EXORCISE&&c&&console.warn("Detected ritual: ".concat(s," usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE")),t.next=8,(new Ne).withAccountShortName(o).withProjectShortName(i).withSearchParams(l).patch("/run/meta".concat(h),{body:n});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ie(t,e){return ae.apply(this,arguments)}function ae(){return(ae=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h,l,f=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=f.length>2&&void 0!==f[2]?f[2]:{},o=r.accountShortName,i=r.projectShortName,a=r.timeout,s=r.ritual,c=Array.isArray(e)&&e.length>1,h=c?"":"/".concat(1===e.length?e[0]:e),l=c?{runKey:e,timeout:a}:{ritual:s,timeout:a},s!==T.EXORCISE&&c&&console.warn("Detected ritual: ".concat(s," usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE")),t.next=8,(new Ne).withAccountShortName(o).withProjectShortName(i).withSearchParams(l).post("/run/action".concat(h),{body:n});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var se=n(17),ce=n.n(se),ue=n(18),he=n.n(ue),le="com.forio.epicenter.token",fe="disconnected",pe=function(t){function e(t){var n;m()(this,e),n=C()(this,L()(e).call(this));var r=t.error,o=t.successful;return r&&r.includes("403")&&!o&&(n.status=401),n.information=t,n.message=r,n}return M()(e,t),e}(z()(Error)),de=new(function(){function t(){m()(this,t),b()(this,"url",void 0),b()(this,"customCometd",void 0),b()(this,"defaultCometd",void 0),b()(this,"subscriptions",new Map),b()(this,"state",fe),b()(this,"requireAcknowledgement",!0),b()(this,"initialized",!1)}var e,r,o,i,a,s,c,h,f;return y()(t,[{key:"reinit",value:(f=l()(u.a.mark((function t(e,n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.disconnect();case 2:return this.initialized=!1,this.customCometd=e,t.abrupt("return",this.init(n));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return f.apply(this,arguments)})},{key:"init",value:(h=l()(u.a.mark((function t(){var e,r,o=this,i=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:{logLevel:"error"},!this.initialized){t.next=3;break}return t.abrupt("return");case 3:if(A()||!j()){t.next=8;break}return t.next=6,Promise.resolve().then(n.t.bind(null,16,7));case 6:r=t.sent,this.defaultCometd=new r.CometD;case 8:return t.next=10,Ae.load();case 10:this.url="".concat(Ae.apiScheme,"://").concat(Ae.apiHost).concat("/v3/epicenter/cometd"),this.cometd.registerExtension("ack",new ce.a),this.cometd.registerExtension("reload",new he.a),this.cometd.configure({url:this.url,logLevel:e.logLevel}),!A()&&j()&&(window.onunload=function(){"connected"===o.cometd.getStatus()&&(o.cometd.reload(),o.cometd.getTransport().abort())}),this.initialized=!0;case 16:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"checkEnabled",value:(c=l()(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Tt();case 2:if(t.sent.body){t.next=6;break}throw new Y("Push Channels are not enabled on this project");case 6:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{key:"handshake",value:(s=l()(u.a.mark((function t(){var e,n,r,o,i=this,a=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:{},t.next=3,this.checkEnabled();case 3:return t.next=5,this.init();case 5:if(this.cometd.getStatus()===fe){t.next=7;break}return t.abrupt("return",Promise.resolve());case 7:return n={},(r=Se.session)&&(n.ext=(o={},b()(o,le,r.token),b()(o,"ack",this.requireAcknowledgement),o)),this.cometd.ackEnabled=this.requireAcknowledgement,this.cometd.websocketEnabled=!0,t.abrupt("return",new Promise((function(t,r){return i.cometd.handshake(n,(function(n){if(n.successful)t(n);else{var o=new pe(n);if(e.inert)r(o);else try{var a=be.handle(o,(function(){return i.handshake({inert:!0})}));t(a)}catch(t){r(t)}}}))})));case 13:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"disconnect",value:(a=l()(u.a.mark((function t(){var e=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.cometd){t.next=2;break}return t.abrupt("return",Promise.resolve());case 2:return t.next=4,this.init();case 4:return t.next=6,this.empty();case 6:if("connected"===this.cometd.getStatus()){t.next=8;break}return t.abrupt("return",Promise.resolve());case 8:return t.abrupt("return",new Promise((function(t,n){return e.cometd.disconnect((function(e){e.successful?t():n(new Y("Unable to disconnect from CometD server"))}))})));case 9:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"add",value:(i=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h=this,l=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=l.length>2&&void 0!==l[2]?l[2]:{},t.next=3,this.init();case 3:if(o=[].concat(e),"connected"===this.cometd.getStatus()){t.next=7;break}return t.next=7,this.handshake();case 7:return i={},(a=Se.session)&&(i.ext=b()({},le,a.token)),s=function(t){t.channel;var e=t.data;return e="string"==typeof e?JSON.parse(e):e,n(e)},c=[],this.cometd.batch((function(){return o.forEach((function(t){var o=t.path;return c.push(new Promise((function(t,a){var c=h.cometd.subscribe(o,s,i,(function(o){if(o.successful)return h.subscriptions.set(c.channel,c),void t(c);var i=new pe(o);if(r.inert)a(i);else try{var s=be.handle(i,(function(){return h.add(e,n,{inert:!0})}));t(s)}catch(t){a(t)}}))})))}))})),t.abrupt("return",1===c.length?Promise.all(c).then((function(t){return p()(t,1)[0]})):Promise.all(c));case 14:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"publish",value:(o=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c=this,h=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.length>2&&void 0!==h[2]?h[2]:{},t.next=3,this.init();case 3:if(o=[].concat(e),"connected"===this.cometd.getStatus()){t.next=7;break}return t.next=7,this.handshake();case 7:return i={},(a=Se.session)&&(i.ext=b()({},le,a.token)),s=[],this.cometd.batch((function(){return o.forEach((function(t){var o=t.path;return s.push(new Promise((function(t,a){c.cometd.publish(o,n,i,(function(o){if(o.successful)t(o);else{var i=new pe(o);if(r.inert)a(i);else try{var s=be.handle(i,(function(){return c.publish(e,n,{inert:!0})}));t(s)}catch(t){a(t)}}}))})))}))})),t.abrupt("return",1===s.length?Promise.all(s).then((function(t){return p()(t,1)[0]})):Promise.all(s));case 13:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"remove",value:(r=l()(u.a.mark((function t(e){var n=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return this.subscriptions.delete(e.channel),t.abrupt("return",new Promise((function(t,r){return n.cometd.unsubscribe(e,(function(e){e.successful&&t(e);var n=new pe(e);r(n)}))})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"empty",value:(e=l()(u.a.mark((function t(){var e,n=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return e=[],this.cometd.batch((function(){return n.subscriptions.forEach((function(t){e.push(n.remove(t))}))})),t.abrupt("return",Promise.all(e));case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"cometd",get:function(){return this.customCometd||this.defaultCometd}}]),t}()),me=function(t){if(!t)throw new Y("No scope found where one was required");var e=t.scopeBoundary,n=t.scopeKey,r=t.pushCategory;if(!e)throw new Y("Missing scope component: scopeBoundary");if(!n)throw new Y("Missing scope component: scopeKey");if(!r)throw new Y("Missing scope component: pushCategory");if(!S.hasOwnProperty(e))throw new Y("Invalid scope boundary: ".concat(e));if(!_.hasOwnProperty(r))throw new Y("Invalid push category: ".concat(r))},ge=function(){function t(e){m()(this,t),b()(this,"path",void 0),b()(this,"update",void 0),b()(this,"subscription",void 0);var n=e.scopeBoundary,r=e.scopeKey,o=e.pushCategory;me(e),this.path="/".concat(n.toLowerCase(),"/").concat(r,"/").concat(o.toLowerCase()),de.subscriptions.has(this.path)&&(this.subscription=de.subscriptions.get(this.path))}var e,n;return y()(t,[{key:"publish",value:function(t){return de.publish(this,t)}},{key:"subscribe",value:(n=l()(u.a.mark((function t(e,n){var r=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.subscription){t.next=3;break}return t.next=3,this.unsubscribe();case 3:return this.update=e,t.abrupt("return",de.add(this,e,n).then((function(t){return r.subscription=t,t})));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"unsubscribe",value:(e=l()(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.subscription){t.next=4;break}return t.next=3,de.remove(this.subscription);case 3:this.subscription=null;case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}(),ye=function(t){switch(function(t,e,n){var r=t;try{e.forEach((function(t){return r=r[t]}))}catch(t){if(t instanceof TypeError)return n;throw t}return void 0===r?n:r}(Se.session,["loginMethod","objectType"])){case"sso":return o.logout();case"none":return o.logout().then((function(){return window.location.href="/unknown.html"}));case"native":default:return function(t){var e="";return t.code&&(e=e.concat("?error=".concat(t.code))),o.logout().then((function(){return window.location.href="/login.html".concat(e)}))}(t)}},ve=401,be=new(function(){function t(){m()(this,t),b()(this,"_handlers",[{identifier:function(t){return t.status===ve},handle:function(t,e){return"AUTHENTICATION_INVALIDATED"===t.code?o.upgrade({objectType:"user",inert:!0}).then((function(){return e()})).catch((function(){return ye(t)})):A()?Promise.reject(t):ye(t)}}])}var e;return y()(t,[{key:"registerHandler",value:function(t,e){this.handlers.unshift({identifier:t,handle:e})}},{key:"handle",value:(e=l()(u.a.mark((function t(e,n,r){var o,i,a,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=r||this.handlers,o=r.findIndex((function(t){return(0,t.identifier)(e)})),i=r[o],a=o>0?r.slice(o+1):[],i){t.next=6;break}throw e;case 6:return t.prev=6,t.next=9,i.handle(e,n).catch((function(t){throw t}));case 9:s=t.sent,t.next=17;break;case 12:return t.prev=12,t.t0=t.catch(6),t.next=16,this.handle(e,n,a);case 16:s=t.sent;case 17:return t.abrupt("return",s);case 18:case"end":return t.stop()}}),t,this,[[6,12]])}))),function(t,n,r){return e.apply(this,arguments)})},{key:"handlers",get:function(){return this._handlers}}]),t}()),we=k.COOKIE,xe=k.SESSION,ke=Symbol("com.forio.epicenter.session"),Se=new(function(){function t(e){if(m()(this,t),b()(this,"type",void 0),e!==we&&e!==xe)throw new Y('Invalid Storage Type: "'.concat(e,'", please use "').concat(we,'" or "').concat(xe,'".'));this.type=e,this.consumeSSO()}return y()(t,[{key:"getStore",value:function(){if(A())return K;switch(this.type){case xe:return X;case we:default:return W}}},{key:"getSessionPath",value:function(t){var e=t||this.session;if(!e||A())return"";var n=e.accountShortName,r=e.projectShortName,o=e.objectType,i=Ae.isLocal(),a=!i&&"app"!==window.location.pathname.split("/")[1];return"user"===o&&n&&r&&(!i&&!a)?"/app/".concat(n,"/").concat(r):"/"}},{key:"consumeSSO",value:function(){if(!A()){var t=JSON.parse(JSON.parse('"'.concat(J.getItem("epicenter.v3.sso"),'"')));if(t){var e=t.accountShortName,n=t.projectShortName;this.session=t,J.removeItem("epicenter.v3.sso",{domain:".".concat(window.location.hostname),path:"/app/".concat(e,"/").concat(n)})}}}},{key:"session",get:function(){return(new(this.getStore())).getItem(ke.description)},set:function(t){var e=this.getStore(),n=this.getSessionPath(t);t?new e({path:n}).setItem(ke.description,t):this.session&&new e({path:n}).removeItem(ke.description)}}]),t}())(we);function Te(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _e(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Te(n,!0).forEach((function(e){b()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Te(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ee(t,e){return Oe.apply(this,arguments)}function Oe(){return(Oe=l()(u.a.mark((function t(e,n){var r,o,i,a,s,c,h,l,f,p;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.method,o=n.body,i=n.includeAuthorization,a=n.inert,s={"Content-type":"application/json; charset=UTF-8"},c=Se.session,i&&c&&(s.Authorization="Bearer ".concat(c.token)),t.next=6,x()(e,{method:r,cache:"no-cache",headers:s,redirect:"follow",body:o?JSON.stringify(o):null});case 6:if(h=t.sent,(l=h.headers.get("content-type"))&&l.includes("application/json")){t.next=10;break}throw new Y("Response content-type '".concat(l,"' does not include 'application/json'"));case 10:if(!(h.status>=200&&h.status<400)){t.next=18;break}return t.t0=tt,t.t1=h.status,t.t2=h.headers,t.next=16,h.json();case 16:return t.t3=t.sent,t.abrupt("return",new t.t0(t.t1,t.t2,t.t3));case 18:return t.t4=Q,t.t5=h.status,t.next=22,h.json();case 22:if(t.t6=t.sent,f=new t.t4(t.t5,t.t6),!a){t.next=26;break}throw f;case 26:return p=function(){return Ee(e,{method:r,body:o,includeAuthorization:i,inert:!0})},t.abrupt("return",be.handle(f,p));case 28:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ne=function(){function t(){m()(this,t)}var e,n,r,o,i,a,s;return y()(t,[{key:"withServer",value:function(t){return t&&(this.server=t),this}},{key:"withVersion",value:function(t){return t&&(this.version=t),this}},{key:"withAccountShortName",value:function(t){return t&&(this.accountShortName=t),this}},{key:"withProjectShortName",value:function(t){return t&&(this.projectShortName=t),this}},{key:"withSearchParams",value:function(t){return t?("object"===N()(t)&&0===Object.entries(t).length||(this.searchParams=t),this):this}},{key:"configure",value:(s=l()(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ae.load();case 2:this.server||this.withServer("".concat(Ae.apiScheme,"://").concat(Ae.apiHost)),this.accountShortName||this.withAccountShortName(Ae.accountShortName),this.projectShortName||this.withProjectShortName(Ae.projectShortName),this.version||this.withVersion(Ae.apiVersion);case 6:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"getURL",value:(a=l()(u.a.mark((function t(e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.configure();case 2:return(n=new URL("".concat(this.server))).pathname="v".concat(this.version,"/").concat(this.accountShortName,"/").concat(this.projectShortName).concat(P("/",e)),n.search=this.searchParams,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"get",value:(i=l()(u.a.mark((function t(e,n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getURL(e);case 2:return r=t.sent,t.abrupt("return",Ee(r,_e({includeAuthorization:!0},n,{method:"GET"})));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"delete",value:(o=l()(u.a.mark((function t(e,n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getURL(e);case 2:return r=t.sent,t.abrupt("return",Ee(r,_e({includeAuthorization:!0},n,{method:"DELETE"})));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"patch",value:(r=l()(u.a.mark((function t(e,n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getURL(e);case 2:return r=t.sent,t.abrupt("return",Ee(r,_e({includeAuthorization:!0},n,{method:"PATCH"})));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"post",value:(n=l()(u.a.mark((function t(e,n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getURL(e);case 2:return r=t.sent,t.abrupt("return",Ee(r,_e({includeAuthorization:!0},n,{method:"POST"})));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"put",value:(e=l()(u.a.mark((function t(e,n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getURL(e);case 2:return r=t.sent,t.abrupt("return",Ee(r,_e({includeAuthorization:!0},n,{method:"PUT"})));case 4:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"server",get:function(){return this._server},set:function(t){this._server=t}},{key:"version",get:function(){return this._version},set:function(t){this._version=t}},{key:"accountShortName",get:function(){return this._accountShortName},set:function(t){this._accountShortName=t}},{key:"projectShortName",get:function(){return this._projectShortName},set:function(t){this._projectShortName=t}},{key:"searchParams",get:function(){return this._searchParams||""},set:function(t){var e;this._searchParams="string"==typeof(e=t)?e:"object"!==N()(e)?"":(Array.isArray(e)?e:Object.entries(e)).flatMap((function(t){var e=p()(t,2),n=e[0],r=e[1];return void 0===n||""===n?[]:void 0===r||""===r?[]:Array.isArray(r)?r.map((function(t){return"".concat(n,"=").concat(t)})):"".concat(n,"=").concat(r)})).join("&")}}]),t}(),je=3,Ae=new(function(){function t(){m()(this,t),b()(this,"_apiVersion",je),b()(this,"_apiScheme","http"),b()(this,"_apiHost","api.forio.com"),b()(this,"_localConfigProtocol","https:"),b()(this,"_localConfigHost","test.forio.com")}var e,n,r;return y()(t,[{key:"isLocal",value:function(){if(!j())return!1;var t=window.location.host;return"127.0.0.1"===t||0===t.indexOf("local.")||-1!==t.indexOf("ngrok")||0===t.indexOf("localhost")}},{key:"getPathAccountProject",value:function(t){var e=t.match(/\/app\/([\w-]+)\/([\w-]+)/);if(e){var n=e.slice(1),r=p()(n,2),o=r[0],i=r[1];this.accountShortName=o,this.projectShortName=i}}},{key:"loadNode",value:(r=l()(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.apiScheme="https",this.apiHost="test.forio.com",t.abrupt("return");case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"loadBrowser",value:(n=l()(u.a.mark((function t(){var e,n,r,o,i,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.isLocal(),n=e?this.localConfigProtocol:window.location.protocol,r=e?this.localConfigHost:window.location.host,e||this.getPathAccountProject(window.location.pathname),t.next=6,x()("".concat(n,"//").concat(r,"/epicenter/v").concat(this._apiVersion,"/config"),{method:"GET",cache:"no-cache",redirect:"follow"});case 6:if(o=t.sent,(i=o.headers.get("content-type"))&&i.includes("application/json")){t.next=10;break}throw new Y("Invalid configuration response");case 10:if(!(o.status>=200&&o.status<400)){t.next=18;break}return t.next=13,o.json();case 13:a=t.sent,this.apiScheme=a.api.protocol,this.apiHost=a.api.host,t.next=24;break;case 18:return t.t0=Q,t.t1=o.status,t.next=22,o.json();case 22:throw t.t2=t.sent,new t.t0(t.t1,t.t2);case 24:return t.abrupt("return",o);case 25:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"load",value:(e=l()(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.loading){t.next=4;break}return t.next=3,this.loading;case 3:return t.abrupt("return",t.sent);case 4:if(!A()){t.next=9;break}return this.loading=this.loadNode(),t.next=8,this.loading;case 8:return t.abrupt("return",t.sent);case 9:if(!j()||!window.location.protocol.includes("http")){t.next=14;break}return this.loading=this.loadBrowser(),t.next=13,this.loading;case 13:return t.abrupt("return",t.sent);case 14:throw new Y("Could not identify environment; no configuration was setup");case 15:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"apiScheme",get:function(){return this._apiScheme},set:function(t){this._apiScheme=t}},{key:"apiHost",get:function(){return this._apiHost},set:function(t){this._apiHost=t}},{key:"localConfigProtocol",get:function(){return this._localConfigProtocol},set:function(t){var e;":"!==(e=t)[e.length-1]&&(t="".concat(t,":")),this._localConfigProtocol=t}},{key:"localConfigHost",get:function(){return this._localConfigHost},set:function(t){this._localConfigHost=t}},{key:"apiVersion",get:function(){return this._apiVersion},set:function(t){this._apiVersion=t}},{key:"accountShortName",get:function(){return this._accountShortName},set:function(t){this._accountShortName=t}},{key:"projectShortName",get:function(){return this._projectShortName},set:function(t){this._projectShortName=t}}]),t}());n.d(e,"version",(function(){return Pe})),n.d(e,"config",(function(){return Ae})),n.d(e,"BROWSER_STORAGE_TYPE",(function(){return k})),n.d(e,"SCOPE_BOUNDARY",(function(){return S})),n.d(e,"RITUAL",(function(){return T})),n.d(e,"PUSH_CATEGORY",(function(){return _})),n.d(e,"LOCK_TYPE",(function(){return E})),n.d(e,"errorManager",(function(){return be})),n.d(e,"Channel",(function(){return ge})),n.d(e,"accountAdapter",(function(){return r})),n.d(e,"authAdapter",(function(){return o})),n.d(e,"presenceAdapter",(function(){return i})),n.d(e,"projectAdapter",(function(){return a})),n.d(e,"runAdapter",(function(){return s}));var Pe="3.0.0"}])}));
//# sourceMappingURL=epicenter.js.map