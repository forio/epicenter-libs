{"version":3,"sources":["webpack://epicenter/webpack/universalModuleDefinition","webpack://epicenter/webpack/bootstrap","webpack://epicenter/./node_modules/@babel/runtime/regenerator/index.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/createClass.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/inherits.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/get.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/wrapNativeSuper.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/typeof.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/objectWithoutProperties.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack://epicenter/./node_modules/cometd/cometd.js","webpack://epicenter/./node_modules/cometd/AckExtension.js","webpack://epicenter/./node_modules/cometd/ReloadExtension.js","webpack://epicenter/./node_modules/cross-fetch/dist/browser-ponyfill.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/superPropBase.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/isNativeFunction.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/construct.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","webpack://epicenter/./node_modules/regenerator-runtime/runtime.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack://epicenter/./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack://epicenter/./src/utils/constants.js","webpack://epicenter/./src/utils/helpers.js","webpack://epicenter/./src/utils/store.js","webpack://epicenter/./src/utils/cookies.js","webpack://epicenter/./src/utils/error.js","webpack://epicenter/./src/utils/fault.js","webpack://epicenter/./src/utils/result.js","webpack://epicenter/./src/adapters/account.js","webpack://epicenter/./src/adapters/authentication.js","webpack://epicenter/./src/adapters/presence.js","webpack://epicenter/./src/adapters/project.js","webpack://epicenter/./src/adapters/run.js","webpack://epicenter/./src/adapters/cometd.js","webpack://epicenter/./src/adapters/channel.js","webpack://epicenter/./src/utils/error-manager.js","webpack://epicenter/./src/utils/identification.js","webpack://epicenter/./src/utils/router.js","webpack://epicenter/./src/config.js","webpack://epicenter/./src/epicenter.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","fn","self","args","arguments","apply","err","undefined","obj","configurable","writable","instance","Constructor","TypeError","_defineProperties","target","props","length","descriptor","protoProps","staticProps","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","_typeof","assertThisInitialized","subClass","superClass","constructor","arrayWithHoles","iterableToArrayLimit","nonIterableRest","arr","superPropBase","_get","receiver","Reflect","base","desc","getOwnPropertyDescriptor","arrayWithoutHoles","iterableToArray","nonIterableSpread","isNativeFunction","construct","_wrapNativeSuper","Class","_cache","Map","has","set","Wrapper","_typeof2","iterator","objectWithoutPropertiesLoose","source","excluded","getOwnPropertySymbols","sourceSymbolKeys","indexOf","propertyIsEnumerable","_setPrototypeOf","Scheduler","_ids","_tasks","register","funktion","id","unregister","setTimeout","delay","window","clearTimeout","WorkerScheduler","onmessage","e","cmd","data","type","postMessage","Utils","isString","String","isArray","Array","inArray","element","array","TransportRegistry","_types","_transports","getTransportTypes","slice","findTransportTypes","version","crossDomain","url","result","accept","push","negotiateTransport","types","j","transport","add","index","existing","splice","find","remove","clear","reset","init","Transport","_type","_cometd","_url","registered","cometd","unregistered","_debug","_mixin","getConfiguration","getAdvice","convertToMessages","response","JSON","parse","x","getType","getURL","setURL","send","envelope","metaConnect","abort","toString","derive","baseObject","F","RequestTransport","_super","_self","_requestIds","_metaConnectRequest","_requests","_envelopes","_coalesceEnvelopes","envelopeAndRequest","newEnvelope","newRequest","sync","shift","messages","concat","_transportSend","request","transportSend","expired","maxDelay","maxNetworkDelay","timeout","errorMessage","failure","reason","xhr","httpCode","xhrStatus","abortXHR","complete","onFailure","_queueSend","requestId","maxConnections","_metaConnectComplete","_complete","success","nextEnvelope","nextRequest","autoBatch","_metaConnectSend","transportSuccess","responses","onSuccess","transportFailure","metaConnectRequest","state","readyState","XMLHttpRequest","UNSENT","status","LongPollingTransport","_supportsCrossDomain","newXMLHttpRequest","xhrSend","packet","context","withCredentials","open","headers","headerName","setRequestHeader","onload","responseText","onError","statusText","onabort","onerror","body","sameStack","requestHeaders","stringify","received","exception","CallbackPollingTransport","jsonp","_failTransportFn","jsonpSend","head","document","getElementsByTagName","script","createElement","callbackName","removeChild","encodeURIComponent","src","async","appendChild","start","lengths","json","urlLength","encodeURI","maxLength","maxURILength","envelopeToSend","begin","end","join","xx","WebSocketTransport","_webSocketSupported","_webSocketConnected","_stickyReconnect","_context","_connecting","_connected","_successCallback","_forceClose","event","webSocketClose","code","onClose","_sameContext","_storeEnvelope","messageIds","message","envelopes","_websocketConnect","replace","protocol","webSocket","WebSocket","stickyReconnect","connectTimeout","connectTimer","onclose","onopen","onOpen","_warn","wsMessage","onMessage","_webSocketSend","timeouts","_send","_notifySuccess","_notifyFailure","close","test","channel","removed","ids","split","websocketCode","websocketEnabled","_z85EncodeTable","_z85DecodeTable","CometD","_transport","_handshakeProps","_handshakeCallback","_handleMessages","_handleFailure","_scheduler","_name","_crossDomain","_status","_messageId","_clientId","_batch","_messageQueue","_internalBatch","_listenerId","_listeners","_backoff","_scheduledSend","_extensions","_advice","_callbacks","_remoteCalls","_reestablish","_unconnectTime","_handshakeMessages","_metaConnect","_config","useWorkerScheduler","backoffIncrement","maxBackoff","logLevel","appendMessageTypeToURL","urls","advice","interval","reconnect","maxInterval","_fieldValue","_isString","_isFunction","_zeroPad","Math","pow","_log","level","console","logger","now","Date","getHours","getMinutes","getSeconds","getMilliseconds","_splitURL","RegExp","exec","_configure","configuration","urlParts","hostAndPort","uri","afterURI","_isCrossDomain","_info","uriSegments","lastSegmentIndex","match","Worker","Blob","URL","substring","lastIndexOf","blob","blobURL","createObjectURL","worker","_removeListener","subscription","subscriptions","listener","_removeSubscription","_clearSubscriptions","_setStatus","newStatus","_isDisconnected","_nextMessageId","_applyExtension","scope","callback","outgoing","handler","onExtensionException","_applyOutgoingExtensions","extension","_notify","onListenerException","_notifyListeners","channelParts","last","channelPart","_cancelDelayedSend","_delayedSend","operation","time","extraPath","messageId","clientId","rcvdMessages","conduit","getTransport","connectionType","_resetBackoff","_flushBatch","_delayedConnect","bayeuxMessage","_connect","_updateAdvice","newAdvice","_disconnect","_notifyTransportException","oldTransport","newTransport","onTransportException","_handshake","handshakeProps","handshakeCallback","transportTypes","minimumVersion","supportedConnectionTypes","_putCallback","_notifyCallback","onCallbackException","_handleCallback","_getCallback","_handleRemoteCall","_handleTransportFailure","failureInfo","action","_delayedHandshake","_failHandshake","onTransportFailure","_handshakeFailure","cause","_matchMetaConnect","connect","_failConnect","_connectFailure","_failDisconnect","_disconnectFailure","_failSubscribe","_subscribeFailure","_failUnsubscribe","_unsubscribeFailure","_failMessage","_messageFailure","_receive","incoming","_applyIncomingExtensions","successful","reestablish","_handshakeResponse","_connectResponse","_disconnectResponse","_subscribeResponse","_unsubscribeResponse","_messageResponse","_hasSubscriptions","_resolveScopedCallback","delegate","method","_addListener","isListener","deep","objects","propName","prop","targ","location","host","failureHandler","transports","getTransportRegistry","getBackoffPeriod","increaseBackoffPeriod","getTime","expiration","resetBackoffPeriod","receive","failureMessage","registerTransport","unregisterTransport","unregisterTransports","findTransport","configure","handshake","disconnect","disconnectProps","disconnectCallback","startBatch","endBatch","_endBatch","batch","addListener","removeListener","clearListeners","subscribe","subscribeProps","subscribeCallback","unsubscribe","unsubscribeProps","unsubscribeCallback","resubscribe","clearSubscriptions","publish","content","publishProps","publishCallback","publishBinary","meta","ArrayBuffer","ext","binary","remoteCall","callProps","remoteCallBinary","getStatus","isDisconnected","setBackoffIncrement","period","getBackoffIncrement","setLogLevel","registerExtension","existingExtension","unregisterExtension","getExtension","getName","getClientId","Z85","encode","bytes","buffer","Uint8Array","byteLength","remainder","padding","view","DataView","isPadding","getUint8","divisor","floor","decode","string","charIdx","byteIdx","charCodeAt","setUint8","AckExtension","_serverSupportsAcks","text","ackField","ack","enabled","ackEnabled","ReloadExtension","_state","_reloading","_reload","config","handshakeResponse","sessionStorage","setItem","reload","getItem","oldState","removeItem","_similarState","transportType","__self__","fetch","DOMException","support","viewClasses","isArrayBufferView","isView","normalizeName","toLowerCase","normalizeValue","iteratorFor","items","next","Headers","map","forEach","append","header","getOwnPropertyNames","consumed","bodyUsed","fileReaderReady","reader","readBlobAsArrayBuffer","FileReader","promise","readAsArrayBuffer","bufferClone","buf","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","FormData","_bodyFormData","URLSearchParams","_bodyArrayBuffer","rejected","Error","arrayBuffer","readAsText","chars","fromCharCode","readArrayBufferAsText","formData","oldValue","thisArg","keys","values","entries","methods","Request","input","options","upcased","credentials","signal","toUpperCase","referrer","form","trim","decodeURIComponent","Response","bodyInit","ok","clone","redirectStatuses","redirect","RangeError","stack","aborted","abortXhr","rawHeaders","getAllResponseHeaders","line","parts","responseURL","ontimeout","responseType","addEventListener","onreadystatechange","removeEventListener","polyfill","default","_arr","_n","_d","_e","_s","_i","ReferenceError","Function","isNativeReflectConstruct","sham","Proxy","_construct","Parent","a","sourceKeys","runtime","Op","hasOwn","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","Context","_invoke","doneResult","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","makeInvokeMethod","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","NativeIteratorPrototype","Gp","defineIteratorMethods","AsyncIterator","previousPromise","callInvokeWithMethodAndArg","invoke","__await","unwrapped","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","iter","reverse","pop","skipTempReset","prev","charAt","stop","rootRecord","rval","handle","loc","caught","hasCatch","hasFinally","finallyEntry","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","arr2","from","BROWSER_STORAGE_TYPE","COOKIE","SESSION","SCOPE_BOUNDARY","PROJECT","GROUP","EPISODE","WORLD","RUN","RITUAL","NONE","INTER","REANIMATE","EXORCISE","PUSH_CATEGORY","CHAT","CONSENSUS","CONTROL","PRESENCE","SYSTEM","LOCK_TYPE","MONITER","AUTHOR","SUPPORT","FACILITATOR","REVIEWER","USER","LEADER","PARTICIPANT","ANONYMOUS","isBrowser","isNode","prefix","pre","str","startsWith","Store","store","_store","nodeMap","NodeStore","SessionStore","CookieStore","defaults","domain","hostname","path","cookies","getExpiration","vEnd","Number","Infinity","toUTCString","cookie","secure","samesite","expireStr","domainStr","pathStr","secureStr","samesiteStr","hasItem","aKeys","nLen","nIdx","EpicenterError","Fault","information","rest","Result","createAccount","objectType","shortName","adminKey","subscriptionPlan","billingInterval","Router","post","updateAccount","patch","removeAccount","accountShortName","withAccountShortName","logout","identification","session","cometdAdapter","login","password","groupKey","others","projectShortName","withProjectShortName","includeAuthorization","inert","upgrade","sso","getSession","getLocalSession","forGroup","forWorld","worldKey","channelsEnabled","optionals","model","scopeBoundary","scopeKey","pseudonymKey","readLock","writeLock","morphology","ephemeral","trackingKey","modelContext","executionContext","defaultLock","permit","modelFile","runKey","restore","rewind","steps","rewindCount","update","marked","hidden","closed","hasMultiple","uriComponent","withSearchParams","query","filter","sort","first","max","projections","variables","statement","metadata","attr","router","introspect","ritual","searchParams","warn","getVariables","include","getVariable","variable","updateVariables","getMetadata","updateMetadata","actionList","serial","operations","normalizedOps","item","params","reduce","promiseChain","getWithStrategy","strategy","initOperations","runs","newRun","AUTH_TOKEN_KEY","CometdError","reply","includes","customCometd","initialized","defaultCometd","apiProtocol","apiHost","apiVersion","onunload","checkEnabled","token","requireAcknowledgement","handshakeReply","errorManager","empty","disconnectReply","channels","subscriptionProps","handleCometdUpdate","promises","subscribeReply","all","publishReply","unsubscribeReply","Channel","pushCategory","validateScope","handleByLoginMethod","defaultValue","ref","access","authAdapter","href","handleByRelog","identifier","retry","handleFn","handlers","unshift","retryFn","findIndex","remainingHandlers","_handlers","SESSION_KEY","storeType","consumeSSO","mySession","isLocal","isCustomDomain","pathname","getStore","description","getSessionPath","Authorization","cache","contentType","server","withServer","withVersion","search","_server","_version","_accountShortName","_projectShortName","_searchParams","flatMap","v","loadBrowser","loadNode","account","project","_apiProtocol","endsWith","_apiHost","_apiVersion","VERSION"],"mappings":"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","file":"epicenter.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"epicenter\"] = factory();\n\telse\n\t\troot[\"epicenter\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n","module.exports = require(\"regenerator-runtime\");\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","var superPropBase = require(\"./superPropBase\");\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nmodule.exports = _get;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nvar setPrototypeOf = require(\"./setPrototypeOf\");\n\nvar isNativeFunction = require(\"./isNativeFunction\");\n\nvar construct = require(\"./construct\");\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  module.exports = _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nmodule.exports = _wrapNativeSuper;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","/*\n * Copyright (c) 2008-2019 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* CometD Version 3.1.10 */\n\n(function(root, factory) {\n    if (typeof exports === 'object') {\n        // CommonJS.\n        module.exports = factory();\n    } else if (typeof define === 'function' && define.amd) {\n        // AMD.\n        define([], factory);\n    } else {\n        // Globals.\n        root.org = root.org || {};\n        root.org.cometd = factory();\n    }\n}(this, function() {\n    /**\n     * Browsers may throttle the Window scheduler,\n     * so we may replace it with a Worker scheduler.\n     */\n    var Scheduler = function() {\n        var _ids = 0;\n        var _tasks = {};\n        this.register = function(funktion) {\n            var id = ++_ids;\n            _tasks[id] = funktion;\n            return id;\n        };\n        this.unregister = function(id) {\n            var funktion = _tasks[id];\n            delete _tasks[id];\n            return funktion;\n        };\n        this.setTimeout = function(funktion, delay) {\n            return window.setTimeout(funktion, delay);\n        };\n        this.clearTimeout = function(id) {\n            window.clearTimeout(id);\n        };\n    };\n\n    /**\n     * The scheduler code that will run in the Worker.\n     */\n    function WorkerScheduler() {\n        var _tasks = {};\n        self.onmessage = function(e) {\n            var cmd = e.data;\n            var id = _tasks[cmd.id];\n            switch (cmd.type) {\n                case 'setTimeout':\n                    _tasks[cmd.id] = self.setTimeout(function() {\n                        delete _tasks[cmd.id];\n                        self.postMessage({\n                            id: cmd.id\n                        });\n                    }, cmd.delay);\n                    break;\n                case 'clearTimeout':\n                    delete _tasks[cmd.id];\n                    if (id) {\n                        self.clearTimeout(id);\n                    }\n                    break;\n                default:\n                    throw 'Unknown command ' + cmd.type;\n            }\n        };\n    }\n\n\n    /**\n     * Utility functions.\n     */\n    var Utils = {\n        isString: function(value) {\n            if (value === undefined || value === null) {\n                return false;\n            }\n            return typeof value === 'string' || value instanceof String;\n        },\n        isArray: function(value) {\n            if (value === undefined || value === null) {\n                return false;\n            }\n            return value instanceof Array;\n        },\n        /**\n         * Returns whether the given element is contained into the given array.\n         * @param element the element to check presence for\n         * @param array the array to check for the element presence\n         * @return the index of the element, if present, or a negative index if the element is not present\n         */\n        inArray: function(element, array) {\n            for (var i = 0; i < array.length; ++i) {\n                if (element === array[i]) {\n                    return i;\n                }\n            }\n            return -1;\n        }\n    };\n\n\n    /**\n     * A registry for transports used by the CometD object.\n     */\n    var TransportRegistry = function() {\n        var _types = [];\n        var _transports = {};\n\n        this.getTransportTypes = function() {\n            return _types.slice(0);\n        };\n\n        this.findTransportTypes = function(version, crossDomain, url) {\n            var result = [];\n            for (var i = 0; i < _types.length; ++i) {\n                var type = _types[i];\n                if (_transports[type].accept(version, crossDomain, url) === true) {\n                    result.push(type);\n                }\n            }\n            return result;\n        };\n\n        this.negotiateTransport = function(types, version, crossDomain, url) {\n            for (var i = 0; i < _types.length; ++i) {\n                var type = _types[i];\n                for (var j = 0; j < types.length; ++j) {\n                    if (type === types[j]) {\n                        var transport = _transports[type];\n                        if (transport.accept(version, crossDomain, url) === true) {\n                            return transport;\n                        }\n                    }\n                }\n            }\n            return null;\n        };\n\n        this.add = function(type, transport, index) {\n            var existing = false;\n            for (var i = 0; i < _types.length; ++i) {\n                if (_types[i] === type) {\n                    existing = true;\n                    break;\n                }\n            }\n\n            if (!existing) {\n                if (typeof index !== 'number') {\n                    _types.push(type);\n                } else {\n                    _types.splice(index, 0, type);\n                }\n                _transports[type] = transport;\n            }\n\n            return !existing;\n        };\n\n        this.find = function(type) {\n            for (var i = 0; i < _types.length; ++i) {\n                if (_types[i] === type) {\n                    return _transports[type];\n                }\n            }\n            return null;\n        };\n\n        this.remove = function(type) {\n            for (var i = 0; i < _types.length; ++i) {\n                if (_types[i] === type) {\n                    _types.splice(i, 1);\n                    var transport = _transports[type];\n                    delete _transports[type];\n                    return transport;\n                }\n            }\n            return null;\n        };\n\n        this.clear = function() {\n            _types = [];\n            _transports = {};\n        };\n\n        this.reset = function(init) {\n            for (var i = 0; i < _types.length; ++i) {\n                _transports[_types[i]].reset(init);\n            }\n        };\n    };\n\n\n    /**\n     * Base object with the common functionality for transports.\n     */\n    var Transport = function() {\n        var _type;\n        var _cometd;\n        var _url;\n\n        /**\n         * Function invoked just after a transport has been successfully registered.\n         * @param type the type of transport (for example 'long-polling')\n         * @param cometd the cometd object this transport has been registered to\n         * @see #unregistered()\n         */\n        this.registered = function(type, cometd) {\n            _type = type;\n            _cometd = cometd;\n        };\n\n        /**\n         * Function invoked just after a transport has been successfully unregistered.\n         * @see #registered(type, cometd)\n         */\n        this.unregistered = function() {\n            _type = null;\n            _cometd = null;\n        };\n\n        this._debug = function() {\n            _cometd._debug.apply(_cometd, arguments);\n        };\n\n        this._mixin = function() {\n            return _cometd._mixin.apply(_cometd, arguments);\n        };\n\n        this.getConfiguration = function() {\n            return _cometd.getConfiguration();\n        };\n\n        this.getAdvice = function() {\n            return _cometd.getAdvice();\n        };\n\n        this.setTimeout = function(funktion, delay) {\n            return _cometd.setTimeout(funktion, delay);\n        };\n\n        this.clearTimeout = function(id) {\n            _cometd.clearTimeout(id);\n        };\n\n        /**\n         * Converts the given response into an array of bayeux messages\n         * @param response the response to convert\n         * @return an array of bayeux messages obtained by converting the response\n         */\n        this.convertToMessages = function(response) {\n            if (Utils.isString(response)) {\n                try {\n                    return JSON.parse(response);\n                } catch (x) {\n                    this._debug('Could not convert to JSON the following string', '\"' + response + '\"');\n                    throw x;\n                }\n            }\n            if (Utils.isArray(response)) {\n                return response;\n            }\n            if (response === undefined || response === null) {\n                return [];\n            }\n            if (response instanceof Object) {\n                return [response];\n            }\n            throw 'Conversion Error ' + response + ', typeof ' + (typeof response);\n        };\n\n        /**\n         * Returns whether this transport can work for the given version and cross domain communication case.\n         * @param version a string indicating the transport version\n         * @param crossDomain a boolean indicating whether the communication is cross domain\n         * @param url the URL to connect to\n         * @return true if this transport can work for the given version and cross domain communication case,\n         * false otherwise\n         */\n        this.accept = function(version, crossDomain, url) {\n            throw 'Abstract';\n        };\n\n        /**\n         * Returns the type of this transport.\n         * @see #registered(type, cometd)\n         */\n        this.getType = function() {\n            return _type;\n        };\n\n        this.getURL = function() {\n            return _url;\n        };\n\n        this.setURL = function(url) {\n            _url = url;\n        };\n\n        this.send = function(envelope, metaConnect) {\n            throw 'Abstract';\n        };\n\n        this.reset = function(init) {\n            this._debug('Transport', _type, 'reset', init ? 'initial' : 'retry');\n        };\n\n        this.abort = function() {\n            this._debug('Transport', _type, 'aborted');\n        };\n\n        this.toString = function() {\n            return this.getType();\n        };\n    };\n\n    Transport.derive = function(baseObject) {\n        function F() {\n        }\n\n        F.prototype = baseObject;\n        return new F();\n    };\n\n\n    /**\n     * Base object with the common functionality for transports based on requests.\n     * The key responsibility is to allow at most 2 outstanding requests to the server,\n     * to avoid that requests are sent behind a long poll.\n     * To achieve this, we have one reserved request for the long poll, and all other\n     * requests are serialized one after the other.\n     */\n    var RequestTransport = function() {\n        var _super = new Transport();\n        var _self = Transport.derive(_super);\n        var _requestIds = 0;\n        var _metaConnectRequest = null;\n        var _requests = [];\n        var _envelopes = [];\n\n        function _coalesceEnvelopes(envelope) {\n            while (_envelopes.length > 0) {\n                var envelopeAndRequest = _envelopes[0];\n                var newEnvelope = envelopeAndRequest[0];\n                var newRequest = envelopeAndRequest[1];\n                if (newEnvelope.url === envelope.url &&\n                    newEnvelope.sync === envelope.sync) {\n                    _envelopes.shift();\n                    envelope.messages = envelope.messages.concat(newEnvelope.messages);\n                    this._debug('Coalesced', newEnvelope.messages.length, 'messages from request', newRequest.id);\n                    continue;\n                }\n                break;\n            }\n        }\n\n        function _transportSend(envelope, request) {\n            this.transportSend(envelope, request);\n            request.expired = false;\n\n            if (!envelope.sync) {\n                var maxDelay = this.getConfiguration().maxNetworkDelay;\n                var delay = maxDelay;\n                if (request.metaConnect === true) {\n                    delay += this.getAdvice().timeout;\n                }\n\n                this._debug('Transport', this.getType(), 'waiting at most', delay, 'ms for the response, maxNetworkDelay', maxDelay);\n\n                var self = this;\n                request.timeout = this.setTimeout(function() {\n                    request.expired = true;\n                    var errorMessage = 'Request ' + request.id + ' of transport ' + self.getType() + ' exceeded ' + delay + ' ms max network delay';\n                    var failure = {\n                        reason: errorMessage\n                    };\n                    var xhr = request.xhr;\n                    failure.httpCode = self.xhrStatus(xhr);\n                    self.abortXHR(xhr);\n                    self._debug(errorMessage);\n                    self.complete(request, false, request.metaConnect);\n                    envelope.onFailure(xhr, envelope.messages, failure);\n                }, delay);\n            }\n        }\n\n        function _queueSend(envelope) {\n            var requestId = ++_requestIds;\n            var request = {\n                id: requestId,\n                metaConnect: false,\n                envelope: envelope\n            };\n\n            // Consider the /meta/connect requests which should always be present.\n            if (_requests.length < this.getConfiguration().maxConnections - 1) {\n                _requests.push(request);\n                _transportSend.call(this, envelope, request);\n            } else {\n                this._debug('Transport', this.getType(), 'queueing request', requestId, 'envelope', envelope);\n                _envelopes.push([envelope, request]);\n            }\n        }\n\n        function _metaConnectComplete(request) {\n            var requestId = request.id;\n            this._debug('Transport', this.getType(), '/meta/connect complete, request', requestId);\n            if (_metaConnectRequest !== null && _metaConnectRequest.id !== requestId) {\n                throw '/meta/connect request mismatch, completing request ' + requestId;\n            }\n            _metaConnectRequest = null;\n        }\n\n        function _complete(request, success) {\n            var index = Utils.inArray(request, _requests);\n            // The index can be negative if the request has been aborted\n            if (index >= 0) {\n                _requests.splice(index, 1);\n            }\n\n            if (_envelopes.length > 0) {\n                var envelopeAndRequest = _envelopes.shift();\n                var nextEnvelope = envelopeAndRequest[0];\n                var nextRequest = envelopeAndRequest[1];\n                this._debug('Transport dequeued request', nextRequest.id);\n                if (success) {\n                    if (this.getConfiguration().autoBatch) {\n                        _coalesceEnvelopes.call(this, nextEnvelope);\n                    }\n                    _queueSend.call(this, nextEnvelope);\n                    this._debug('Transport completed request', request.id, nextEnvelope);\n                } else {\n                    // Keep the semantic of calling response callbacks asynchronously after the request\n                    var self = this;\n                    this.setTimeout(function() {\n                        self.complete(nextRequest, false, nextRequest.metaConnect);\n                        var failure = {\n                            reason: 'Previous request failed'\n                        };\n                        var xhr = nextRequest.xhr;\n                        failure.httpCode = self.xhrStatus(xhr);\n                        nextEnvelope.onFailure(xhr, nextEnvelope.messages, failure);\n                    }, 0);\n                }\n            }\n        }\n\n        _self.complete = function(request, success, metaConnect) {\n            if (metaConnect) {\n                _metaConnectComplete.call(this, request);\n            } else {\n                _complete.call(this, request, success);\n            }\n        };\n\n        /**\n         * Performs the actual send depending on the transport type details.\n         * @param envelope the envelope to send\n         * @param request the request information\n         */\n        _self.transportSend = function(envelope, request) {\n            throw 'Abstract';\n        };\n\n        _self.transportSuccess = function(envelope, request, responses) {\n            if (!request.expired) {\n                this.clearTimeout(request.timeout);\n                this.complete(request, true, request.metaConnect);\n                if (responses && responses.length > 0) {\n                    envelope.onSuccess(responses);\n                } else {\n                    envelope.onFailure(request.xhr, envelope.messages, {\n                        httpCode: 204\n                    });\n                }\n            }\n        };\n\n        _self.transportFailure = function(envelope, request, failure) {\n            if (!request.expired) {\n                this.clearTimeout(request.timeout);\n                this.complete(request, false, request.metaConnect);\n                envelope.onFailure(request.xhr, envelope.messages, failure);\n            }\n        };\n\n        function _metaConnectSend(envelope) {\n            if (_metaConnectRequest !== null) {\n                throw 'Concurrent /meta/connect requests not allowed, request id=' + _metaConnectRequest.id + ' not yet completed';\n            }\n\n            var requestId = ++_requestIds;\n            this._debug('Transport', this.getType(), '/meta/connect send, request', requestId, 'envelope', envelope);\n            var request = {\n                id: requestId,\n                metaConnect: true,\n                envelope: envelope\n            };\n            _transportSend.call(this, envelope, request);\n            _metaConnectRequest = request;\n        }\n\n        _self.send = function(envelope, metaConnect) {\n            if (metaConnect) {\n                _metaConnectSend.call(this, envelope);\n            } else {\n                _queueSend.call(this, envelope);\n            }\n        };\n\n        _self.abort = function() {\n            _super.abort();\n            for (var i = 0; i < _requests.length; ++i) {\n                var request = _requests[i];\n                if (request) {\n                    this._debug('Aborting request', request);\n                    if (!this.abortXHR(request.xhr)) {\n                        this.transportFailure(request.envelope, request, {reason: 'abort'});\n                    }\n                }\n            }\n            var metaConnectRequest = _metaConnectRequest;\n            if (metaConnectRequest) {\n                this._debug('Aborting /meta/connect request', metaConnectRequest);\n                if (!this.abortXHR(metaConnectRequest.xhr)) {\n                    this.transportFailure(metaConnectRequest.envelope, metaConnectRequest, {reason: 'abort'});\n                }\n            }\n            this.reset(true);\n        };\n\n        _self.reset = function(init) {\n            _super.reset(init);\n            _metaConnectRequest = null;\n            _requests = [];\n            _envelopes = [];\n        };\n\n        _self.abortXHR = function(xhr) {\n            if (xhr) {\n                try {\n                    var state = xhr.readyState;\n                    xhr.abort();\n                    return state !== window.XMLHttpRequest.UNSENT;\n                } catch (x) {\n                    this._debug(x);\n                }\n            }\n            return false;\n        };\n\n        _self.xhrStatus = function(xhr) {\n            if (xhr) {\n                try {\n                    return xhr.status;\n                } catch (x) {\n                    this._debug(x);\n                }\n            }\n            return -1;\n        };\n\n        return _self;\n    };\n\n\n    var LongPollingTransport = function() {\n        var _super = new RequestTransport();\n        var _self = Transport.derive(_super);\n        // By default, support cross domain\n        var _supportsCrossDomain = true;\n\n        _self.accept = function(version, crossDomain, url) {\n            return _supportsCrossDomain || !crossDomain;\n        };\n\n        _self.newXMLHttpRequest = function() {\n            return new window.XMLHttpRequest();\n        };\n\n        _self.xhrSend = function(packet) {\n            var xhr = _self.newXMLHttpRequest();\n            // Copy external context, to be used in other environments.\n            xhr.context = _self.context;\n            xhr.withCredentials = true;\n            xhr.open('POST', packet.url, packet.sync !== true);\n            var headers = packet.headers;\n            if (headers) {\n                for (var headerName in headers) {\n                    if (headers.hasOwnProperty(headerName)) {\n                        xhr.setRequestHeader(headerName, headers[headerName]);\n                    }\n                }\n            }\n            xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');\n            xhr.onload = function() {\n                if (xhr.status === 200) {\n                    packet.onSuccess(xhr.responseText);\n                } else {\n                    packet.onError(xhr.statusText);\n                }\n            };\n            xhr.onabort = xhr.onerror = function() {\n                packet.onError(xhr.statusText);\n            };\n            xhr.send(packet.body);\n            return xhr;\n        };\n\n        _self.transportSend = function(envelope, request) {\n            this._debug('Transport', this.getType(), 'sending request', request.id, 'envelope', envelope);\n\n            var self = this;\n            try {\n                var sameStack = true;\n                request.xhr = this.xhrSend({\n                    transport: this,\n                    url: envelope.url,\n                    sync: envelope.sync,\n                    headers: this.getConfiguration().requestHeaders,\n                    body: JSON.stringify(envelope.messages),\n                    onSuccess: function(response) {\n                        self._debug('Transport', self.getType(), 'received response', response);\n                        var success = false;\n                        try {\n                            var received = self.convertToMessages(response);\n                            if (received.length === 0) {\n                                _supportsCrossDomain = false;\n                                self.transportFailure(envelope, request, {\n                                    httpCode: 204\n                                });\n                            } else {\n                                success = true;\n                                self.transportSuccess(envelope, request, received);\n                            }\n                        } catch (x) {\n                            self._debug(x);\n                            if (!success) {\n                                _supportsCrossDomain = false;\n                                var failure = {\n                                    exception: x\n                                };\n                                failure.httpCode = self.xhrStatus(request.xhr);\n                                self.transportFailure(envelope, request, failure);\n                            }\n                        }\n                    },\n                    onError: function(reason, exception) {\n                        self._debug('Transport', self.getType(), 'received error', reason, exception);\n                        _supportsCrossDomain = false;\n                        var failure = {\n                            reason: reason,\n                            exception: exception\n                        };\n                        failure.httpCode = self.xhrStatus(request.xhr);\n                        if (sameStack) {\n                            // Keep the semantic of calling response callbacks asynchronously after the request\n                            self.setTimeout(function() {\n                                self.transportFailure(envelope, request, failure);\n                            }, 0);\n                        } else {\n                            self.transportFailure(envelope, request, failure);\n                        }\n                    }\n                });\n                sameStack = false;\n            } catch (x) {\n                _supportsCrossDomain = false;\n                // Keep the semantic of calling response callbacks asynchronously after the request\n                this.setTimeout(function() {\n                    self.transportFailure(envelope, request, {\n                        exception: x\n                    });\n                }, 0);\n            }\n        };\n\n        _self.reset = function(init) {\n            _super.reset(init);\n            _supportsCrossDomain = true;\n        };\n\n        return _self;\n    };\n\n\n    var CallbackPollingTransport = function() {\n        var _super = new RequestTransport();\n        var _self = Transport.derive(_super);\n        var jsonp = 0;\n\n        _self.accept = function(version, crossDomain, url) {\n            return true;\n        };\n\n        _self.jsonpSend = function(packet) {\n            var head = document.getElementsByTagName('head')[0];\n            var script = document.createElement('script');\n\n            var callbackName = '_cometd_jsonp_' + jsonp++;\n            window[callbackName] = function(responseText) {\n                head.removeChild(script);\n                delete window[callbackName];\n                packet.onSuccess(responseText);\n            };\n\n            var url = packet.url;\n            url += url.indexOf('?') < 0 ? '?' : '&';\n            url += 'jsonp=' + callbackName;\n            url += '&message=' + encodeURIComponent(packet.body);\n            script.src = url;\n            script.async = packet.sync !== true;\n            script.type = 'application/javascript';\n            script.onerror = function(e) {\n                packet.onError('jsonp ' + e.type);\n            };\n            head.appendChild(script);\n        };\n\n        function _failTransportFn(envelope, request, x) {\n            var self = this;\n            return function() {\n                self.transportFailure(envelope, request, 'error', x);\n            };\n        }\n\n        _self.transportSend = function(envelope, request) {\n            var self = this;\n\n            // Microsoft Internet Explorer has a 2083 URL max length\n            // We must ensure that we stay within that length\n            var start = 0;\n            var length = envelope.messages.length;\n            var lengths = [];\n            while (length > 0) {\n                // Encode the messages because all brackets, quotes, commas, colons, etc\n                // present in the JSON will be URL encoded, taking many more characters\n                var json = JSON.stringify(envelope.messages.slice(start, start + length));\n                var urlLength = envelope.url.length + encodeURI(json).length;\n\n                var maxLength = this.getConfiguration().maxURILength;\n                if (urlLength > maxLength) {\n                    if (length === 1) {\n                        var x = 'Bayeux message too big (' + urlLength + ' bytes, max is ' + maxLength + ') ' +\n                            'for transport ' + this.getType();\n                        // Keep the semantic of calling response callbacks asynchronously after the request\n                        this.setTimeout(_failTransportFn.call(this, envelope, request, x), 0);\n                        return;\n                    }\n\n                    --length;\n                    continue;\n                }\n\n                lengths.push(length);\n                start += length;\n                length = envelope.messages.length - start;\n            }\n\n            // Here we are sure that the messages can be sent within the URL limit\n\n            var envelopeToSend = envelope;\n            if (lengths.length > 1) {\n                var begin = 0;\n                var end = lengths[0];\n                this._debug('Transport', this.getType(), 'split', envelope.messages.length, 'messages into', lengths.join(' + '));\n                envelopeToSend = this._mixin(false, {}, envelope);\n                envelopeToSend.messages = envelope.messages.slice(begin, end);\n                envelopeToSend.onSuccess = envelope.onSuccess;\n                envelopeToSend.onFailure = envelope.onFailure;\n\n                for (var i = 1; i < lengths.length; ++i) {\n                    var nextEnvelope = this._mixin(false, {}, envelope);\n                    begin = end;\n                    end += lengths[i];\n                    nextEnvelope.messages = envelope.messages.slice(begin, end);\n                    nextEnvelope.onSuccess = envelope.onSuccess;\n                    nextEnvelope.onFailure = envelope.onFailure;\n                    this.send(nextEnvelope, request.metaConnect);\n                }\n            }\n\n            this._debug('Transport', this.getType(), 'sending request', request.id, 'envelope', envelopeToSend);\n\n            try {\n                var sameStack = true;\n                this.jsonpSend({\n                    transport: this,\n                    url: envelopeToSend.url,\n                    sync: envelopeToSend.sync,\n                    headers: this.getConfiguration().requestHeaders,\n                    body: JSON.stringify(envelopeToSend.messages),\n                    onSuccess: function(responses) {\n                        var success = false;\n                        try {\n                            var received = self.convertToMessages(responses);\n                            if (received.length === 0) {\n                                self.transportFailure(envelopeToSend, request, {\n                                    httpCode: 204\n                                });\n                            } else {\n                                success = true;\n                                self.transportSuccess(envelopeToSend, request, received);\n                            }\n                        } catch (x) {\n                            self._debug(x);\n                            if (!success) {\n                                self.transportFailure(envelopeToSend, request, {\n                                    exception: x\n                                });\n                            }\n                        }\n                    },\n                    onError: function(reason, exception) {\n                        var failure = {\n                            reason: reason,\n                            exception: exception\n                        };\n                        if (sameStack) {\n                            // Keep the semantic of calling response callbacks asynchronously after the request\n                            self.setTimeout(function() {\n                                self.transportFailure(envelopeToSend, request, failure);\n                            }, 0);\n                        } else {\n                            self.transportFailure(envelopeToSend, request, failure);\n                        }\n                    }\n                });\n                sameStack = false;\n            } catch (xx) {\n                // Keep the semantic of calling response callbacks asynchronously after the request\n                this.setTimeout(function() {\n                    self.transportFailure(envelopeToSend, request, {\n                        exception: xx\n                    });\n                }, 0);\n            }\n        };\n\n        return _self;\n    };\n\n\n    var WebSocketTransport = function() {\n        var _super = new Transport();\n        var _self = Transport.derive(_super);\n        var _cometd;\n        // By default WebSocket is supported\n        var _webSocketSupported = true;\n        // Whether we were able to establish a WebSocket connection\n        var _webSocketConnected = false;\n        var _stickyReconnect = true;\n        // The context contains the envelopes that have been sent\n        // and the timeouts for the messages that have been sent.\n        var _context = null;\n        var _connecting = null;\n        var _connected = false;\n        var _successCallback = null;\n\n        _self.reset = function(init) {\n            _super.reset(init);\n            _webSocketSupported = true;\n            if (init) {\n                _webSocketConnected = false;\n            }\n            _stickyReconnect = true;\n            _context = null;\n            _connecting = null;\n            _connected = false;\n        };\n\n        function _forceClose(context, event) {\n            if (context) {\n                this.webSocketClose(context, event.code, event.reason);\n                // Force immediate failure of pending messages to trigger reconnect.\n                // This is needed because the server may not reply to our close()\n                // and therefore the onclose function is never called.\n                this.onClose(context, event);\n            }\n        }\n\n        function _sameContext(context) {\n            return context === _connecting || context === _context;\n        }\n\n        function _storeEnvelope(context, envelope, metaConnect) {\n            var messageIds = [];\n            for (var i = 0; i < envelope.messages.length; ++i) {\n                var message = envelope.messages[i];\n                if (message.id) {\n                    messageIds.push(message.id);\n                }\n            }\n            context.envelopes[messageIds.join(',')] = [envelope, metaConnect];\n            this._debug('Transport', this.getType(), 'stored envelope, envelopes', context.envelopes);\n        }\n\n        function _websocketConnect(context) {\n            // We may have multiple attempts to open a WebSocket\n            // connection, for example a /meta/connect request that\n            // may take time, along with a user-triggered publish.\n            // Early return if we are already connecting.\n            if (_connecting) {\n                return;\n            }\n\n            // Mangle the URL, changing the scheme from 'http' to 'ws'.\n            var url = _cometd.getURL().replace(/^http/, 'ws');\n            this._debug('Transport', this.getType(), 'connecting to URL', url);\n\n            try {\n                var protocol = _cometd.getConfiguration().protocol;\n                context.webSocket = protocol ? new window.WebSocket(url, protocol) : new window.WebSocket(url);\n                _connecting = context;\n            } catch (x) {\n                _webSocketSupported = false;\n                this._debug('Exception while creating WebSocket object', x);\n                throw x;\n            }\n\n            // By default use sticky reconnects.\n            _stickyReconnect = _cometd.getConfiguration().stickyReconnect !== false;\n\n            var self = this;\n            var connectTimeout = _cometd.getConfiguration().connectTimeout;\n            if (connectTimeout > 0) {\n                context.connectTimer = this.setTimeout(function() {\n                    _cometd._debug('Transport', self.getType(), 'timed out while connecting to URL', url, ':', connectTimeout, 'ms');\n                    // The connection was not opened, close anyway.\n                    _forceClose.call(self, context, {code: 1000, reason: 'Connect Timeout'});\n                }, connectTimeout);\n            }\n\n            var onopen = function() {\n                _cometd._debug('WebSocket onopen', context);\n                if (context.connectTimer) {\n                    self.clearTimeout(context.connectTimer);\n                }\n\n                if (_sameContext(context)) {\n                    _connecting = null;\n                    _context = context;\n                    _webSocketConnected = true;\n                    self.onOpen(context);\n                } else {\n                    // We have a valid connection already, close this one.\n                    _cometd._warn('Closing extra WebSocket connection', this, 'active connection', _context);\n                    _forceClose.call(self, context, {code: 1000, reason: 'Extra Connection'});\n                }\n            };\n\n            // This callback is invoked when the server sends the close frame.\n            // The close frame for a connection may arrive *after* another\n            // connection has been opened, so we must make sure that actions\n            // are performed only if it's the same connection.\n            var onclose = function(event) {\n                event = event || {code: 1000};\n                _cometd._debug('WebSocket onclose', context, event, 'connecting', _connecting, 'current', _context);\n\n                if (context.connectTimer) {\n                    self.clearTimeout(context.connectTimer);\n                }\n\n                self.onClose(context, event);\n            };\n\n            var onmessage = function(wsMessage) {\n                _cometd._debug('WebSocket onmessage', wsMessage, context);\n                self.onMessage(context, wsMessage);\n            };\n\n            context.webSocket.onopen = onopen;\n            context.webSocket.onclose = onclose;\n            context.webSocket.onerror = function() {\n                // Clients should call onclose(), but if they do not we do it here for safety.\n                onclose({code: 1000, reason: 'Error'});\n            };\n            context.webSocket.onmessage = onmessage;\n\n            this._debug('Transport', this.getType(), 'configured callbacks on', context);\n        }\n\n        function _webSocketSend(context, envelope, metaConnect) {\n            var json = JSON.stringify(envelope.messages);\n            context.webSocket.send(json);\n            this._debug('Transport', this.getType(), 'sent', envelope, '/meta/connect =', metaConnect);\n\n            // Manage the timeout waiting for the response.\n            var maxDelay = this.getConfiguration().maxNetworkDelay;\n            var delay = maxDelay;\n            if (metaConnect) {\n                delay += this.getAdvice().timeout;\n                _connected = true;\n            }\n\n            var self = this;\n            var messageIds = [];\n            for (var i = 0; i < envelope.messages.length; ++i) {\n                (function() {\n                    var message = envelope.messages[i];\n                    if (message.id) {\n                        messageIds.push(message.id);\n                        context.timeouts[message.id] = self.setTimeout(function() {\n                            _cometd._debug('Transport', self.getType(), 'timing out message', message.id, 'after', delay, 'on', context);\n                            _forceClose.call(self, context, {code: 1000, reason: 'Message Timeout'});\n                        }, delay);\n                    }\n                })();\n            }\n\n            this._debug('Transport', this.getType(), 'waiting at most', delay, 'ms for messages', messageIds, 'maxNetworkDelay', maxDelay, ', timeouts:', context.timeouts);\n        }\n\n        _self._notifySuccess = function(fn, messages) {\n            fn.call(this, messages);\n        };\n\n        _self._notifyFailure = function(fn, context, messages, failure) {\n            fn.call(this, context, messages, failure);\n        };\n\n        function _send(context, envelope, metaConnect) {\n            try {\n                if (context === null) {\n                    context = _connecting || {\n                        envelopes: {},\n                        timeouts: {}\n                    };\n                    _storeEnvelope.call(this, context, envelope, metaConnect);\n                    _websocketConnect.call(this, context);\n                } else {\n                    _storeEnvelope.call(this, context, envelope, metaConnect);\n                    _webSocketSend.call(this, context, envelope, metaConnect);\n                }\n            } catch (x) {\n                // Keep the semantic of calling response callbacks asynchronously after the request.\n                var self = this;\n                this.setTimeout(function() {\n                    _forceClose.call(self, context, {\n                        code: 1000,\n                        reason: 'Exception',\n                        exception: x\n                    });\n                }, 0);\n            }\n        }\n\n        _self.onOpen = function(context) {\n            var envelopes = context.envelopes;\n            this._debug('Transport', this.getType(), 'opened', context, 'pending messages', envelopes);\n            for (var key in envelopes) {\n                if (envelopes.hasOwnProperty(key)) {\n                    var element = envelopes[key];\n                    var envelope = element[0];\n                    var metaConnect = element[1];\n                    // Store the success callback, which is independent from the envelope,\n                    // so that it can be used to notify arrival of messages.\n                    _successCallback = envelope.onSuccess;\n                    _webSocketSend.call(this, context, envelope, metaConnect);\n                }\n            }\n        };\n\n        _self.onMessage = function(context, wsMessage) {\n            this._debug('Transport', this.getType(), 'received websocket message', wsMessage, context);\n\n            var close = false;\n            var messages = this.convertToMessages(wsMessage.data);\n            var messageIds = [];\n            for (var i = 0; i < messages.length; ++i) {\n                var message = messages[i];\n\n                // Detect if the message is a response to a request we made.\n                // If it's a meta message, for sure it's a response; otherwise it's\n                // a publish message and publish responses don't have the data field.\n                if (/^\\/meta\\//.test(message.channel) || message.data === undefined) {\n                    if (message.id) {\n                        messageIds.push(message.id);\n\n                        var timeout = context.timeouts[message.id];\n                        if (timeout) {\n                            this.clearTimeout(timeout);\n                            delete context.timeouts[message.id];\n                            this._debug('Transport', this.getType(), 'removed timeout for message', message.id, ', timeouts', context.timeouts);\n                        }\n                    }\n                }\n\n                if ('/meta/connect' === message.channel) {\n                    _connected = false;\n                }\n                if ('/meta/disconnect' === message.channel && !_connected) {\n                    close = true;\n                }\n            }\n\n            // Remove the envelope corresponding to the messages.\n            var removed = false;\n            var envelopes = context.envelopes;\n            for (var j = 0; j < messageIds.length; ++j) {\n                var id = messageIds[j];\n                for (var key in envelopes) {\n                    if (envelopes.hasOwnProperty(key)) {\n                        var ids = key.split(',');\n                        var index = Utils.inArray(id, ids);\n                        if (index >= 0) {\n                            removed = true;\n                            ids.splice(index, 1);\n                            var envelope = envelopes[key][0];\n                            var metaConnect = envelopes[key][1];\n                            delete envelopes[key];\n                            if (ids.length > 0) {\n                                envelopes[ids.join(',')] = [envelope, metaConnect];\n                            }\n                            break;\n                        }\n                    }\n                }\n            }\n            if (removed) {\n                this._debug('Transport', this.getType(), 'removed envelope, envelopes', envelopes);\n            }\n\n            this._notifySuccess(_successCallback, messages);\n\n            if (close) {\n                this.webSocketClose(context, 1000, 'Disconnect');\n            }\n        };\n\n        _self.onClose = function(context, event) {\n            this._debug('Transport', this.getType(), 'closed', context, event);\n\n            if (_sameContext(context)) {\n                // Remember if we were able to connect.\n                // This close event could be due to server shutdown,\n                // and if it restarts we want to try websocket again.\n                _webSocketSupported = _stickyReconnect && _webSocketConnected;\n                _connecting = null;\n                _context = null;\n            }\n\n            var timeouts = context.timeouts;\n            context.timeouts = {};\n            for (var id in timeouts) {\n                if (timeouts.hasOwnProperty(id)) {\n                    this.clearTimeout(timeouts[id]);\n                }\n            }\n\n            var envelopes = context.envelopes;\n            context.envelopes = {};\n            for (var key in envelopes) {\n                if (envelopes.hasOwnProperty(key)) {\n                    var envelope = envelopes[key][0];\n                    var metaConnect = envelopes[key][1];\n                    if (metaConnect) {\n                        _connected = false;\n                    }\n                    var failure = {\n                        websocketCode: event.code,\n                        reason: event.reason\n                    };\n                    if (event.exception) {\n                        failure.exception = event.exception;\n                    }\n                    this._notifyFailure(envelope.onFailure, context, envelope.messages, failure);\n                }\n            }\n        };\n\n        _self.registered = function(type, cometd) {\n            _super.registered(type, cometd);\n            _cometd = cometd;\n        };\n\n        _self.accept = function(version, crossDomain, url) {\n            this._debug('Transport', this.getType(), 'accept, supported:', _webSocketSupported);\n            // Using !! to return a boolean (and not the WebSocket object).\n            return _webSocketSupported && !!window.WebSocket && _cometd.websocketEnabled !== false;\n        };\n\n        _self.send = function(envelope, metaConnect) {\n            this._debug('Transport', this.getType(), 'sending', envelope, '/meta/connect =', metaConnect);\n            _send.call(this, _context, envelope, metaConnect);\n        };\n\n        _self.webSocketClose = function(context, code, reason) {\n            try {\n                if (context.webSocket) {\n                    context.webSocket.close(code, reason);\n                }\n            } catch (x) {\n                this._debug(x);\n            }\n        };\n\n        _self.abort = function() {\n            _super.abort();\n            _forceClose.call(this, _context, {code: 1000, reason: 'Abort'});\n            this.reset(true);\n        };\n\n        return _self;\n    };\n\n\n    /**\n     * The constructor for a CometD object, identified by an optional name.\n     * The default name is the string 'default'.\n     * @param name the optional name of this cometd object\n     */\n    var CometD = function(name) {\n        var _scheduler = new Scheduler();\n        var _cometd = this;\n        var _name = name || 'default';\n        var _crossDomain = false;\n        var _transports = new TransportRegistry();\n        var _transport;\n        var _status = 'disconnected';\n        var _messageId = 0;\n        var _clientId = null;\n        var _batch = 0;\n        var _messageQueue = [];\n        var _internalBatch = false;\n        var _listenerId = 0;\n        var _listeners = {};\n        var _backoff = 0;\n        var _scheduledSend = null;\n        var _extensions = [];\n        var _advice = {};\n        var _handshakeProps;\n        var _handshakeCallback;\n        var _callbacks = {};\n        var _remoteCalls = {};\n        var _reestablish = false;\n        var _connected = false;\n        var _unconnectTime = 0;\n        var _handshakeMessages = 0;\n        var _metaConnect = null;\n        var _config = {\n            useWorkerScheduler: true,\n            protocol: null,\n            stickyReconnect: true,\n            connectTimeout: 0,\n            maxConnections: 2,\n            backoffIncrement: 1000,\n            maxBackoff: 60000,\n            logLevel: 'info',\n            maxNetworkDelay: 10000,\n            requestHeaders: {},\n            appendMessageTypeToURL: true,\n            autoBatch: false,\n            urls: {},\n            maxURILength: 2000,\n            advice: {\n                timeout: 60000,\n                interval: 0,\n                reconnect: undefined,\n                maxInterval: 0\n            }\n        };\n\n        function _fieldValue(object, name) {\n            try {\n                return object[name];\n            } catch (x) {\n                return undefined;\n            }\n        }\n\n        /**\n         * Mixes in the given objects into the target object by copying the properties.\n         * @param deep if the copy must be deep\n         * @param target the target object\n         * @param objects the objects whose properties are copied into the target\n         */\n        this._mixin = function(deep, target, objects) {\n            var result = target || {};\n\n            // Skip first 2 parameters (deep and target), and loop over the others\n            for (var i = 2; i < arguments.length; ++i) {\n                var object = arguments[i];\n\n                if (object === undefined || object === null) {\n                    continue;\n                }\n\n                for (var propName in object) {\n                    if (object.hasOwnProperty(propName)) {\n                        var prop = _fieldValue(object, propName);\n                        var targ = _fieldValue(result, propName);\n\n                        // Avoid infinite loops\n                        if (prop === target) {\n                            continue;\n                        }\n                        // Do not mixin undefined values\n                        if (prop === undefined) {\n                            continue;\n                        }\n\n                        if (deep && typeof prop === 'object' && prop !== null) {\n                            if (prop instanceof Array) {\n                                result[propName] = this._mixin(deep, targ instanceof Array ? targ : [], prop);\n                            } else {\n                                var source = typeof targ === 'object' && !(targ instanceof Array) ? targ : {};\n                                result[propName] = this._mixin(deep, source, prop);\n                            }\n                        } else {\n                            result[propName] = prop;\n                        }\n                    }\n                }\n            }\n\n            return result;\n        };\n\n        function _isString(value) {\n            return Utils.isString(value);\n        }\n\n        function _isFunction(value) {\n            if (value === undefined || value === null) {\n                return false;\n            }\n            return typeof value === 'function';\n        }\n\n        function _zeroPad(value, length) {\n            var result = '';\n            while (--length > 0) {\n                if (value >= Math.pow(10, length)) {\n                    break;\n                }\n                result += '0';\n            }\n            result += value;\n            return result;\n        }\n\n        function _log(level, args) {\n            if (window.console) {\n                var logger = window.console[level];\n                if (_isFunction(logger)) {\n                    var now = new Date();\n                    [].splice.call(args, 0, 0, _zeroPad(now.getHours(), 2) + ':' + _zeroPad(now.getMinutes(), 2) + ':' +\n                        _zeroPad(now.getSeconds(), 2) + '.' + _zeroPad(now.getMilliseconds(), 3));\n                    logger.apply(window.console, args);\n                }\n            }\n        }\n\n        this._warn = function() {\n            _log('warn', arguments);\n        };\n\n        this._info = function() {\n            if (_config.logLevel !== 'warn') {\n                _log('info', arguments);\n            }\n        };\n\n        this._debug = function() {\n            if (_config.logLevel === 'debug') {\n                _log('debug', arguments);\n            }\n        };\n\n        function _splitURL(url) {\n            // [1] = protocol://,\n            // [2] = host:port,\n            // [3] = host,\n            // [4] = IPv6_host,\n            // [5] = IPv4_host,\n            // [6] = :port,\n            // [7] = port,\n            // [8] = uri,\n            // [9] = rest (query / fragment)\n            return new RegExp('(^https?://)?(((\\\\[[^\\\\]]+])|([^:/?#]+))(:(\\\\d+))?)?([^?#]*)(.*)?').exec(url);\n        }\n\n        /**\n         * Returns whether the given hostAndPort is cross domain.\n         * The default implementation checks against window.location.host\n         * but this function can be overridden to make it work in non-browser\n         * environments.\n         *\n         * @param hostAndPort the host and port in format host:port\n         * @return whether the given hostAndPort is cross domain\n         */\n        this._isCrossDomain = function(hostAndPort) {\n            if (window.location && window.location.host) {\n                if (hostAndPort) {\n                    return hostAndPort !== window.location.host;\n                }\n            }\n            return false;\n        };\n\n        function _configure(configuration) {\n            _cometd._debug('Configuring cometd object with', configuration);\n            // Support old style param, where only the Bayeux server URL was passed.\n            if (_isString(configuration)) {\n                configuration = {\n                    url: configuration\n                };\n            }\n            if (!configuration) {\n                configuration = {};\n            }\n\n            _config = _cometd._mixin(false, _config, configuration);\n\n            var url = _cometd.getURL();\n            if (!url) {\n                throw 'Missing required configuration parameter \\'url\\' specifying the Bayeux server URL';\n            }\n\n            // Check if we're cross domain.\n            var urlParts = _splitURL(url);\n            var hostAndPort = urlParts[2];\n            var uri = urlParts[8];\n            var afterURI = urlParts[9];\n            _crossDomain = _cometd._isCrossDomain(hostAndPort);\n\n            // Check if appending extra path is supported.\n            if (_config.appendMessageTypeToURL) {\n                if (afterURI !== undefined && afterURI.length > 0) {\n                    _cometd._info('Appending message type to URI ' + uri + afterURI + ' is not supported, disabling \\'appendMessageTypeToURL\\' configuration');\n                    _config.appendMessageTypeToURL = false;\n                } else {\n                    var uriSegments = uri.split('/');\n                    var lastSegmentIndex = uriSegments.length - 1;\n                    if (uri.match(/\\/$/)) {\n                        lastSegmentIndex -= 1;\n                    }\n                    if (uriSegments[lastSegmentIndex].indexOf('.') >= 0) {\n                        // Very likely the CometD servlet's URL pattern is mapped to an extension, such as *.cometd\n                        // It will be difficult to add the extra path in this case\n                        _cometd._info('Appending message type to URI ' + uri + ' is not supported, disabling \\'appendMessageTypeToURL\\' configuration');\n                        _config.appendMessageTypeToURL = false;\n                    }\n                }\n            }\n\n            if (window.Worker && window.Blob && window.URL && _config.useWorkerScheduler) {\n                var code = WorkerScheduler.toString();\n                // Remove the function declaration, the opening brace and the closing brace.\n                code = code.substring(code.indexOf('{') + 1, code.lastIndexOf('}'));\n                var blob = new window.Blob([code], {\n                    type: 'application/json'\n                });\n                var blobURL = window.URL.createObjectURL(blob);\n                var worker = new window.Worker(blobURL);\n                _scheduler.setTimeout = function(funktion, delay) {\n                    var id = _scheduler.register(funktion);\n                    worker.postMessage({\n                        id: id,\n                        type: 'setTimeout',\n                        delay: delay\n                    });\n                    return id;\n                };\n                _scheduler.clearTimeout = function(id) {\n                    _scheduler.unregister(id);\n                    worker.postMessage({\n                        id: id,\n                        type: 'clearTimeout'\n                    });\n                };\n                worker.onmessage = function(e) {\n                    var id = e.data.id;\n                    var funktion = _scheduler.unregister(id);\n                    if (funktion) {\n                        funktion();\n                    }\n                };\n            }\n        }\n\n        function _removeListener(subscription) {\n            if (subscription) {\n                var subscriptions = _listeners[subscription.channel];\n                if (subscriptions && subscriptions[subscription.id]) {\n                    delete subscriptions[subscription.id];\n                    _cometd._debug('Removed', subscription.listener ? 'listener' : 'subscription', subscription);\n                }\n            }\n        }\n\n        function _removeSubscription(subscription) {\n            if (subscription && !subscription.listener) {\n                _removeListener(subscription);\n            }\n        }\n\n        function _clearSubscriptions() {\n            for (var channel in _listeners) {\n                if (_listeners.hasOwnProperty(channel)) {\n                    var subscriptions = _listeners[channel];\n                    if (subscriptions) {\n                        for (var id in subscriptions) {\n                            if (subscriptions.hasOwnProperty(id)) {\n                                _removeSubscription(subscriptions[id]);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        function _setStatus(newStatus) {\n            if (_status !== newStatus) {\n                _cometd._debug('Status', _status, '->', newStatus);\n                _status = newStatus;\n            }\n        }\n\n        function _isDisconnected() {\n            return _status === 'disconnecting' || _status === 'disconnected';\n        }\n\n        function _nextMessageId() {\n            var result = ++_messageId;\n            return '' + result;\n        }\n\n        function _applyExtension(scope, callback, name, message, outgoing) {\n            try {\n                return callback.call(scope, message);\n            } catch (x) {\n                var handler = _cometd.onExtensionException;\n                if (_isFunction(handler)) {\n                    _cometd._debug('Invoking extension exception handler', name, x);\n                    try {\n                        handler.call(_cometd, x, name, outgoing, message);\n                    } catch (xx) {\n                        _cometd._info('Exception during execution of extension exception handler', name, xx);\n                    }\n                } else {\n                    _cometd._info('Exception during execution of extension', name, x);\n                }\n                return message;\n            }\n        }\n\n        function _applyIncomingExtensions(message) {\n            for (var i = 0; i < _extensions.length; ++i) {\n                if (message === undefined || message === null) {\n                    break;\n                }\n\n                var extension = _extensions[i];\n                var callback = extension.extension.incoming;\n                if (_isFunction(callback)) {\n                    var result = _applyExtension(extension.extension, callback, extension.name, message, false);\n                    message = result === undefined ? message : result;\n                }\n            }\n            return message;\n        }\n\n        function _applyOutgoingExtensions(message) {\n            for (var i = _extensions.length - 1; i >= 0; --i) {\n                if (message === undefined || message === null) {\n                    break;\n                }\n\n                var extension = _extensions[i];\n                var callback = extension.extension.outgoing;\n                if (_isFunction(callback)) {\n                    var result = _applyExtension(extension.extension, callback, extension.name, message, true);\n                    message = result === undefined ? message : result;\n                }\n            }\n            return message;\n        }\n\n        function _notify(channel, message) {\n            var subscriptions = _listeners[channel];\n            if (subscriptions) {\n                for (var id in subscriptions) {\n                    if (subscriptions.hasOwnProperty(id)) {\n                        var subscription = subscriptions[id];\n                        // Subscriptions may come and go, so the array may have 'holes'\n                        if (subscription) {\n                            try {\n                                subscription.callback.call(subscription.scope, message);\n                            } catch (x) {\n                                var handler = _cometd.onListenerException;\n                                if (_isFunction(handler)) {\n                                    _cometd._debug('Invoking listener exception handler', subscription, x);\n                                    try {\n                                        handler.call(_cometd, x, subscription, subscription.listener, message);\n                                    } catch (xx) {\n                                        _cometd._info('Exception during execution of listener exception handler', subscription, xx);\n                                    }\n                                } else {\n                                    _cometd._info('Exception during execution of listener', subscription, message, x);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        function _notifyListeners(channel, message) {\n            // Notify direct listeners\n            _notify(channel, message);\n\n            // Notify the globbing listeners\n            var channelParts = channel.split('/');\n            var last = channelParts.length - 1;\n            for (var i = last; i > 0; --i) {\n                var channelPart = channelParts.slice(0, i).join('/') + '/*';\n                // We don't want to notify /foo/* if the channel is /foo/bar/baz,\n                // so we stop at the first non recursive globbing\n                if (i === last) {\n                    _notify(channelPart, message);\n                }\n                // Add the recursive globber and notify\n                channelPart += '*';\n                _notify(channelPart, message);\n            }\n        }\n\n        function _cancelDelayedSend() {\n            if (_scheduledSend !== null) {\n                _cometd.clearTimeout(_scheduledSend);\n            }\n            _scheduledSend = null;\n        }\n\n        function _delayedSend(operation, delay) {\n            _cancelDelayedSend();\n            var time = _advice.interval + delay;\n            _cometd._debug('Function scheduled in', time, 'ms, interval =', _advice.interval, 'backoff =', _backoff, operation);\n            _scheduledSend = _cometd.setTimeout(operation, time);\n        }\n\n        // Needed to break cyclic dependencies between function definitions\n        var _handleMessages;\n        var _handleFailure;\n\n        /**\n         * Delivers the messages to the CometD server\n         * @param sync whether the send is synchronous\n         * @param messages the array of messages to send\n         * @param metaConnect true if this send is on /meta/connect\n         * @param extraPath an extra path to append to the Bayeux server URL\n         */\n        function _send(sync, messages, metaConnect, extraPath) {\n            // We must be sure that the messages have a clientId.\n            // This is not guaranteed since the handshake may take time to return\n            // (and hence the clientId is not known yet) and the application\n            // may create other messages.\n            for (var i = 0; i < messages.length; ++i) {\n                var message = messages[i];\n                var messageId = message.id;\n\n                if (_clientId) {\n                    message.clientId = _clientId;\n                }\n\n                message = _applyOutgoingExtensions(message);\n                if (message !== undefined && message !== null) {\n                    // Extensions may have modified the message id, but we need to own it.\n                    message.id = messageId;\n                    messages[i] = message;\n                } else {\n                    delete _callbacks[messageId];\n                    messages.splice(i--, 1);\n                }\n            }\n\n            if (messages.length === 0) {\n                return;\n            }\n\n            if (metaConnect) {\n                _metaConnect = messages[0];\n            }\n\n            var url = _cometd.getURL();\n            if (_config.appendMessageTypeToURL) {\n                // If url does not end with '/', then append it\n                if (!url.match(/\\/$/)) {\n                    url = url + '/';\n                }\n                if (extraPath) {\n                    url = url + extraPath;\n                }\n            }\n\n            var envelope = {\n                url: url,\n                sync: sync,\n                messages: messages,\n                onSuccess: function(rcvdMessages) {\n                    try {\n                        _handleMessages.call(_cometd, rcvdMessages);\n                    } catch (x) {\n                        _cometd._info('Exception during handling of messages', x);\n                    }\n                },\n                onFailure: function(conduit, messages, failure) {\n                    try {\n                        var transport = _cometd.getTransport();\n                        failure.connectionType = transport ? transport.getType() : \"unknown\";\n                        _handleFailure.call(_cometd, conduit, messages, failure);\n                    } catch (x) {\n                        _cometd._info('Exception during handling of failure', x);\n                    }\n                }\n            };\n            _cometd._debug('Send', envelope);\n            _transport.send(envelope, metaConnect);\n        }\n\n        function _queueSend(message) {\n            if (_batch > 0 || _internalBatch === true) {\n                _messageQueue.push(message);\n            } else {\n                _send(false, [message], false);\n            }\n        }\n\n        /**\n         * Sends a complete bayeux message.\n         * This method is exposed as a public so that extensions may use it\n         * to send bayeux message directly, for example in case of re-sending\n         * messages that have already been sent but that for some reason must\n         * be resent.\n         */\n        this.send = _queueSend;\n\n        function _resetBackoff() {\n            _backoff = 0;\n        }\n\n        function _increaseBackoff() {\n            if (_backoff < _config.maxBackoff) {\n                _backoff += _config.backoffIncrement;\n            }\n            return _backoff;\n        }\n\n        /**\n         * Starts a the batch of messages to be sent in a single request.\n         * @see #_endBatch(sendMessages)\n         */\n        function _startBatch() {\n            ++_batch;\n            _cometd._debug('Starting batch, depth', _batch);\n        }\n\n        function _flushBatch() {\n            var messages = _messageQueue;\n            _messageQueue = [];\n            if (messages.length > 0) {\n                _send(false, messages, false);\n            }\n        }\n\n        /**\n         * Ends the batch of messages to be sent in a single request,\n         * optionally sending messages present in the message queue depending\n         * on the given argument.\n         * @see #_startBatch()\n         */\n        function _endBatch() {\n            --_batch;\n            _cometd._debug('Ending batch, depth', _batch);\n            if (_batch < 0) {\n                throw 'Calls to startBatch() and endBatch() are not paired';\n            }\n\n            if (_batch === 0 && !_isDisconnected() && !_internalBatch) {\n                _flushBatch();\n            }\n        }\n\n        /**\n         * Sends the connect message\n         */\n        function _connect() {\n            if (!_isDisconnected()) {\n                var bayeuxMessage = {\n                    id: _nextMessageId(),\n                    channel: '/meta/connect',\n                    connectionType: _transport.getType()\n                };\n\n                // In case of reload or temporary loss of connection\n                // we want the next successful connect to return immediately\n                // instead of being held by the server, so that connect listeners\n                // can be notified that the connection has been re-established\n                if (!_connected) {\n                    bayeuxMessage.advice = {\n                        timeout: 0\n                    };\n                }\n\n                _setStatus('connecting');\n                _cometd._debug('Connect sent', bayeuxMessage);\n                _send(false, [bayeuxMessage], true, 'connect');\n                _setStatus('connected');\n            }\n        }\n\n        function _delayedConnect(delay) {\n            _setStatus('connecting');\n            _delayedSend(function() {\n                _connect();\n            }, delay);\n        }\n\n        function _updateAdvice(newAdvice) {\n            if (newAdvice) {\n                _advice = _cometd._mixin(false, {}, _config.advice, newAdvice);\n                _cometd._debug('New advice', _advice);\n            }\n        }\n\n        function _disconnect(abort) {\n            _cancelDelayedSend();\n            if (abort && _transport) {\n                _transport.abort();\n            }\n            _crossDomain = false;\n            _transport = null;\n            _setStatus('disconnected');\n            _clientId = null;\n            _batch = 0;\n            _resetBackoff();\n            _reestablish = false;\n            _connected = false;\n            _unconnectTime = 0;\n            _metaConnect = null;\n\n            // Fail any existing queued message\n            if (_messageQueue.length > 0) {\n                var messages = _messageQueue;\n                _messageQueue = [];\n                _handleFailure.call(_cometd, undefined, messages, {\n                    reason: 'Disconnected'\n                });\n            }\n        }\n\n        function _notifyTransportException(oldTransport, newTransport, failure) {\n            var handler = _cometd.onTransportException;\n            if (_isFunction(handler)) {\n                _cometd._debug('Invoking transport exception handler', oldTransport, newTransport, failure);\n                try {\n                    handler.call(_cometd, failure, oldTransport, newTransport);\n                } catch (x) {\n                    _cometd._info('Exception during execution of transport exception handler', x);\n                }\n            }\n        }\n\n        /**\n         * Sends the initial handshake message\n         */\n        function _handshake(handshakeProps, handshakeCallback) {\n            if (_isFunction(handshakeProps)) {\n                handshakeCallback = handshakeProps;\n                handshakeProps = undefined;\n            }\n\n            _clientId = null;\n\n            _clearSubscriptions();\n\n            // Reset the transports if we're not retrying the handshake\n            if (_isDisconnected()) {\n                _transports.reset(true);\n            }\n\n            // Reset the advice.\n            _updateAdvice({});\n\n            _batch = 0;\n\n            // Mark the start of an internal batch.\n            // This is needed because handshake and connect are async.\n            // It may happen that the application calls init() then subscribe()\n            // and the subscribe message is sent before the connect message, if\n            // the subscribe message is not held until the connect message is sent.\n            // So here we start a batch to hold temporarily any message until\n            // the connection is fully established.\n            _internalBatch = true;\n\n            // Save the properties provided by the user, so that\n            // we can reuse them during automatic re-handshake\n            _handshakeProps = handshakeProps;\n            _handshakeCallback = handshakeCallback;\n\n            var version = '1.0';\n\n            // Figure out the transports to send to the server\n            var url = _cometd.getURL();\n            var transportTypes = _transports.findTransportTypes(version, _crossDomain, url);\n\n            var bayeuxMessage = {\n                id: _nextMessageId(),\n                version: version,\n                minimumVersion: version,\n                channel: '/meta/handshake',\n                supportedConnectionTypes: transportTypes,\n                advice: {\n                    timeout: _advice.timeout,\n                    interval: _advice.interval\n                }\n            };\n            // Do not allow the user to override important fields.\n            var message = _cometd._mixin(false, {}, _handshakeProps, bayeuxMessage);\n\n            // Save the callback.\n            _cometd._putCallback(message.id, handshakeCallback);\n\n            // Pick up the first available transport as initial transport\n            // since we don't know if the server supports it\n            if (!_transport) {\n                _transport = _transports.negotiateTransport(transportTypes, version, _crossDomain, url);\n                if (!_transport) {\n                    var failure = 'Could not find initial transport among: ' + _transports.getTransportTypes();\n                    _cometd._warn(failure);\n                    throw failure;\n                }\n            }\n\n            _cometd._debug('Initial transport is', _transport.getType());\n\n            // We started a batch to hold the application messages,\n            // so here we must bypass it and send immediately.\n            _setStatus('handshaking');\n            _cometd._debug('Handshake sent', message);\n            _send(false, [message], false, 'handshake');\n        }\n\n        function _delayedHandshake(delay) {\n            _setStatus('handshaking');\n\n            // We will call _handshake() which will reset _clientId, but we want to avoid\n            // that between the end of this method and the call to _handshake() someone may\n            // call publish() (or other methods that call _queueSend()).\n            _internalBatch = true;\n\n            _delayedSend(function() {\n                _handshake(_handshakeProps, _handshakeCallback);\n            }, delay);\n        }\n\n        function _notifyCallback(callback, message) {\n            try {\n                callback.call(_cometd, message);\n            } catch (x) {\n                var handler = _cometd.onCallbackException;\n                if (_isFunction(handler)) {\n                    _cometd._debug('Invoking callback exception handler', x);\n                    try {\n                        handler.call(_cometd, x, message);\n                    } catch (xx) {\n                        _cometd._info('Exception during execution of callback exception handler', xx);\n                    }\n                } else {\n                    _cometd._info('Exception during execution of message callback', x);\n                }\n            }\n        }\n\n        this._getCallback = function(messageId) {\n            return _callbacks[messageId];\n        };\n\n        this._putCallback = function(messageId, callback) {\n            var result = this._getCallback(messageId);\n            if (_isFunction(callback)) {\n                _callbacks[messageId] = callback;\n            }\n            return result;\n        };\n\n        function _handleCallback(message) {\n            var callback = _cometd._getCallback([message.id]);\n            if (_isFunction(callback)) {\n                delete _callbacks[message.id];\n                _notifyCallback(callback, message);\n            }\n        }\n\n        function _handleRemoteCall(message) {\n            var context = _remoteCalls[message.id];\n            delete _remoteCalls[message.id];\n            if (context) {\n                _cometd._debug('Handling remote call response for', message, 'with context', context);\n\n                // Clear the timeout, if present.\n                var timeout = context.timeout;\n                if (timeout) {\n                    _cometd.clearTimeout(timeout);\n                }\n\n                var callback = context.callback;\n                if (_isFunction(callback)) {\n                    _notifyCallback(callback, message);\n                    return true;\n                }\n            }\n            return false;\n        }\n\n        this.onTransportFailure = function(message, failureInfo, failureHandler) {\n            this._debug('Transport failure', failureInfo, 'for', message);\n\n            var transports = this.getTransportRegistry();\n            var url = this.getURL();\n            var crossDomain = this._isCrossDomain(_splitURL(url)[2]);\n            var version = '1.0';\n            var transportTypes = transports.findTransportTypes(version, crossDomain, url);\n\n            if (failureInfo.action === 'none') {\n                if (message.channel === '/meta/handshake') {\n                    if (!failureInfo.transport) {\n                        var failure = 'Could not negotiate transport, client=[' + transportTypes + '], server=[' + message.supportedConnectionTypes + ']';\n                        this._warn(failure);\n                        _notifyTransportException(_transport.getType(), null, {\n                            reason: failure,\n                            connectionType: _transport.getType(),\n                            transport: _transport\n                        });\n                    }\n                }\n            } else {\n                failureInfo.delay = this.getBackoffPeriod();\n                // Different logic depending on whether we are handshaking or connecting.\n                if (message.channel === '/meta/handshake') {\n                    if (!failureInfo.transport) {\n                        // The transport is invalid, try to negotiate again.\n                        var newTransport = transports.negotiateTransport(transportTypes, version, crossDomain, url);\n                        if (!newTransport) {\n                            this._warn('Could not negotiate transport, client=[' + transportTypes + ']');\n                            _notifyTransportException(_transport.getType(), null, message.failure);\n                            failureInfo.action = 'none';\n                        } else {\n                            this._debug('Transport', _transport.getType(), '->', newTransport.getType());\n                            _notifyTransportException(_transport.getType(), newTransport.getType(), message.failure);\n                            failureInfo.action = 'handshake';\n                            failureInfo.transport = newTransport;\n                        }\n                    }\n\n                    if (failureInfo.action !== 'none') {\n                        this.increaseBackoffPeriod();\n                    }\n                } else {\n                    var now = new Date().getTime();\n\n                    if (_unconnectTime === 0) {\n                        _unconnectTime = now;\n                    }\n\n                    if (failureInfo.action === 'retry') {\n                        failureInfo.delay = this.increaseBackoffPeriod();\n                        // Check whether we may switch to handshaking.\n                        var maxInterval = _advice.maxInterval;\n                        if (maxInterval > 0) {\n                            var expiration = _advice.timeout + _advice.interval + maxInterval;\n                            var unconnected = now - _unconnectTime;\n                            if (unconnected + _backoff > expiration) {\n                                failureInfo.action = 'handshake';\n                            }\n                        }\n                    }\n\n                    if (failureInfo.action === 'handshake') {\n                        failureInfo.delay = 0;\n                        transports.reset(false);\n                        this.resetBackoffPeriod();\n                    }\n                }\n            }\n\n            failureHandler.call(_cometd, failureInfo);\n        };\n\n        function _handleTransportFailure(failureInfo) {\n            _cometd._debug('Transport failure handling', failureInfo);\n\n            if (failureInfo.transport) {\n                _transport = failureInfo.transport;\n            }\n\n            if (failureInfo.url) {\n                _transport.setURL(failureInfo.url);\n            }\n\n            var action = failureInfo.action;\n            var delay = failureInfo.delay || 0;\n            switch (action) {\n                case 'handshake':\n                    _delayedHandshake(delay);\n                    break;\n                case 'retry':\n                    _delayedConnect(delay);\n                    break;\n                case 'none':\n                    _disconnect(true);\n                    break;\n                default:\n                    throw 'Unknown action ' + action;\n            }\n        }\n\n        function _failHandshake(message, failureInfo) {\n            _handleCallback(message);\n            _notifyListeners('/meta/handshake', message);\n            _notifyListeners('/meta/unsuccessful', message);\n\n            // The listeners may have disconnected.\n            if (_isDisconnected()) {\n                failureInfo.action = 'none';\n            }\n\n            _cometd.onTransportFailure.call(_cometd, message, failureInfo, _handleTransportFailure);\n        }\n\n        function _handshakeResponse(message) {\n            var url = _cometd.getURL();\n            if (message.successful) {\n                var crossDomain = _cometd._isCrossDomain(_splitURL(url)[2]);\n                var newTransport = _transports.negotiateTransport(message.supportedConnectionTypes, message.version, crossDomain, url);\n                if (newTransport === null) {\n                    message.successful = false;\n                    _failHandshake(message, {\n                        cause: 'negotiation',\n                        action: 'none',\n                        transport: null\n                    });\n                    return;\n                } else if (_transport !== newTransport) {\n                    _cometd._debug('Transport', _transport.getType(), '->', newTransport.getType());\n                    _transport = newTransport;\n                }\n\n                _clientId = message.clientId;\n\n                // End the internal batch and allow held messages from the application\n                // to go to the server (see _handshake() where we start the internal batch).\n                _internalBatch = false;\n                _flushBatch();\n\n                // Here the new transport is in place, as well as the clientId, so\n                // the listeners can perform a publish() if they want.\n                // Notify the listeners before the connect below.\n                message.reestablish = _reestablish;\n                _reestablish = true;\n\n                _handleCallback(message);\n                _notifyListeners('/meta/handshake', message);\n\n                _handshakeMessages = message['x-messages'] || 0;\n\n                var action = _isDisconnected() ? 'none' : _advice.reconnect || 'retry';\n                switch (action) {\n                    case 'retry':\n                        _resetBackoff();\n                        if (_handshakeMessages === 0) {\n                            _delayedConnect(0);\n                        } else {\n                            _cometd._debug('Processing', _handshakeMessages, 'handshake-delivered messages');\n                        }\n                        break;\n                    case 'none':\n                        _disconnect(true);\n                        break;\n                    default:\n                        throw 'Unrecognized advice action ' + action;\n                }\n            } else {\n                _failHandshake(message, {\n                    cause: 'unsuccessful',\n                    action: _advice.reconnect || 'handshake',\n                    transport: _transport\n                });\n            }\n        }\n\n        function _handshakeFailure(message) {\n            _failHandshake(message, {\n                cause: 'failure',\n                action: 'handshake',\n                transport: null\n            });\n        }\n\n        function _matchMetaConnect(connect) {\n            if (_status === 'disconnected') {\n                return true;\n            }\n            if (_metaConnect && _metaConnect.id === connect.id) {\n                _metaConnect = null;\n                return true;\n            }\n            return false;\n        }\n\n        function _failConnect(message, failureInfo) {\n            // Notify the listeners after the status change but before the next action.\n            _notifyListeners('/meta/connect', message);\n            _notifyListeners('/meta/unsuccessful', message);\n\n            // The listeners may have disconnected.\n            if (_isDisconnected()) {\n                failureInfo.action = 'none';\n            }\n\n            _cometd.onTransportFailure.call(_cometd, message, failureInfo, _handleTransportFailure);\n        }\n\n        function _connectResponse(message) {\n            if (_matchMetaConnect(message)) {\n                _connected = message.successful;\n                if (_connected) {\n                    _notifyListeners('/meta/connect', message);\n\n                    // Normally, the advice will say \"reconnect: 'retry', interval: 0\"\n                    // and the server will hold the request, so when a response returns\n                    // we immediately call the server again (long polling).\n                    // Listeners can call disconnect(), so check the state after they run.\n                    var action = _isDisconnected() ? 'none' : _advice.reconnect || 'retry';\n                    switch (action) {\n                        case 'retry':\n                            _resetBackoff();\n                            _delayedConnect(_backoff);\n                            break;\n                        case 'none':\n                            _disconnect(false);\n                            break;\n                        default:\n                            throw 'Unrecognized advice action ' + action;\n                    }\n                } else {\n                    _failConnect(message, {\n                        cause: 'unsuccessful',\n                        action: _advice.reconnect || 'retry',\n                        transport: _transport\n                    });\n                }\n            } else {\n                _cometd._debug('Mismatched /meta/connect reply', message);\n            }\n        }\n\n        function _connectFailure(message) {\n            if (_matchMetaConnect(message)) {\n                _connected = false;\n                _failConnect(message, {\n                    cause: 'failure',\n                    action: 'retry',\n                    transport: null\n                });\n            } else {\n                _cometd._debug('Mismatched /meta/connect failure', message);\n            }\n        }\n\n        function _failDisconnect(message) {\n            _disconnect(true);\n            _handleCallback(message);\n            _notifyListeners('/meta/disconnect', message);\n            _notifyListeners('/meta/unsuccessful', message);\n        }\n\n        function _disconnectResponse(message) {\n            if (message.successful) {\n                // Wait for the /meta/connect to arrive.\n                _disconnect(false);\n                _handleCallback(message);\n                _notifyListeners('/meta/disconnect', message);\n            } else {\n                _failDisconnect(message);\n            }\n        }\n\n        function _disconnectFailure(message) {\n            _failDisconnect(message);\n        }\n\n        function _failSubscribe(message) {\n            var subscriptions = _listeners[message.subscription];\n            if (subscriptions) {\n                for (var id in subscriptions) {\n                    if (subscriptions.hasOwnProperty(id)) {\n                        var subscription = subscriptions[id];\n                        if (subscription && !subscription.listener) {\n                            delete subscriptions[id];\n                            _cometd._debug('Removed failed subscription', subscription);\n                        }\n                    }\n                }\n            }\n            _handleCallback(message);\n            _notifyListeners('/meta/subscribe', message);\n            _notifyListeners('/meta/unsuccessful', message);\n        }\n\n        function _subscribeResponse(message) {\n            if (message.successful) {\n                _handleCallback(message);\n                _notifyListeners('/meta/subscribe', message);\n            } else {\n                _failSubscribe(message);\n            }\n        }\n\n        function _subscribeFailure(message) {\n            _failSubscribe(message);\n        }\n\n        function _failUnsubscribe(message) {\n            _handleCallback(message);\n            _notifyListeners('/meta/unsubscribe', message);\n            _notifyListeners('/meta/unsuccessful', message);\n        }\n\n        function _unsubscribeResponse(message) {\n            if (message.successful) {\n                _handleCallback(message);\n                _notifyListeners('/meta/unsubscribe', message);\n            } else {\n                _failUnsubscribe(message);\n            }\n        }\n\n        function _unsubscribeFailure(message) {\n            _failUnsubscribe(message);\n        }\n\n        function _failMessage(message) {\n            if (!_handleRemoteCall(message)) {\n                _handleCallback(message);\n                _notifyListeners('/meta/publish', message);\n                _notifyListeners('/meta/unsuccessful', message);\n            }\n        }\n\n        function _messageResponse(message) {\n            if (message.data !== undefined) {\n                if (!_handleRemoteCall(message)) {\n                    _notifyListeners(message.channel, message);\n                    if (_handshakeMessages > 0) {\n                        --_handshakeMessages;\n                        if (_handshakeMessages === 0) {\n                            _cometd._debug('Processed last handshake-delivered message');\n                            _delayedConnect(0);\n                        }\n                    }\n                }\n            } else {\n                if (message.successful === undefined) {\n                    _cometd._warn('Unknown Bayeux Message', message);\n                } else {\n                    if (message.successful) {\n                        _handleCallback(message);\n                        _notifyListeners('/meta/publish', message);\n                    } else {\n                        _failMessage(message);\n                    }\n                }\n            }\n        }\n\n        function _messageFailure(failure) {\n            _failMessage(failure);\n        }\n\n        function _receive(message) {\n            _unconnectTime = 0;\n\n            message = _applyIncomingExtensions(message);\n            if (message === undefined || message === null) {\n                return;\n            }\n\n            _updateAdvice(message.advice);\n\n            var channel = message.channel;\n            switch (channel) {\n                case '/meta/handshake':\n                    _handshakeResponse(message);\n                    break;\n                case '/meta/connect':\n                    _connectResponse(message);\n                    break;\n                case '/meta/disconnect':\n                    _disconnectResponse(message);\n                    break;\n                case '/meta/subscribe':\n                    _subscribeResponse(message);\n                    break;\n                case '/meta/unsubscribe':\n                    _unsubscribeResponse(message);\n                    break;\n                default:\n                    _messageResponse(message);\n                    break;\n            }\n        }\n\n        /**\n         * Receives a message.\n         * This method is exposed as a public so that extensions may inject\n         * messages simulating that they had been received.\n         */\n        this.receive = _receive;\n\n        _handleMessages = function(rcvdMessages) {\n            _cometd._debug('Received', rcvdMessages);\n\n            for (var i = 0; i < rcvdMessages.length; ++i) {\n                var message = rcvdMessages[i];\n                _receive(message);\n            }\n        };\n\n        _handleFailure = function(conduit, messages, failure) {\n            _cometd._debug('handleFailure', conduit, messages, failure);\n\n            failure.transport = conduit;\n            for (var i = 0; i < messages.length; ++i) {\n                var message = messages[i];\n                var failureMessage = {\n                    id: message.id,\n                    successful: false,\n                    channel: message.channel,\n                    failure: failure\n                };\n                failure.message = message;\n                switch (message.channel) {\n                    case '/meta/handshake':\n                        _handshakeFailure(failureMessage);\n                        break;\n                    case '/meta/connect':\n                        _connectFailure(failureMessage);\n                        break;\n                    case '/meta/disconnect':\n                        _disconnectFailure(failureMessage);\n                        break;\n                    case '/meta/subscribe':\n                        failureMessage.subscription = message.subscription;\n                        _subscribeFailure(failureMessage);\n                        break;\n                    case '/meta/unsubscribe':\n                        failureMessage.subscription = message.subscription;\n                        _unsubscribeFailure(failureMessage);\n                        break;\n                    default:\n                        _messageFailure(failureMessage);\n                        break;\n                }\n            }\n        };\n\n        function _hasSubscriptions(channel) {\n            var subscriptions = _listeners[channel];\n            if (subscriptions) {\n                for (var id in subscriptions) {\n                    if (subscriptions.hasOwnProperty(id)) {\n                        if (subscriptions[id]) {\n                            return true;\n                        }\n                    }\n                }\n            }\n            return false;\n        }\n\n        function _resolveScopedCallback(scope, callback) {\n            var delegate = {\n                scope: scope,\n                method: callback\n            };\n            if (_isFunction(scope)) {\n                delegate.scope = undefined;\n                delegate.method = scope;\n            } else {\n                if (_isString(callback)) {\n                    if (!scope) {\n                        throw 'Invalid scope ' + scope;\n                    }\n                    delegate.method = scope[callback];\n                    if (!_isFunction(delegate.method)) {\n                        throw 'Invalid callback ' + callback + ' for scope ' + scope;\n                    }\n                } else if (!_isFunction(callback)) {\n                    throw 'Invalid callback ' + callback;\n                }\n            }\n            return delegate;\n        }\n\n        function _addListener(channel, scope, callback, isListener) {\n            // The data structure is a map<channel, subscription[]>, where each subscription\n            // holds the callback to be called and its scope.\n\n            var delegate = _resolveScopedCallback(scope, callback);\n            _cometd._debug('Adding', isListener ? 'listener' : 'subscription', 'on', channel, 'with scope', delegate.scope, 'and callback', delegate.method);\n\n            var id = ++_listenerId;\n            var subscription = {\n                id: id,\n                channel: channel,\n                scope: delegate.scope,\n                callback: delegate.method,\n                listener: isListener\n            };\n\n            var subscriptions = _listeners[channel];\n            if (!subscriptions) {\n                subscriptions = {};\n                _listeners[channel] = subscriptions;\n            }\n\n            subscriptions[id] = subscription;\n\n            _cometd._debug('Added', isListener ? 'listener' : 'subscription', subscription);\n\n            return subscription;\n        }\n\n        //\n        // PUBLIC API\n        //\n\n        /**\n         * Registers the given transport under the given transport type.\n         * The optional index parameter specifies the \"priority\" at which the\n         * transport is registered (where 0 is the max priority).\n         * If a transport with the same type is already registered, this function\n         * does nothing and returns false.\n         * @param type the transport type\n         * @param transport the transport object\n         * @param index the index at which this transport is to be registered\n         * @return true if the transport has been registered, false otherwise\n         * @see #unregisterTransport(type)\n         */\n        this.registerTransport = function(type, transport, index) {\n            var result = _transports.add(type, transport, index);\n            if (result) {\n                this._debug('Registered transport', type);\n\n                if (_isFunction(transport.registered)) {\n                    transport.registered(type, this);\n                }\n            }\n            return result;\n        };\n\n        /**\n         * Unregisters the transport with the given transport type.\n         * @param type the transport type to unregister\n         * @return the transport that has been unregistered,\n         * or null if no transport was previously registered under the given transport type\n         */\n        this.unregisterTransport = function(type) {\n            var transport = _transports.remove(type);\n            if (transport !== null) {\n                this._debug('Unregistered transport', type);\n\n                if (_isFunction(transport.unregistered)) {\n                    transport.unregistered();\n                }\n            }\n            return transport;\n        };\n\n        this.unregisterTransports = function() {\n            _transports.clear();\n        };\n\n        /**\n         * @return an array of all registered transport types\n         */\n        this.getTransportTypes = function() {\n            return _transports.getTransportTypes();\n        };\n\n        this.findTransport = function(name) {\n            return _transports.find(name);\n        };\n\n        /**\n         * @returns the TransportRegistry object\n         */\n        this.getTransportRegistry = function() {\n            return _transports;\n        };\n\n        /**\n         * Configures the initial Bayeux communication with the Bayeux server.\n         * Configuration is passed via an object that must contain a mandatory field <code>url</code>\n         * of type string containing the URL of the Bayeux server.\n         * @param configuration the configuration object\n         */\n        this.configure = function(configuration) {\n            _configure.call(this, configuration);\n        };\n\n        /**\n         * Configures and establishes the Bayeux communication with the Bayeux server\n         * via a handshake and a subsequent connect.\n         * @param configuration the configuration object\n         * @param handshakeProps an object to be merged with the handshake message\n         * @see #configure(configuration)\n         * @see #handshake(handshakeProps)\n         */\n        this.init = function(configuration, handshakeProps) {\n            this.configure(configuration);\n            this.handshake(handshakeProps);\n        };\n\n        /**\n         * Establishes the Bayeux communication with the Bayeux server\n         * via a handshake and a subsequent connect.\n         * @param handshakeProps an object to be merged with the handshake message\n         * @param handshakeCallback a function to be invoked when the handshake is acknowledged\n         */\n        this.handshake = function(handshakeProps, handshakeCallback) {\n            if (_status !== 'disconnected') {\n                throw 'Illegal state: handshaken';\n            }\n            _handshake(handshakeProps, handshakeCallback);\n        };\n\n        /**\n         * Disconnects from the Bayeux server.\n         * It is possible to suggest to attempt a synchronous disconnect, but this feature\n         * may only be available in certain transports (for example, long-polling may support\n         * it, callback-polling certainly does not).\n         * @param sync whether attempt to perform a synchronous disconnect\n         * @param disconnectProps an object to be merged with the disconnect message\n         * @param disconnectCallback a function to be invoked when the disconnect is acknowledged\n         */\n        this.disconnect = function(sync, disconnectProps, disconnectCallback) {\n            if (_isDisconnected()) {\n                return;\n            }\n\n            if (typeof sync !== 'boolean') {\n                disconnectCallback = disconnectProps;\n                disconnectProps = sync;\n                sync = false;\n            }\n            if (_isFunction(disconnectProps)) {\n                disconnectCallback = disconnectProps;\n                disconnectProps = undefined;\n            }\n\n            var bayeuxMessage = {\n                id: _nextMessageId(),\n                channel: '/meta/disconnect'\n            };\n            // Do not allow the user to override important fields.\n            var message = this._mixin(false, {}, disconnectProps, bayeuxMessage);\n\n            // Save the callback.\n            _cometd._putCallback(message.id, disconnectCallback);\n\n            _setStatus('disconnecting');\n            _send(sync === true, [message], false, 'disconnect');\n        };\n\n        /**\n         * Marks the start of a batch of application messages to be sent to the server\n         * in a single request, obtaining a single response containing (possibly) many\n         * application reply messages.\n         * Messages are held in a queue and not sent until {@link #endBatch()} is called.\n         * If startBatch() is called multiple times, then an equal number of endBatch()\n         * calls must be made to close and send the batch of messages.\n         * @see #endBatch()\n         */\n        this.startBatch = function() {\n            _startBatch();\n        };\n\n        /**\n         * Marks the end of a batch of application messages to be sent to the server\n         * in a single request.\n         * @see #startBatch()\n         */\n        this.endBatch = function() {\n            _endBatch();\n        };\n\n        /**\n         * Executes the given callback in the given scope, surrounded by a {@link #startBatch()}\n         * and {@link #endBatch()} calls.\n         * @param scope the scope of the callback, may be omitted\n         * @param callback the callback to be executed within {@link #startBatch()} and {@link #endBatch()} calls\n         */\n        this.batch = function(scope, callback) {\n            var delegate = _resolveScopedCallback(scope, callback);\n            this.startBatch();\n            try {\n                delegate.method.call(delegate.scope);\n                this.endBatch();\n            } catch (x) {\n                this._info('Exception during execution of batch', x);\n                this.endBatch();\n                throw x;\n            }\n        };\n\n        /**\n         * Adds a listener for bayeux messages, performing the given callback in the given scope\n         * when a message for the given channel arrives.\n         * @param channel the channel the listener is interested to\n         * @param scope the scope of the callback, may be omitted\n         * @param callback the callback to call when a message is sent to the channel\n         * @returns the subscription handle to be passed to {@link #removeListener(object)}\n         * @see #removeListener(subscription)\n         */\n        this.addListener = function(channel, scope, callback) {\n            if (arguments.length < 2) {\n                throw 'Illegal arguments number: required 2, got ' + arguments.length;\n            }\n            if (!_isString(channel)) {\n                throw 'Illegal argument type: channel must be a string';\n            }\n\n            return _addListener(channel, scope, callback, true);\n        };\n\n        /**\n         * Removes the subscription obtained with a call to {@link #addListener(string, object, function)}.\n         * @param subscription the subscription to unsubscribe.\n         * @see #addListener(channel, scope, callback)\n         */\n        this.removeListener = function(subscription) {\n            // Beware of subscription.id == 0, which is falsy => cannot use !subscription.id\n            if (!subscription || !subscription.channel || !(\"id\" in subscription)) {\n                throw 'Invalid argument: expected subscription, not ' + subscription;\n            }\n\n            _removeListener(subscription);\n        };\n\n        /**\n         * Removes all listeners registered with {@link #addListener(channel, scope, callback)} or\n         * {@link #subscribe(channel, scope, callback)}.\n         */\n        this.clearListeners = function() {\n            _listeners = {};\n        };\n\n        /**\n         * Subscribes to the given channel, performing the given callback in the given scope\n         * when a message for the channel arrives.\n         * @param channel the channel to subscribe to\n         * @param scope the scope of the callback, may be omitted\n         * @param callback the callback to call when a message is sent to the channel\n         * @param subscribeProps an object to be merged with the subscribe message\n         * @param subscribeCallback a function to be invoked when the subscription is acknowledged\n         * @return the subscription handle to be passed to {@link #unsubscribe(object)}\n         */\n        this.subscribe = function(channel, scope, callback, subscribeProps, subscribeCallback) {\n            if (arguments.length < 2) {\n                throw 'Illegal arguments number: required 2, got ' + arguments.length;\n            }\n            if (!_isString(channel)) {\n                throw 'Illegal argument type: channel must be a string';\n            }\n            if (_isDisconnected()) {\n                throw 'Illegal state: disconnected';\n            }\n\n            // Normalize arguments\n            if (_isFunction(scope)) {\n                subscribeCallback = subscribeProps;\n                subscribeProps = callback;\n                callback = scope;\n                scope = undefined;\n            }\n            if (_isFunction(subscribeProps)) {\n                subscribeCallback = subscribeProps;\n                subscribeProps = undefined;\n            }\n\n            // Only send the message to the server if this client has not yet subscribed to the channel\n            var send = !_hasSubscriptions(channel);\n\n            var subscription = _addListener(channel, scope, callback, false);\n\n            if (send) {\n                // Send the subscription message after the subscription registration to avoid\n                // races where the server would send a message to the subscribers, but here\n                // on the client the subscription has not been added yet to the data structures\n                var bayeuxMessage = {\n                    id: _nextMessageId(),\n                    channel: '/meta/subscribe',\n                    subscription: channel\n                };\n                // Do not allow the user to override important fields.\n                var message = this._mixin(false, {}, subscribeProps, bayeuxMessage);\n\n                // Save the callback.\n                _cometd._putCallback(message.id, subscribeCallback);\n\n                _queueSend(message);\n            }\n\n            return subscription;\n        };\n\n        /**\n         * Unsubscribes the subscription obtained with a call to {@link #subscribe(string, object, function)}.\n         * @param subscription the subscription to unsubscribe.\n         * @param unsubscribeProps an object to be merged with the unsubscribe message\n         * @param unsubscribeCallback a function to be invoked when the unsubscription is acknowledged\n         */\n        this.unsubscribe = function(subscription, unsubscribeProps, unsubscribeCallback) {\n            if (arguments.length < 1) {\n                throw 'Illegal arguments number: required 1, got ' + arguments.length;\n            }\n            if (_isDisconnected()) {\n                throw 'Illegal state: disconnected';\n            }\n\n            if (_isFunction(unsubscribeProps)) {\n                unsubscribeCallback = unsubscribeProps;\n                unsubscribeProps = undefined;\n            }\n\n            // Remove the local listener before sending the message\n            // This ensures that if the server fails, this client does not get notifications\n            this.removeListener(subscription);\n\n            var channel = subscription.channel;\n            // Only send the message to the server if this client unsubscribes the last subscription\n            if (!_hasSubscriptions(channel)) {\n                var bayeuxMessage = {\n                    id: _nextMessageId(),\n                    channel: '/meta/unsubscribe',\n                    subscription: channel\n                };\n                // Do not allow the user to override important fields.\n                var message = this._mixin(false, {}, unsubscribeProps, bayeuxMessage);\n\n                // Save the callback.\n                _cometd._putCallback(message.id, unsubscribeCallback);\n\n                _queueSend(message);\n            }\n        };\n\n        this.resubscribe = function(subscription, subscribeProps) {\n            _removeSubscription(subscription);\n            if (subscription) {\n                return this.subscribe(subscription.channel, subscription.scope, subscription.callback, subscribeProps);\n            }\n            return undefined;\n        };\n\n        /**\n         * Removes all subscriptions added via {@link #subscribe(channel, scope, callback, subscribeProps)},\n         * but does not remove the listeners added via {@link addListener(channel, scope, callback)}.\n         */\n        this.clearSubscriptions = function() {\n            _clearSubscriptions();\n        };\n\n        /**\n         * Publishes a message on the given channel, containing the given content.\n         * @param channel the channel to publish the message to\n         * @param content the content of the message\n         * @param publishProps an object to be merged with the publish message\n         * @param publishCallback a function to be invoked when the publish is acknowledged by the server\n         */\n        this.publish = function(channel, content, publishProps, publishCallback) {\n            if (arguments.length < 1) {\n                throw 'Illegal arguments number: required 1, got ' + arguments.length;\n            }\n            if (!_isString(channel)) {\n                throw 'Illegal argument type: channel must be a string';\n            }\n            if (/^\\/meta\\//.test(channel)) {\n                throw 'Illegal argument: cannot publish to meta channels';\n            }\n            if (_isDisconnected()) {\n                throw 'Illegal state: disconnected';\n            }\n\n            if (_isFunction(content)) {\n                publishCallback = content;\n                content = {};\n                publishProps = undefined;\n            } else if (_isFunction(publishProps)) {\n                publishCallback = publishProps;\n                publishProps = undefined;\n            }\n\n            var bayeuxMessage = {\n                id: _nextMessageId(),\n                channel: channel,\n                data: content\n            };\n            // Do not allow the user to override important fields.\n            var message = this._mixin(false, {}, publishProps, bayeuxMessage);\n\n            // Save the callback.\n            _cometd._putCallback(message.id, publishCallback);\n\n            _queueSend(message);\n        };\n\n        /**\n         * Publishes a message with binary data on the given channel.\n         * The binary data chunk may be an ArrayBuffer, a DataView, a TypedArray\n         * (such as Uint8Array) or a plain integer array.\n         * The meta data object may contain additional application data such as\n         * a file name, a mime type, etc.\n         * @param channel the channel to publish the message to\n         * @param data the binary data to publish\n         * @param last whether the binary data chunk is the last\n         * @param meta an object containing meta data associated to the binary chunk\n         * @param callback a function to be invoked when the publish is acknowledged by the server\n         */\n        this.publishBinary = function(channel, data, last, meta, callback) {\n            if (_isFunction(data)) {\n                callback = data;\n                data = new ArrayBuffer(0);\n                last = true;\n                meta = undefined;\n            } else if (_isFunction(last)) {\n                callback = last;\n                last = true;\n                meta = undefined;\n            } else if (_isFunction(meta)) {\n                callback = meta;\n                meta = undefined;\n            }\n            var content = {\n                meta: meta,\n                data: data,\n                last: last\n            };\n            var ext = {\n                ext: {\n                    binary: {}\n                }\n            };\n            this.publish(channel, content, ext, callback);\n        };\n\n        this.remoteCall = function(target, content, timeout, callProps, callback) {\n            if (arguments.length < 1) {\n                throw 'Illegal arguments number: required 1, got ' + arguments.length;\n            }\n            if (!_isString(target)) {\n                throw 'Illegal argument type: target must be a string';\n            }\n            if (_isDisconnected()) {\n                throw 'Illegal state: disconnected';\n            }\n\n            if (_isFunction(content)) {\n                callback = content;\n                content = {};\n                timeout = _config.maxNetworkDelay;\n                callProps = undefined;\n            } else if (_isFunction(timeout)) {\n                callback = timeout;\n                timeout = _config.maxNetworkDelay;\n                callProps = undefined;\n            } else if (_isFunction(callProps)) {\n                callback = callProps;\n                callProps = undefined;\n            }\n\n            if (typeof timeout !== 'number') {\n                throw 'Illegal argument type: timeout must be a number';\n            }\n\n            if (!target.match(/^\\//)) {\n                target = '/' + target;\n            }\n            var channel = '/service' + target;\n\n            var bayeuxMessage = {\n                id: _nextMessageId(),\n                channel: channel,\n                data: content\n            };\n            var message = this._mixin(false, {}, callProps, bayeuxMessage);\n\n            var context = {\n                callback: callback\n            };\n            if (timeout > 0) {\n                context.timeout = _cometd.setTimeout(function() {\n                    _cometd._debug('Timing out remote call', message, 'after', timeout, 'ms');\n                    _failMessage({\n                        id: message.id,\n                        error: '406::timeout',\n                        successful: false,\n                        failure: {\n                            message: message,\n                            reason: 'Remote Call Timeout'\n                        }\n                    });\n                }, timeout);\n                _cometd._debug('Scheduled remote call timeout', message, 'in', timeout, 'ms');\n            }\n            _remoteCalls[message.id] = context;\n\n            _queueSend(message);\n        };\n\n        this.remoteCallBinary = function(target, data, last, meta, timeout, callback) {\n            if (_isFunction(data)) {\n                callback = data;\n                data = new ArrayBuffer(0);\n                last = true;\n                meta = undefined;\n                timeout = _config.maxNetworkDelay;\n            } else if (_isFunction(last)) {\n                callback = last;\n                last = true;\n                meta = undefined;\n                timeout = _config.maxNetworkDelay;\n            } else if (_isFunction(meta)) {\n                callback = meta;\n                meta = undefined;\n                timeout = _config.maxNetworkDelay;\n            } else if (_isFunction(timeout)) {\n                callback = timeout;\n                timeout = _config.maxNetworkDelay;\n            }\n\n            var content = {\n                meta: meta,\n                data: data,\n                last: last\n            };\n            var ext = {\n                ext: {\n                    binary: {}\n                }\n            };\n\n            this.remoteCall(target, content, timeout, ext, callback);\n        };\n\n        /**\n         * Returns a string representing the status of the bayeux communication with the Bayeux server.\n         */\n        this.getStatus = function() {\n            return _status;\n        };\n\n        /**\n         * Returns whether this instance has been disconnected.\n         */\n        this.isDisconnected = _isDisconnected;\n\n        /**\n         * Sets the backoff period used to increase the backoff time when retrying an unsuccessful or failed message.\n         * Default value is 1 second, which means if there is a persistent failure the retries will happen\n         * after 1 second, then after 2 seconds, then after 3 seconds, etc. So for example with 15 seconds of\n         * elapsed time, there will be 5 retries (at 1, 3, 6, 10 and 15 seconds elapsed).\n         * @param period the backoff period to set\n         * @see #getBackoffIncrement()\n         */\n        this.setBackoffIncrement = function(period) {\n            _config.backoffIncrement = period;\n        };\n\n        /**\n         * Returns the backoff period used to increase the backoff time when retrying an unsuccessful or failed message.\n         * @see #setBackoffIncrement(period)\n         */\n        this.getBackoffIncrement = function() {\n            return _config.backoffIncrement;\n        };\n\n        /**\n         * Returns the backoff period to wait before retrying an unsuccessful or failed message.\n         */\n        this.getBackoffPeriod = function() {\n            return _backoff;\n        };\n\n        /**\n         * Increases the backoff period up to the maximum value configured.\n         * @returns the backoff period after increment\n         * @see getBackoffIncrement\n         */\n        this.increaseBackoffPeriod = function() {\n            return _increaseBackoff();\n        };\n\n        /**\n         * Resets the backoff period to zero.\n         */\n        this.resetBackoffPeriod = function() {\n            _resetBackoff();\n        };\n\n        /**\n         * Sets the log level for console logging.\n         * Valid values are the strings 'error', 'warn', 'info' and 'debug', from\n         * less verbose to more verbose.\n         * @param level the log level string\n         */\n        this.setLogLevel = function(level) {\n            _config.logLevel = level;\n        };\n\n        /**\n         * Registers an extension whose callbacks are called for every incoming message\n         * (that comes from the server to this client implementation) and for every\n         * outgoing message (that originates from this client implementation for the\n         * server).\n         * The format of the extension object is the following:\n         * <pre>\n         * {\n         *     incoming: function(message) { ... },\n         *     outgoing: function(message) { ... }\n         * }\n         * </pre>\n         * Both properties are optional, but if they are present they will be called\n         * respectively for each incoming message and for each outgoing message.\n         * @param name the name of the extension\n         * @param extension the extension to register\n         * @return true if the extension was registered, false otherwise\n         * @see #unregisterExtension(name)\n         */\n        this.registerExtension = function(name, extension) {\n            if (arguments.length < 2) {\n                throw 'Illegal arguments number: required 2, got ' + arguments.length;\n            }\n            if (!_isString(name)) {\n                throw 'Illegal argument type: extension name must be a string';\n            }\n\n            var existing = false;\n            for (var i = 0; i < _extensions.length; ++i) {\n                var existingExtension = _extensions[i];\n                if (existingExtension.name === name) {\n                    existing = true;\n                    break;\n                }\n            }\n            if (!existing) {\n                _extensions.push({\n                    name: name,\n                    extension: extension\n                });\n                this._debug('Registered extension', name);\n\n                // Callback for extensions\n                if (_isFunction(extension.registered)) {\n                    extension.registered(name, this);\n                }\n\n                return true;\n            } else {\n                this._info('Could not register extension with name', name, 'since another extension with the same name already exists');\n                return false;\n            }\n        };\n\n        /**\n         * Unregister an extension previously registered with\n         * {@link #registerExtension(name, extension)}.\n         * @param name the name of the extension to unregister.\n         * @return true if the extension was unregistered, false otherwise\n         */\n        this.unregisterExtension = function(name) {\n            if (!_isString(name)) {\n                throw 'Illegal argument type: extension name must be a string';\n            }\n\n            var unregistered = false;\n            for (var i = 0; i < _extensions.length; ++i) {\n                var extension = _extensions[i];\n                if (extension.name === name) {\n                    _extensions.splice(i, 1);\n                    unregistered = true;\n                    this._debug('Unregistered extension', name);\n\n                    // Callback for extensions\n                    var ext = extension.extension;\n                    if (_isFunction(ext.unregistered)) {\n                        ext.unregistered();\n                    }\n\n                    break;\n                }\n            }\n            return unregistered;\n        };\n\n        /**\n         * Find the extension registered with the given name.\n         * @param name the name of the extension to find\n         * @return the extension found or null if no extension with the given name has been registered\n         */\n        this.getExtension = function(name) {\n            for (var i = 0; i < _extensions.length; ++i) {\n                var extension = _extensions[i];\n                if (extension.name === name) {\n                    return extension.extension;\n                }\n            }\n            return null;\n        };\n\n        /**\n         * Returns the name assigned to this CometD object, or the string 'default'\n         * if no name has been explicitly passed as parameter to the constructor.\n         */\n        this.getName = function() {\n            return _name;\n        };\n\n        /**\n         * Returns the clientId assigned by the Bayeux server during handshake.\n         */\n        this.getClientId = function() {\n            return _clientId;\n        };\n\n        /**\n         * Returns the URL of the Bayeux server.\n         */\n        this.getURL = function() {\n            if (_transport) {\n                var url = _transport.getURL();\n                if (url) {\n                    return url;\n                }\n                url = _config.urls[_transport.getType()];\n                if (url) {\n                    return url;\n                }\n            }\n            return _config.url;\n        };\n\n        this.getTransport = function() {\n            return _transport;\n        };\n\n        this.getConfiguration = function() {\n            return this._mixin(true, {}, _config);\n        };\n\n        this.getAdvice = function() {\n            return this._mixin(true, {}, _advice);\n        };\n\n        this.setTimeout = function(funktion, delay) {\n            return _scheduler.setTimeout(function() {\n                try {\n                    _cometd._debug('Invoking timed function', funktion);\n                    funktion();\n                } catch (x) {\n                    _cometd._debug('Exception invoking timed function', funktion, x);\n                }\n            }, delay);\n        };\n\n        this.clearTimeout = function(id) {\n            _scheduler.clearTimeout(id);\n        };\n\n        // Initialize transports.\n        if (window.WebSocket) {\n            this.registerTransport('websocket', new WebSocketTransport());\n        }\n        this.registerTransport('long-polling', new LongPollingTransport());\n        this.registerTransport('callback-polling', new CallbackPollingTransport());\n    };\n\n    var _z85EncodeTable = [\n        '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',\n        'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j',\n        'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't',\n        'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D',\n        'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N',\n        'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X',\n        'Y', 'Z', '.', '-', ':', '+', '=', '^', '!', '/',\n        '*', '?', '&', '<', '>', '(', ')', '[', ']', '{',\n        '}', '@', '%', '$', '#'\n    ];\n    var _z85DecodeTable = [\n        0x00, 0x44, 0x00, 0x54, 0x53, 0x52, 0x48, 0x00,\n        0x4B, 0x4C, 0x46, 0x41, 0x00, 0x3F, 0x3E, 0x45,\n        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,\n        0x08, 0x09, 0x40, 0x00, 0x49, 0x42, 0x4A, 0x47,\n        0x51, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2A,\n        0x2B, 0x2C, 0x2D, 0x2E, 0x2F, 0x30, 0x31, 0x32,\n        0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3A,\n        0x3B, 0x3C, 0x3D, 0x4D, 0x00, 0x4E, 0x43, 0x00,\n        0x00, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10,\n        0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18,\n        0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F, 0x20,\n        0x21, 0x22, 0x23, 0x4F, 0x00, 0x50, 0x00, 0x00\n    ];\n    var Z85 = {\n        encode: function(bytes) {\n            var buffer = null;\n            if (bytes instanceof ArrayBuffer) {\n                buffer = bytes;\n            } else if (bytes.buffer instanceof ArrayBuffer) {\n                buffer = bytes.buffer;\n            } else if (Array.isArray(bytes)) {\n                buffer = new Uint8Array(bytes).buffer;\n            }\n            if (buffer == null) {\n                throw 'Cannot Z85 encode ' + bytes;\n            }\n\n            var length = buffer.byteLength;\n            var remainder = length % 4;\n            var padding = 4 - (remainder === 0 ? 4 : remainder);\n            var view = new DataView(buffer);\n            var result = '';\n            var value = 0;\n            for (var i = 0; i < length + padding; ++i) {\n                var isPadding = i >= length;\n                value = value * 256 + (isPadding ? 0 : view.getUint8(i));\n                if ((i + 1) % 4 === 0) {\n                    var divisor = 85 * 85 * 85 * 85;\n                    for (var j = 5; j > 0; --j) {\n                        if (!isPadding || j > padding) {\n                            var code = Math.floor(value / divisor) % 85;\n                            result += _z85EncodeTable[code];\n                        }\n                        divisor /= 85;\n                    }\n                    value = 0;\n                }\n            }\n\n            return result;\n        },\n        decode: function(string) {\n            var remainder = string.length % 5;\n            var padding = 5 - (remainder === 0 ? 5 : remainder);\n            for (var p = 0; p < padding; ++p) {\n                string += _z85EncodeTable[_z85EncodeTable.length - 1];\n            }\n            var length = string.length;\n\n            var buffer = new ArrayBuffer((length * 4 / 5) - padding);\n            var view = new DataView(buffer);\n            var value = 0;\n            var charIdx = 0;\n            var byteIdx = 0;\n            for (var i = 0; i < length; ++i) {\n                var code = string.charCodeAt(charIdx++) - 32;\n                value = value * 85 + _z85DecodeTable[code];\n                if (charIdx % 5 === 0) {\n                    var divisor = 256 * 256 * 256;\n                    while (divisor >= 1) {\n                        if (byteIdx < view.byteLength) {\n                            view.setUint8(byteIdx++, Math.floor(value / divisor) % 256);\n                        }\n                        divisor /= 256;\n                    }\n                    value = 0;\n                }\n            }\n\n            return buffer;\n        }\n    };\n\n    return {\n        CometD: CometD,\n        Transport: Transport,\n        RequestTransport: RequestTransport,\n        LongPollingTransport: LongPollingTransport,\n        CallbackPollingTransport: CallbackPollingTransport,\n        WebSocketTransport: WebSocketTransport,\n        Utils: Utils,\n        Z85: Z85\n    };\n}));\n","/*\n * Copyright (c) 2008-2019 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function(root, factory){\n    if (typeof exports === 'object') {\n        module.exports = factory(require('./cometd'));\n    } else if (typeof define === 'function' && define.amd) {\n        define(['./cometd'], factory);\n    } else {\n        factory(root.org.cometd);\n    }\n}(this, function(cometdModule) {\n    /**\n     * This client-side extension enables the client to acknowledge to the server\n     * the messages that the client has received.\n     * For the acknowledgement to work, the server must be configured with the\n     * correspondent server-side ack extension. If both client and server support\n     * the ack extension, then the ack functionality will take place automatically.\n     * By enabling this extension, all messages arriving from the server will arrive\n     * via /meta/connect, so the comet communication will be slightly chattier.\n     * The fact that all messages will return via /meta/connect means also that the\n     * messages will arrive with total order, which is not guaranteed if messages\n     * can arrive via both /meta/connect and normal response.\n     * Messages are not acknowledged one by one, but instead a batch of messages is\n     * acknowledged when the /meta/connect returns.\n     */\n    return cometdModule.AckExtension = function() {\n        var _cometd;\n        var _serverSupportsAcks = false;\n        var _batch;\n\n        function _debug(text, args) {\n            _cometd._debug(text, args);\n        }\n\n        this.registered = function(name, cometd) {\n            _cometd = cometd;\n            _debug('AckExtension: executing registration callback');\n        };\n\n        this.unregistered = function() {\n            _debug('AckExtension: executing unregistration callback');\n            _cometd = null;\n        };\n\n        this.incoming = function(message) {\n            var channel = message.channel;\n            var ext = message.ext;\n            if (channel === '/meta/handshake') {\n                if (ext) {\n                    var ackField = ext.ack;\n                    if (typeof ackField === 'object') {\n                        // New format.\n                        _serverSupportsAcks = ackField.enabled === true;\n                        var batch = ackField.batch;\n                        if (typeof batch === 'number') {\n                            _batch = batch;\n                        }\n                    } else {\n                        // Old format.\n                        _serverSupportsAcks = ackField === true;\n                    }\n                }\n                _debug('AckExtension: server supports acknowledgements', _serverSupportsAcks);\n            } else if (channel === '/meta/connect' && message.successful && _serverSupportsAcks) {\n                if (ext && typeof ext.ack === 'number') {\n                    _batch = ext.ack;\n                    _debug('AckExtension: server sent batch', _batch);\n                }\n            }\n            return message;\n        };\n\n        this.outgoing = function(message) {\n            var channel = message.channel;\n            if (!message.ext) {\n                message.ext = {};\n            }\n            if (channel === '/meta/handshake') {\n                message.ext.ack = _cometd && _cometd.ackEnabled !== false;\n                _serverSupportsAcks = false;\n                _batch = 0;\n            } else if (channel === '/meta/connect') {\n                if (_serverSupportsAcks) {\n                    message.ext.ack = _batch;\n                    _debug('AckExtension: client sending batch', _batch);\n                }\n            }\n            return message;\n        };\n    };\n}));\n","/*\n * Copyright (c) 2008-2019 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function(root, factory) {\n    if (typeof exports === 'object') {\n        module.exports = factory(require('./cometd'));\n    } else if (typeof define === 'function' && define.amd) {\n        define(['./cometd'], factory);\n    } else {\n        factory(root.org.cometd);\n    }\n}(this, function(cometdModule) {\n    /**\n     * The reload extension allows a page to be loaded (or reloaded)\n     * without having to re-handshake in the new (or reloaded) page,\n     * therefore resuming the existing CometD connection.\n     *\n     * When the reload() method is called, the state of the CometD\n     * connection is stored in the window.sessionStorage object.\n     * The reload() method must therefore be called by page unload\n     * handlers, often provided by JavaScript toolkits.\n     *\n     * When the page is (re)loaded, this extension checks the\n     * window.sessionStorage and restores the CometD connection,\n     * maintaining the same CometD clientId.\n     */\n    return cometdModule.ReloadExtension = function(configuration) {\n        var _cometd;\n        var _debug;\n        var _state = {};\n        var _name = 'org.cometd.reload';\n        var _batch = false;\n        var _reloading = false;\n\n        function _reload(config) {\n            if (_state.handshakeResponse) {\n                _reloading = true;\n                var transport = _cometd.getTransport();\n                if (transport) {\n                    transport.abort();\n                }\n                _configure(config);\n                var state = JSON.stringify(_state);\n                _debug('Reload extension saving state', state);\n                window.sessionStorage.setItem(_name, state);\n            }\n        }\n\n        function _similarState(oldState) {\n            // We want to check here that the CometD object\n            // did not change much between reloads.\n            // We just check the URL for now, but in future\n            // further checks may involve the transport type\n            // and other configuration parameters.\n            return _state.url === oldState.url;\n        }\n\n        function _configure(config) {\n            if (config) {\n                if (typeof config.name === 'string') {\n                    _name = config.name;\n                }\n            }\n        }\n\n        function _receive(response) {\n            _cometd.receive(response);\n        }\n\n        this.configure = _configure;\n\n        this._receive = _receive;\n\n        this.registered = function(name, cometd) {\n            _cometd = cometd;\n            _cometd.reload = _reload;\n            _debug = _cometd._debug;\n        };\n\n        this.unregistered = function() {\n            delete _cometd.reload;\n            _cometd = null;\n        };\n\n        this.outgoing = function(message) {\n            switch (message.channel) {\n                case '/meta/handshake':\n                {\n                    _state = {};\n                    _state.url = _cometd.getURL();\n\n                    var state = window.sessionStorage.getItem(_name);\n                    _debug('Reload extension found state', state);\n                    // Is there a saved handshake response from a prior load ?\n                    if (state) {\n                        try {\n                            var oldState = JSON.parse(state);\n\n                            // Remove the state, not needed anymore\n                            window.sessionStorage.removeItem(_name);\n\n                            if (oldState.handshakeResponse && _similarState(oldState)) {\n                                _debug('Reload extension restoring state', oldState);\n\n                                // Since we are going to abort this message,\n                                // we must save an eventual callback to restore\n                                // it when we replay the handshake response.\n                                var callback = _cometd._getCallback(message.id);\n\n                                var self = this;\n                                setTimeout(function() {\n                                    _debug('Reload extension replaying handshake response', oldState.handshakeResponse);\n                                    _state.handshakeResponse = oldState.handshakeResponse;\n                                    _state.transportType = oldState.transportType;\n\n                                    // Restore the callback.\n                                    _cometd._putCallback(message.id, callback);\n\n                                    var response = _cometd._mixin(true, {}, _state.handshakeResponse, {\n                                        // Keep the response message id the same as the request.\n                                        id: message.id,\n                                        // Tells applications this is a handshake replayed by the reload extension.\n                                        ext: {\n                                            reload: true\n                                        }\n                                    });\n                                    // Use the same transport as before.\n                                    response.supportedConnectionTypes = [_state.transportType];\n\n                                    self._receive(response);\n                                    _debug('Reload extension replayed handshake response', response);\n                                }, 0);\n\n                                // Delay any sends until first connect is complete.\n                                // This avoids that there is an old /meta/connect pending on server\n                                // that will be resumed to send messages to the client, when the\n                                // client has already closed the connection, thereby losing the messages.\n                                if (!_batch) {\n                                    _batch = true;\n                                    _cometd.startBatch();\n                                }\n\n                                // This handshake is aborted, as we will replay the prior handshake response\n                                return null;\n                            } else {\n                                _debug('Reload extension could not restore state', oldState);\n                            }\n                        } catch (x) {\n                            _debug('Reload extension error while trying to restore state', x);\n                        }\n                    }\n                    break;\n                }\n                case '/meta/connect':\n                {\n                    if (_reloading === true) {\n                        // The reload causes the failure of the outstanding /meta/connect,\n                        // which CometD will react to by sending another. Here we avoid\n                        // that /meta/connect messages are sent between the reload and\n                        // the destruction of the JavaScript context, so that we are sure\n                        // that the first /meta/connect is the one triggered after the\n                        // replay of the /meta/handshake by this extension.\n                        _debug('Reload extension aborting /meta/connect during reload');\n                        return null;\n                    }\n\n                    if (!_state.transportType) {\n                        _state.transportType = message.connectionType;\n                        _debug('Reload extension tracked transport type', _state.transportType);\n                    }\n                    break;\n                }\n                case '/meta/disconnect':\n                {\n                    _state = {};\n                    break;\n                }\n                default:\n                {\n                    break;\n                }\n            }\n            return message;\n        };\n\n        this.incoming = function(message) {\n            if (message.successful) {\n                switch (message.channel) {\n                    case '/meta/handshake':\n                    {\n                        // If the handshake response is already present, then we're replaying it.\n                        // Since the replay may have modified the handshake response, do not record it here.\n                        if (!_state.handshakeResponse) {\n                            // Save successful handshake response\n                            _state.handshakeResponse = message;\n                            _debug('Reload extension tracked handshake response', message);\n                        }\n                        break;\n                    }\n                    case '/meta/connect':\n                    {\n                        if (_batch) {\n                            _batch = false;\n                            _cometd.endBatch();\n                        }\n                        break;\n                    }\n                    case '/meta/disconnect':\n                    {\n                        _state = {};\n                        break;\n                    }\n                    default:\n                    {\n                        break;\n                    }\n                }\n            }\n            return message;\n        };\n\n        _configure(configuration);\n    };\n}));\n","var __self__ = (function (root) {\nfunction F() {\nthis.fetch = false;\nthis.DOMException = root.DOMException\n}\nF.prototype = root;\nreturn new F();\n})(typeof self !== 'undefined' ? self : this);\n(function(self) {\n\nvar irrelevant = (function (exports) {\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob:\n      'FileReader' in self &&\n      'Blob' in self &&\n      (function() {\n        try {\n          new Blob();\n          return true\n        } catch (e) {\n          return false\n        }\n      })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  };\n\n  function isDataView(obj) {\n    return obj && DataView.prototype.isPrototypeOf(obj)\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ];\n\n    var isArrayBufferView =\n      ArrayBuffer.isView ||\n      function(obj) {\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n      };\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name);\n    }\n    if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value);\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift();\n        return {done: value === undefined, value: value}\n      }\n    };\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      };\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value);\n      }, this);\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1]);\n      }, this);\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name]);\n      }, this);\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    var oldValue = this.map[name];\n    this.map[name] = oldValue ? oldValue + ', ' + value : value;\n  };\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)];\n  };\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null\n  };\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  };\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  };\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this);\n      }\n    }\n  };\n\n  Headers.prototype.keys = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.values = function() {\n    var items = [];\n    this.forEach(function(value) {\n      items.push(value);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.entries = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items)\n  };\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true;\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result);\n      };\n      reader.onerror = function() {\n        reject(reader.error);\n      };\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsArrayBuffer(blob);\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsText(blob);\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf);\n    var chars = new Array(view.length);\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i]);\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength);\n      view.set(new Uint8Array(buf));\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false;\n\n    this._initBody = function(body) {\n      this._bodyInit = body;\n      if (!body) {\n        this._bodyText = '';\n      } else if (typeof body === 'string') {\n        this._bodyText = body;\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body;\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body;\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString();\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer);\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer]);\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body);\n      } else {\n        this._bodyText = body = Object.prototype.toString.call(body);\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8');\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type);\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n      }\n    };\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this);\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      };\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      };\n    }\n\n    this.text = function() {\n      var rejected = consumed(this);\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    };\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      };\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    };\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase();\n    return methods.indexOf(upcased) > -1 ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {};\n    var body = options.body;\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url;\n      this.credentials = input.credentials;\n      if (!options.headers) {\n        this.headers = new Headers(input.headers);\n      }\n      this.method = input.method;\n      this.mode = input.mode;\n      this.signal = input.signal;\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit;\n        input.bodyUsed = true;\n      }\n    } else {\n      this.url = String(input);\n    }\n\n    this.credentials = options.credentials || this.credentials || 'same-origin';\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers);\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET');\n    this.mode = options.mode || this.mode || null;\n    this.signal = options.signal || this.signal;\n    this.referrer = null;\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body);\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, {body: this._bodyInit})\n  };\n\n  function decode(body) {\n    var form = new FormData();\n    body\n      .trim()\n      .split('&')\n      .forEach(function(bytes) {\n        if (bytes) {\n          var split = bytes.split('=');\n          var name = split.shift().replace(/\\+/g, ' ');\n          var value = split.join('=').replace(/\\+/g, ' ');\n          form.append(decodeURIComponent(name), decodeURIComponent(value));\n        }\n      });\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers();\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ');\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':');\n      var key = parts.shift().trim();\n      if (key) {\n        var value = parts.join(':').trim();\n        headers.append(key, value);\n      }\n    });\n    return headers\n  }\n\n  Body.call(Request.prototype);\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {};\n    }\n\n    this.type = 'default';\n    this.status = options.status === undefined ? 200 : options.status;\n    this.ok = this.status >= 200 && this.status < 300;\n    this.statusText = 'statusText' in options ? options.statusText : 'OK';\n    this.headers = new Headers(options.headers);\n    this.url = options.url || '';\n    this._initBody(bodyInit);\n  }\n\n  Body.call(Response.prototype);\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  };\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''});\n    response.type = 'error';\n    return response\n  };\n\n  var redirectStatuses = [301, 302, 303, 307, 308];\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  };\n\n  exports.DOMException = self.DOMException;\n  try {\n    new exports.DOMException();\n  } catch (err) {\n    exports.DOMException = function(message, name) {\n      this.message = message;\n      this.name = name;\n      var error = Error(message);\n      this.stack = error.stack;\n    };\n    exports.DOMException.prototype = Object.create(Error.prototype);\n    exports.DOMException.prototype.constructor = exports.DOMException;\n  }\n\n  function fetch(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init);\n\n      if (request.signal && request.signal.aborted) {\n        return reject(new exports.DOMException('Aborted', 'AbortError'))\n      }\n\n      var xhr = new XMLHttpRequest();\n\n      function abortXhr() {\n        xhr.abort();\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        };\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\n        resolve(new Response(body, options));\n      };\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.onabort = function() {\n        reject(new exports.DOMException('Aborted', 'AbortError'));\n      };\n\n      xhr.open(request.method, request.url, true);\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true;\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false;\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob';\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value);\n      });\n\n      if (request.signal) {\n        request.signal.addEventListener('abort', abortXhr);\n\n        xhr.onreadystatechange = function() {\n          // DONE (success or failure)\n          if (xhr.readyState === 4) {\n            request.signal.removeEventListener('abort', abortXhr);\n          }\n        };\n      }\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);\n    })\n  }\n\n  fetch.polyfill = true;\n\n  if (!self.fetch) {\n    self.fetch = fetch;\n    self.Headers = Headers;\n    self.Request = Request;\n    self.Response = Response;\n  }\n\n  exports.Headers = Headers;\n  exports.Request = Request;\n  exports.Response = Response;\n  exports.fetch = fetch;\n\n  return exports;\n\n}({}));\n})(__self__);\ndelete __self__.fetch.polyfill\nexports = __self__.fetch // To enable: import fetch from 'cross-fetch'\nexports.default = __self__.fetch // For TypeScript consumers without esModuleInterop.\nexports.fetch = __self__.fetch // To enable: import {fetch} from 'cross-fetch'\nexports.Headers = __self__.Headers\nexports.Request = __self__.Request\nexports.Response = __self__.Response\nmodule.exports = exports\n","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nmodule.exports = _nonIterableRest;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase;","function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nmodule.exports = _isNativeFunction;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    module.exports = _construct = Reflect.construct;\n  } else {\n    module.exports = _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nmodule.exports = _construct;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nmodule.exports = _nonIterableSpread;","export const BROWSER_STORAGE_TYPE = {\n    COOKIE: 'COOKIE',\n    SESSION: 'SESSION',\n};\n\nexport const SCOPE_BOUNDARY = {\n    PROJECT: 'PROJECT',\n    GROUP: 'GROUP',\n    EPISODE: 'EPISODE',\n    WORLD: 'WORLD',\n    RUN: 'RUN',\n};\n\nexport const RITUAL = {\n    NONE: 'NONE',\n    INTER: 'INTER',\n    REANIMATE: 'REANIMATE',\n    EXORCISE: 'EXORCISE',\n};\n\nexport const PUSH_CATEGORY = {\n    CHAT: 'CHAT',\n    CONSENSUS: 'CONSENSUS',\n    CONTROL: 'CONTROL',\n    PRESENCE: 'PRESENCE',\n    RUN: 'RUN',\n    SYSTEM: 'SYSTEM',\n};\n\nexport const LOCK_TYPE = {\n    SYSTEM: 'SYSTEM',\n    MONITER: 'MONITER',\n    AUTHOR: 'AUTHOR',\n    SUPPORT: 'SUPPORT',\n    FACILITATOR: 'FACILITATOR',\n    REVIEWER: 'REVIEWER',\n    USER: 'USER',\n    LEADER: 'LEADER',\n    PARTICIPANT: 'PARTICIPANT',\n    ANONYMOUS: 'ANONYMOUS',\n};","/* eslint-disable no-new-func */\nexport const isBrowser = new Function('try {return this===window;}catch(e){ return false;}');\nexport const isNode = new Function('try {return this===global;}catch(e){return false;}');\n\nexport const toQueryString = (query) => {\n    if (typeof query === 'string') return query;\n    if (typeof query !== 'object') return '';\n    const queryArray = Array.isArray(query) ? query : Object.entries(query);\n    return queryArray.flatMap(([key, value]) => {\n        if (key === undefined || key === '') return [];\n        if (value === undefined || value === '') return [];\n        if (Array.isArray(value)) return value.map((v) => `${key}=${v}`);\n        return `${key}=${value}`;\n    }).join('&');\n};\n\nexport const last = (strOrArr) => strOrArr[strOrArr.length - 1];\nexport const prefix = (pre, str) => str.startsWith(pre) ? str : `${pre}${str}`;\n\n// Tries to return value at the end of a sequence of keys.\n// E.g. given an obj and keys = ['1', '2', '3'], it will try to\n// return obj['1']['2']['3']. Uses the defaultValue on error.\nexport const access = (obj, keys, defaultValue) => {\n    let ref = obj;\n    try {\n        keys.forEach((key) => ref = ref[key]);\n    } catch (err) {\n        if (err instanceof TypeError) {\n            return defaultValue;\n        }\n        throw err;\n    }\n    if (ref === undefined) return defaultValue;\n    return ref;\n};","import { cookies } from 'utils';\n\nclass Store {\n    _store;\n    constructor(store) {\n        this._store = store;\n    }\n    clear() {\n        this._store.clear();\n    }\n    get store() {\n        return this._store;\n    }\n    set store(store) {\n        this._store = store;\n    }\n}\n\nconst nodeMap = new Map();\nexport class NodeStore extends Store {\n    constructor() {\n        super(nodeMap);\n    }\n    getItem(key) {\n        return super.store.get(key);\n    }\n    setItem(key, value) {\n        return super.store.set(key, value);\n    }\n    removeItem(key) {\n        return super.store.delete(key);\n    }\n}\n\nexport class SessionStore extends Store {\n    constructor() {\n        super(window.sessionStorage);\n    }\n    getItem(key) {\n        return JSON.parse(super.store.getItem(key.toString()));\n    }\n    setItem(key, value) {\n        return super.store.setItem(key.toString(), JSON.stringify(value));\n    }\n    removeItem(key) {\n        return super.store.removeItem(key.toString());\n    }\n}\n\nexport class CookieStore {\n    constructor(options) {\n        const defaults = { domain: `.${window.location.hostname}`, path: '/' };\n        this.options = { ...defaults, ...options };\n    }\n    getItem(key) {\n        return JSON.parse(cookies.getItem(key.toString()));\n    }\n    setItem(key, value) {\n        return cookies.setItem(key.toString(), JSON.stringify(value), this.options);\n    }\n    removeItem(key) {\n        return cookies.removeItem(key.toString(), this.options);\n    }\n    clear() {\n        return cookies.clear();\n    }\n}\n","// Modified version of https://github.com/madmurphy/cookies.js\nconst getExpiration = (vEnd) => {\n    if (!vEnd) return '';\n    switch (vEnd.constructor) {\n        case Number: return vEnd === Infinity ? '; expires=Fri, 31 Dec 9999 23:59:59 GMT' : `; max-age=${vEnd}`;\n        /*\n            Note: Despite officially defined in RFC 6265, the use of `max-age` is not compatible with any\n            version of Internet Explorer, Edge and some mobile browsers. Therefore passing a number to\n            the end parameter might not work as expected. A possible solution might be to convert the the\n            relative time to an absolute time. For instance, replacing the previous line with:\n        */\n        /*\n            case Number: return vEnd === Infinity ? '; expires=Fri, 31 Dec 9999 23:59:59 GMT' : `; expires=${(new Date(vEnd * 1e3 + Date.now())).toUTCString()}`;\n        */\n        case String: return `; expires=${vEnd}`;\n        case Date: return `; expires=${vEnd.toUTCString()}`;\n        default: return '';\n    }\n};\n\nexport default {\n    getItem(key) {\n        if (!key) return null;\n        return decodeURIComponent(document.cookie.replace(new RegExp(`(?:(?:^|.*;)\\\\s*${encodeURIComponent(key).replace(/[\\-\\.\\+\\*]/g, '\\\\$&')}\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$`), '$1')) || null;\n    },\n    setItem(key, value, options = {}) {\n        if (!key || (/^(?:expires|max\\-age|path|domain|secure)$/i).test(key)) return false;\n\n        const { path, domain, end, secure, samesite } = options;\n        const expireStr = getExpiration(end);\n        const domainStr = domain ? `; domain=${domain}` : '';\n        const pathStr = path ? `; path=${path}` : '';\n        const secureStr = secure ? '; secure' : '';\n        const samesiteStr = samesite ? '; samesite' : '';\n\n        document.cookie = `${encodeURIComponent(key)}=${encodeURIComponent(value)}${expireStr}${domainStr}${pathStr}${secureStr}${samesiteStr}`;\n        return true;\n    },\n    removeItem(key, options = {}) {\n        if (!this.hasItem(key)) return false;\n        const { path, domain } = options;\n        const domainStr = domain ? `; domain=${domain}` : '';\n        const pathStr = path ? `; path=${path}` : '';\n        document.cookie = `${encodeURIComponent(key)}=; expires=Thu, 01 Jan 1970 00:00:00 GMT${domainStr}${pathStr}`;\n        return true;\n    },\n    hasItem(key) {\n        if (!key || (/^(?:expires|max\\-age|path|domain|secure)$/i).test(key)) return false;\n\n        return (new RegExp(`(?:^|;\\\\s*)${encodeURIComponent(key).replace(/[\\-\\.\\+\\*]/g, '\\\\$&')}\\\\s*\\\\=`)).test(document.cookie);\n    },\n    clear() {\n        const aKeys = document.cookie.replace(/((?:^|\\s*;)[^\\=]+)(?=;|$)|^\\s*|\\s*(?:\\=[^;]*)?(?:\\1|$)/g, '').split(/\\s*(?:\\=[^;]*)?;\\s*/);\n        for (let nLen = aKeys.length, nIdx = 0; nIdx < nLen; nIdx++) {\n            aKeys[nIdx] = decodeURIComponent(aKeys[nIdx]);\n            this.removeItem(aKeys[nIdx]);\n        }\n        return aKeys;\n    },\n};\n","\n/* Generic throwable error */\nexport default class EpicenterError extends Error {\n\n    constructor(message) {\n\n        super(message);\n\n    }\n}","\n/* For failed network calls */\nexport default class Fault extends Error {\n\n    constructor(status, error) {\n\n        super();\n\n        const { information, message, cause } = error;\n        this.status = status;\n        this.message = message;\n\n        if (information) {\n            const { code, ...rest } = information;\n            this.code = code;\n            this.information = rest;\n        }\n        if (cause) {\n            this.cause = new Fault(cause);\n        }\n    }\n}","\n/* For network call responses */\nexport default class Result {\n\n    constructor(status, headers, body) {\n\n        this.status = status;\n        this.headers = headers;\n        this.body = body;\n\n    }\n}","import { Router } from 'utils';\n\nexport async function createAccount(options) {\n    const { objectType = 'personal', name, shortName, adminKey, subscriptionPlan, billingInterval } = options;\n    const response = await new Router()\n        .post('/account', {\n            body: { objectType, name, shortName, adminKey, subscriptionPlan, billingInterval },\n        });\n    return response;\n}\n\n// TODO -- just a copy-paste of create ATM; need to figuure out how to actually use\nexport async function updateAccount(options) {\n    const { objectType = 'personal', name, shortName, adminKey, subscriptionPlan, billingInterval } = options;\n    const response = await new Router()\n        .patch('/account', {\n            body: { objectType, name, shortName, adminKey, subscriptionPlan, billingInterval },\n        });\n    return response;\n}\n\nexport async function removeAccount(accountShortName) {\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .delete('/account');\n}","import { Router, identification } from 'utils';\nimport { cometdAdapter } from 'adapters';\n\nexport async function logout() {\n    identification.session = undefined;\n    await cometdAdapter.disconnect();\n}\n\nexport async function login(options) {\n    const { handle, password, groupKey, objectType = 'user', ...others } = options;\n    const { accountShortName, projectShortName } = others;\n\n    const response = await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .post('/authentication', {\n            body: { handle, password, groupKey, objectType },\n            includeAuthorization: false,\n            inert: true,\n        });\n    await logout();\n\n    identification.session = response.body;\n    return response;\n}\n\nexport async function upgrade(options) {\n    const { objectType = 'admin', inert, ...others } = options;\n    const { accountShortName, projectShortName } = others;\n\n    const response = await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .patch('/authentication', {\n            body: { objectType },\n            inert,\n        });\n    await logout();\n\n    identification.session = response.body;\n    return response;\n}\n\nexport async function sso(options) {\n    const { accountShortName, projectShortName } = options;\n\n    const response = await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .get('/registration/sso');\n\n    identification.session = response.body;\n    return response;\n}\n\nexport async function getSession() {\n    const response = await new Router().get('/authentication');\n\n    identification.session = response.body;\n    return response;\n}\n\nexport function getLocalSession() {\n    return identification.session;\n}\n","import { Router } from 'utils';\nimport { cometdAdapter } from 'adapters';\n\nexport async function forGroup(groupKey, options = {}) {\n    const { accountShortName, projectShortName } = options;\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .get(`/presence/group/${groupKey}`);\n}\n\nexport async function forWorld(worldKey, options = {}) {\n    const { accountShortName, projectShortName } = options;\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .get(`/presence/world/${worldKey}`);\n}\n\nexport async function connect() {\n    return cometdAdapter.handshake();\n}\n","import { Router } from 'utils';\n\nexport async function channelsEnabled(optionals = {}) {\n    const { accountShortName, projectShortName } = optionals;\n    const response = await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .get('/project/channel/isEnabled');\n    return response;\n}","import { EpicenterError, Router, prefix } from 'utils';\nimport { LOCK_TYPE, SCOPE_BOUNDARY, RITUAL } from 'utils/constants';\n\n\nexport async function create(model, scope, optionals = {}) {\n    const { scopeBoundary, scopeKey, pseudonymKey } = scope;\n    const {\n        accountShortName, projectShortName, readLock, writeLock,\n        morphology, ephemeral, trackingKey, modelContext, executionContext,\n    } = optionals;\n\n    const defaultLock = scopeBoundary === SCOPE_BOUNDARY.WORLD ?\n        LOCK_TYPE.PARTICIPANT :\n        LOCK_TYPE.USER;\n\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .post('/run', {\n            body: {\n                scope: {\n                    scopeBoundary,\n                    scopeKey,\n                    pseudonymKey,\n                },\n                permit: {\n                    readLock: readLock || defaultLock,\n                    writeLock: writeLock || defaultLock,\n                },\n                morphology,\n                trackingKey,\n                modelFile: model,\n                modelContext: modelContext || {/* Is not recorded for clone. Overrides model ctx2 file. */},\n                executionContext: executionContext || {/* Affected by clone. Carries arguments for model file worker on model initialization */},\n                ephemeral,\n            },\n        });\n}\n\nexport async function clone(runKey, optionals = {}) {\n    const {\n        accountShortName, projectShortName, ephemeral,\n        trackingKey, modelContext = {}, executionContext = {},\n    } = optionals;\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .post(`/run/clone/${runKey}`, {\n            body: {\n                trackingKey,\n                modelContext,\n                executionContext,\n                ephemeral,\n            },\n        });\n}\n\nexport async function restore(runKey, optionals = {}) {\n    const {\n        accountShortName, projectShortName, ephemeral,\n        modelContext = {}, executionContext = {},\n    } = optionals;\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .post(`/run/restore/${runKey}`, {\n            body: {\n                modelContext,\n                executionContext,\n                ephemeral,\n            },\n        });\n}\n\nexport async function rewind(runKey, steps, optionals = {}) {\n    const {\n        accountShortName, projectShortName,\n        ephemeral, modelContext = {},\n    } = optionals;\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .post(`/run/rewind/${runKey}`, {\n            body: {\n                rewindCount: steps,\n                modelContext,\n                ephemeral,\n            },\n        });\n}\n\nexport async function update(runKey, update, optionals = {}) {\n    const { readLock, writeLock, trackingKey, marked, hidden, closed } = update;\n    const { accountShortName, projectShortName } = optionals;\n    const hasMultiple = Array.isArray(runKey) && runKey.length > 1;\n    const uriComponent = hasMultiple ? '' : `/${runKey.length === 1 ? runKey[0] : runKey}`;\n\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .withSearchParams(hasMultiple ? { runKey } : '')\n        .patch(`/run${uriComponent}`, {\n            body: {\n                readLock,\n                writeLock,\n                trackingKey,\n                marked,\n                hidden,\n                closed,\n            },\n        });\n}\n\nexport async function remove(runKey, optionals = {}) {\n    const { accountShortName, projectShortName } = optionals;\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .delete(`/run/${runKey}`);\n}\n\nexport async function get(runKey, optionals = {}) {\n    const { accountShortName, projectShortName } = optionals;\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .get(`/run/${runKey}`);\n}\n\nconst MAX_URL_LENGTH = 2048;\nexport async function query(model, scope, optionals = {}) {\n    const { scopeBoundary, scopeKey } = scope;\n    const {\n        filter = {}, sort = [], first, max, timeout, projections = {},\n        accountShortName, projectShortName,\n    } = optionals;\n\n    const query = {\n        filter: [\n            ...(filter.variables || []).map((statement) => prefix('var.', statement)),\n            ...(filter.metadata || []).map((statement) => prefix('meta.', statement)),\n            ...(filter.attr || []).map((statement) => prefix('run.', statement)),\n        ].join(';'),\n        sort: sort.join(';'),\n        first,\n        max,\n        timeout,\n        projections: [\n            ...(projections.variables || []).map((name) => prefix('var.', name)),\n            ...(projections.metadata || []).map((name) => prefix('meta.', name)),\n            ...(projections.attr || []).map((name) => prefix('run.', name)),\n        ].join(';'),\n    };\n    const uriComponent = `/run/${scopeBoundary}/${scopeKey}/${model}`;\n    const router = new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .withSearchParams(query);\n\n    const url = await router.getURL(uriComponent);\n    return encodeURI(url.toString()).length < MAX_URL_LENGTH ?\n        router.get(uriComponent) :\n        new Router()\n            .withAccountShortName(accountShortName)\n            .withProjectShortName(projectShortName)\n            .post(uriComponent, {\n                body: {/* TODO: put post body here */},\n            });\n}\n\nexport async function introspect(model, optionals = {}) {\n    const { accountShortName, projectShortName } = optionals;\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .get(`/run/introspect/${model}`);\n}\n\nexport async function operation(runKey, name, args = [], optionals = {}) {\n    const { accountShortName, projectShortName, timeout, ritual } = optionals;\n    const hasMultiple = Array.isArray(runKey) && runKey.length > 1;\n    const uriComponent = hasMultiple ? '' : `/${runKey.length === 1 ? runKey[0] : runKey}`;\n    const searchParams = hasMultiple ? { runKey, timeout } : { ritual, timeout };\n\n    if (ritual !== RITUAL.EXORCISE && hasMultiple) {\n        console.warn(`Detected ritual: ${ritual} usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE`);\n    }\n\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .withSearchParams(searchParams)\n        .post(`/run/operation${uriComponent}`, {\n            body: { name, arguments: args },\n        });\n}\n\nexport async function getVariables(runKey, variables, optionals) {\n    const { accountShortName, projectShortName, timeout, ritual } = optionals;\n    const include = variables.join(';');\n    const hasMultiple = Array.isArray(runKey) && runKey.length > 1;\n    const uriComponent = hasMultiple ? '' : `/${runKey.length === 1 ? runKey[0] : runKey}`;\n    const searchParams = hasMultiple ? { runKey, timeout, include } : { ritual, timeout, include };\n\n    if (ritual !== RITUAL.EXORCISE && hasMultiple) {\n        console.warn(`Detected ritual: ${ritual} usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE`);\n    }\n\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .withSearchParams(searchParams)\n        .get(`/run/variable${uriComponent}`);\n}\n\nexport async function getVariable(runKey, variable, optionals = {}) {\n    const { accountShortName, projectShortName, timeout, ritual } = optionals;\n\n    if (Array.isArray(runKey) || Array.isArray(variable)) {\n        const variables = Array.isArray(variable) ? variable : [variable];\n        return getVariables(runKey, variables, optionals);\n    }\n\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .withSearchParams({ timeout, ritual })\n        .get(`/run/variable/${runKey}/${variable}`);\n}\n\nexport async function updateVariables(runKey, update, optionals = {}) {\n    const { accountShortName, projectShortName, timeout, ritual } = optionals;\n    const hasMultiple = Array.isArray(runKey) && runKey.length > 1;\n    const uriComponent = hasMultiple ? '' : `/${runKey.length === 1 ? runKey[0] : runKey}`;\n    const searchParams = hasMultiple ? { runKey, timeout } : { ritual, timeout };\n\n    if (ritual !== RITUAL.EXORCISE && hasMultiple) {\n        console.warn(`Detected ritual: ${ritual} usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE`);\n    }\n\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .withSearchParams(searchParams)\n        .patch(`/run/variable${uriComponent}`, { body: update });\n}\n\nexport async function getMetadata(runKey, variables, optionals = {}) {\n    const { accountShortName, projectShortName, timeout, ritual } = optionals;\n    const include = variables.join(';');\n    const hasMultiple = Array.isArray(runKey) && runKey.length > 1;\n    const uriComponent = hasMultiple ? '' : `/${runKey.length === 1 ? runKey[0] : runKey}`;\n    const searchParams = hasMultiple ? { runKey, timeout, include } : { ritual, timeout, include };\n\n    if (ritual !== RITUAL.EXORCISE && hasMultiple) {\n        console.warn(`Detected ritual: ${ritual} usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE`);\n    }\n\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .withSearchParams(searchParams)\n        .get(`/run/meta${uriComponent}`);\n}\n\nexport async function updateMetadata(runKey, update, optionals = {}) {\n    const { accountShortName, projectShortName, timeout, ritual } = optionals;\n    const hasMultiple = Array.isArray(runKey) && runKey.length > 1;\n    const uriComponent = hasMultiple ? '' : `/${runKey.length === 1 ? runKey[0] : runKey}`;\n    const searchParams = hasMultiple ? { runKey, timeout } : { ritual, timeout };\n\n    if (ritual !== RITUAL.EXORCISE && hasMultiple) {\n        console.warn(`Detected ritual: ${ritual} usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE`);\n    }\n\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .withSearchParams(searchParams)\n        .patch(`/run/meta${uriComponent}`, { body: update });\n}\n\nexport async function action(runKey, actionList, optionals = {}) {\n    const { accountShortName, projectShortName, timeout, ritual } = optionals;\n    const hasMultiple = Array.isArray(runKey) && runKey.length > 1;\n    const uriComponent = hasMultiple ? '' : `/${runKey.length === 1 ? runKey[0] : runKey}`;\n    const searchParams = hasMultiple ? { runKey, timeout } : { ritual, timeout };\n\n    if (ritual !== RITUAL.EXORCISE && hasMultiple) {\n        console.warn(`Detected ritual: ${ritual} usage with multiple runKeys; this not allowed. Defaulting to ritual: EXORCISE`);\n    }\n\n    return await new Router()\n        .withAccountShortName(accountShortName)\n        .withProjectShortName(projectShortName)\n        .withSearchParams(searchParams)\n        .post(`/run/action${uriComponent}`, { body: actionList });\n}\n\nasync function serial(runKey, operations, optionals) {\n    const normalizedOps = operations.map((item) => ({\n        name: typeof item === 'string' ? item : item.name,\n        params: item.params,\n    }));\n\n    //Perform all operations, sequentially\n    return normalizedOps.reduce((promiseChain, { name, params }) => {\n        return promiseChain.then(() => operation(runKey, name, params, optionals));\n    }, Promise.resolve());\n}\n\nexport async function getWithStrategy(strategy, model, scope, optionals = {}) {\n    const { initOperations = [] } = optionals;\n    if (strategy === 'reuse-across-sessions') {\n        const runs = await query(model, scope, { ...optionals, sort: ['-created'] });\n        if (runs.length) {\n            return runs[0];\n        }\n        const newRun = await create(model, scope, optionals);\n        await serial(newRun.runKey, initOperations, optionals);\n        return newRun;\n    } else if (strategy === 'reuse-never') {\n        const newRun = await create(model, scope, optionals);\n        await serial(newRun.runKey, initOperations, optionals);\n        return newRun;\n    } else if (strategy === 'reuse-by-tracking-key') {\n        //TBD write out if needed\n        //Platform plans to introduce run limits into episode scope, differing from v2's implementation of runLimit via 'reuse-by-tracking-key'\n    } else if (strategy === 'multiplayer') {\n        //TODO when multiplayer API is ready\n        //check the current world for this end user, return the current run for that world (if there is none, create a run for the world)\n    }\n    throw new EpicenterError('Invalid run strategy.');\n}\n","import AckExtension from 'cometd/AckExtension';\nimport ReloadExtension from 'cometd/ReloadExtension';\nimport config from '~/config';\nimport { EpicenterError, identification, isNode, isBrowser, errorManager } from 'utils';\nimport { channelsEnabled } from 'adapters/project';\n\nconst AUTH_TOKEN_KEY = 'com.forio.epicenter.token';\n\nconst DISCONNECTED = 'disconnected';\nconst CONNECTED = 'connected';\n\n\nclass CometdError extends Error {\n    constructor(reply) {\n\n        super();\n        const { error, successful } = reply;\n        if (error && error.includes('403') && !successful) {\n            this.status = 401;\n        }\n        this.information = reply;\n        this.message = error;\n    }\n}\n\nclass CometdAdapter {\n\n    url;\n    customCometd;\n    defaultCometd;\n    subscriptions = new Map();\n    state = DISCONNECTED;\n    requireAcknowledgement = true;\n    initialized = false;\n\n    get cometd() {\n        return this.customCometd || this.defaultCometd;\n    }\n\n    async reinit(customCometd, options) {\n        await this.disconnect();\n        this.initialized = false;\n        this.customCometd = customCometd;\n        return this.init(options);\n    }\n\n    async init(options = { logLevel: 'error' }) {\n        if (this.initialized) {\n            return;\n        }\n\n        if (!isNode() && isBrowser()) {\n            const cometd = await import('cometd');\n            this.defaultCometd = new cometd.CometD();\n        }\n\n        const { apiProtocol, apiHost, apiVersion } = config;\n        this.url = `${apiProtocol}://${apiHost}/push/v${apiVersion}/cometd`;\n        this.cometd.registerExtension('ack', new AckExtension());\n        this.cometd.registerExtension('reload', new ReloadExtension());\n        this.cometd.configure({\n            url: this.url,\n            logLevel: options.logLevel,\n        });\n\n        if (!isNode() && isBrowser()) {\n            window.onunload = () => {\n                if (this.cometd.getStatus() === CONNECTED) {\n                    this.cometd.reload();\n                    this.cometd.getTransport().abort();\n                }\n            };\n        }\n        this.initialized = true;\n    }\n\n    async checkEnabled() {\n        const res = await channelsEnabled();\n        const enabled = res.body;\n        if (!enabled) throw new EpicenterError('Push Channels are not enabled on this project');\n    }\n\n    // Connects to CometD server\n    async handshake(options = {}) {\n        await this.checkEnabled();\n        await this.init();\n\n        if (this.cometd.getStatus() !== DISCONNECTED) {\n            return Promise.resolve();\n        }\n\n        const handshakeProps = {};\n        const { session } = identification;\n\n        if (session) {\n            handshakeProps.ext = {\n                [AUTH_TOKEN_KEY]: session.token,\n                ack: this.requireAcknowledgement,\n            };\n        }\n\n        this.cometd.ackEnabled = this.requireAcknowledgement;\n        this.cometd.websocketEnabled = true;\n        return new Promise((resolve, reject) => this.cometd.handshake(handshakeProps, (handshakeReply) => {\n            if (handshakeReply.successful) {\n                resolve(handshakeReply);\n                return;\n            }\n\n            const error = new CometdError(handshakeReply);\n\n            if (options.inert) {\n                reject(error);\n                return;\n            }\n\n            const retry = () => this.handshake({ inert: true });\n            try {\n                const result = errorManager.handle(error, retry);\n                resolve(result);\n            } catch (e) {\n                reject(e);\n            }\n        }));\n    }\n\n    async disconnect() {\n        if (!this.cometd) return Promise.resolve();\n\n        await this.init();\n        await this.empty();\n        if (this.cometd.getStatus() !== CONNECTED) return Promise.resolve();\n\n        return new Promise((resolve, reject) => this.cometd.disconnect((disconnectReply) => {\n            if (!disconnectReply.successful) {\n                reject(new EpicenterError('Unable to disconnect from CometD server'));\n            } else {\n                resolve();\n            }\n        }));\n    }\n\n    async add(channel, update, options = {}) {\n        await this.init();\n        const channels = [].concat(channel);\n\n        if (this.cometd.getStatus() !== CONNECTED) {\n            await this.handshake();\n        }\n        const subscriptionProps = {};\n        const { session } = identification;\n        if (session) {\n            subscriptionProps.ext = { [AUTH_TOKEN_KEY]: session.token };\n        }\n\n        const handleCometdUpdate = ({ channel, data }) => {\n            data = typeof data === 'string' ? JSON.parse(data) : data;\n            return update(data);\n        };\n        const promises = [];\n        this.cometd.batch(() => channels.forEach(({ path }) => promises.push(new Promise((resolve, reject) => {\n            const subscription = this.cometd.subscribe(path, handleCometdUpdate, subscriptionProps, (subscribeReply) => {\n                if (subscribeReply.successful) {\n                    this.subscriptions.set(subscription.channel, subscription);\n                    resolve(subscription);\n                    return;\n                }\n\n                const error = new CometdError(subscribeReply);\n\n                if (options.inert) {\n                    reject(error);\n                    return;\n                }\n\n                const retry = () => this.add(channel, update, { inert: true });\n                try {\n                    const result = errorManager.handle(error, retry);\n                    resolve(result);\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        }))));\n        return promises.length === 1 ?\n            Promise.all(promises).then(([res]) => res) :\n            Promise.all(promises);\n    }\n\n    async publish(channel, content, options = {}) {\n        await this.init();\n        const channels = [].concat(channel);\n\n        if (this.cometd.getStatus() !== CONNECTED) {\n            await this.handshake();\n        }\n        const publishProps = {};\n        const { session } = identification;\n        if (session) {\n            publishProps.ext = { [AUTH_TOKEN_KEY]: session.token };\n        }\n        const promises = [];\n        this.cometd.batch(() => channels.forEach(({ path }) => promises.push(new Promise((resolve, reject) => {\n            this.cometd.publish(path, content, publishProps, (publishReply) => {\n                if (publishReply.successful) {\n                    resolve(publishReply);\n                    return;\n                }\n\n                const error = new CometdError(publishReply);\n\n                if (options.inert) {\n                    reject(error);\n                    return;\n                }\n\n                const retry = () => this.publish(channel, content, { inert: true });\n                try {\n                    const result = errorManager.handle(error, retry);\n                    resolve(result);\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        }))));\n        return promises.length === 1 ?\n            Promise.all(promises).then(([res]) => res) :\n            Promise.all(promises);\n    }\n\n    async remove(subscription) {\n        await this.init();\n        this.subscriptions.delete(subscription.channel);\n        return new Promise((resolve, reject) => this.cometd.unsubscribe(subscription, (unsubscribeReply) => {\n            if (unsubscribeReply.successful) {\n                resolve(unsubscribeReply);\n            }\n            const error = new CometdError(unsubscribeReply);\n            reject(error);\n            /* Not using error handling here yet -- should we? */\n        }));\n    }\n\n    async empty() {\n        await this.init();\n        const promises = [];\n        this.cometd.batch(() => this.subscriptions.forEach((subscription) => {\n            promises.push(this.remove(subscription));\n        }));\n        return Promise.all(promises);\n    }\n}\nconst cometdAdapter = new CometdAdapter();\nexport default cometdAdapter;\n\n","import { EpicenterError } from 'utils';\nimport { cometdAdapter } from 'adapters';\nimport { SCOPE_BOUNDARY, PUSH_CATEGORY } from 'utils/constants';\n\nconst validateScope = (scope) => {\n    if (!scope) throw new EpicenterError('No scope found where one was required');\n    const { scopeBoundary, scopeKey, pushCategory } = scope;\n    if (!scopeBoundary) throw new EpicenterError('Missing scope component: scopeBoundary');\n    if (!scopeKey) throw new EpicenterError('Missing scope component: scopeKey');\n    if (!pushCategory) throw new EpicenterError('Missing scope component: pushCategory');\n    if (!SCOPE_BOUNDARY.hasOwnProperty(scopeBoundary)) throw new EpicenterError(`Invalid scope boundary: ${scopeBoundary}`);\n    if (!PUSH_CATEGORY.hasOwnProperty(pushCategory)) throw new EpicenterError(`Invalid push category: ${pushCategory}`);\n};\n\nexport default class Channel {\n\n    path;\n    update;\n    subscription;\n\n    constructor(scope) {\n        const { scopeBoundary, scopeKey, pushCategory } = scope;\n        validateScope(scope);\n        this.path = `/${scopeBoundary.toLowerCase()}/${scopeKey}/${pushCategory.toLowerCase()}`;\n        if (cometdAdapter.subscriptions.has(this.path)) {\n            this.subscription = cometdAdapter.subscriptions.get(this.path);\n        }\n    }\n\n    publish(content) {\n        return cometdAdapter.publish(this, content);\n    }\n\n    async subscribe(update, options) {\n        if (this.subscription) await this.unsubscribe();\n        this.update = update;\n        return cometdAdapter.add(this, update, options).then((subscription) => {\n            this.subscription = subscription;\n            return subscription;\n        });\n    }\n\n    async unsubscribe() {\n        if (this.subscription) {\n            await cometdAdapter.remove(this.subscription);\n            this.subscription = null;\n        }\n    }\n}\n\n\n","import { authAdapter } from 'adapters';\nimport { identification, isNode, access } from 'utils';\n\n\nconst handleByRelog = (error) => {\n    let query = '';\n    if (error.code) {\n        query = query.concat(`?error=${error.code}`);\n    }\n    return authAdapter.logout().then(() => window.location.href = `/login.html${query}`);\n};\n\nconst handleSSO = () => {\n    return authAdapter.logout();\n};\n\nconst handleUnknown = () => {\n    return authAdapter.logout().then(() => window.location.href = '/unknown.html');\n};\n\nconst handleByLoginMethod = (error) => {\n    const { session } = identification;\n    const loginType = access(session, ['loginMethod', 'objectType']);\n    switch (loginType) {\n        case 'sso': return handleSSO(error);\n        case 'none':return handleUnknown(error);\n        case 'native':\n        default: return handleByRelog(error);\n    }\n};\n\nconst UNAUTHORIZED = 401;\nclass ErrorManager {\n    _handlers = [\n        {/* Default Unauthorized (401) Error Handler */\n            identifier: (error) => error.status === UNAUTHORIZED,\n            handle: (error, retry) => {\n                if (error.code === 'AUTHENTICATION_INVALIDATED') {\n                    return authAdapter.upgrade({ objectType: 'user', inert: true })\n                        .then(() => retry())\n                        .catch(() => handleByLoginMethod(error));\n                }\n                if (isNode()) return Promise.reject(error);\n                return handleByLoginMethod(error);\n            },\n        },\n    ];\n\n    get handlers() {\n        return this._handlers;\n    }\n\n    registerHandler(identifier, handleFn) {\n        this.handlers.unshift({\n            identifier,\n            handle: handleFn,\n        });\n    }\n\n    async handle(error, retryFn, handlers/* which is undefined unless recursing */) {\n        handlers = handlers || this.handlers;\n        const index = handlers.findIndex(({ identifier }) => identifier(error));\n        const handler = handlers[index];\n        const remainingHandlers = index > 0 ? handlers.slice(index + 1) : [];\n        if (!handler) throw error;\n        let promise;\n        try {\n            promise = await handler.handle(error, retryFn).catch((err) => {\n                /* This catch call ensures that handle always returns a promise,\n                otherwise it'd be caught in the catch block below */\n                throw err;\n            });\n        } catch (e) {\n            promise = await this.handle(error, retryFn, remainingHandlers);\n        }\n        return promise;\n    }\n}\n\nconst errorManager = new ErrorManager();\nexport default errorManager;\n","import config from '~/config';\nimport { EpicenterError, NodeStore, SessionStore, CookieStore, cookies, isNode } from 'utils';\nimport { BROWSER_STORAGE_TYPE } from 'utils/constants';\nconst { COOKIE, SESSION } = BROWSER_STORAGE_TYPE;\n\n\nconst SESSION_KEY = Symbol('com.forio.epicenter.session');\nconst EPI_SSO_KEY = 'epicenter.v3.sso';\nclass Identification {\n    type\n\n    constructor(storeType) {\n        if (storeType !== COOKIE && storeType !== SESSION) {\n            throw new EpicenterError(`Invalid Storage Type: \"${storeType}\", please use \"${COOKIE}\" or \"${SESSION}\".`);\n        }\n        this.type = storeType;\n        this.consumeSSO();\n    }\n    get session() {\n        const Store = this.getStore();\n        return new Store().getItem(SESSION_KEY.description);\n    }\n    set session(session) {\n        const Store = this.getStore();\n        const path = this.getSessionPath(session);\n\n        if (session) {\n            new Store({ path }).setItem(SESSION_KEY.description, session);\n        } else if (this.session) {\n            new Store({ path }).removeItem(SESSION_KEY.description);\n        }\n    }\n    getStore() {\n        if (isNode()) return NodeStore;\n        switch (this.type) {\n            case SESSION: return SessionStore;\n            case COOKIE:\n            default: return CookieStore;\n        }\n    }\n    /* Generates the appropriate path for storing your session (applicable only to cookies) */\n    getSessionPath(session) {\n        const mySession = session || this.session;\n        if (!mySession || isNode()) return '';\n\n        const { accountShortName, projectShortName, objectType } = mySession;\n        const isLocal = config.isLocal();\n        const isCustomDomain = !isLocal && window.location.pathname.split('/')[1] !== 'app';\n        const isEpicenterDomain = !isLocal && !isCustomDomain;\n        if (objectType === 'user' && accountShortName && projectShortName && isEpicenterDomain) {\n            return `/app/${accountShortName}/${projectShortName}`;\n        }\n        /* Admins and any custom domains (ones that don't use 'app/account/project') get the root path */\n        return '/';\n    }\n    consumeSSO() {\n        if (isNode()) return;\n        /* Double parse here b/c the backend serializes it as a string; the first parse\n         * converts it into a json string, the second parse converts the json string into\n         * json. Yes, it's weird, no, we can't change it (unless we want to rewrite\n         * Interface Builder code to accommodate) */\n        const session = JSON.parse(JSON.parse(`\"${cookies.getItem(EPI_SSO_KEY)}\"`));\n        if (session) {\n            const { accountShortName, projectShortName } = session;\n            this.session = session;\n            cookies.removeItem(EPI_SSO_KEY, { domain: `.${window.location.hostname}`, path: `/app/${accountShortName}/${projectShortName}` });\n        }\n    }\n}\n\nconst identification = new Identification(COOKIE);\nexport default identification;\n\n","import fetch from 'cross-fetch';\nimport config from '~/config';\nimport { EpicenterError, Fault, Result, identification, toQueryString, prefix, errorManager } from 'utils';\n\n\nconst DEFAULT_ACCOUNT_SHORT_NAME = 'epicenter';\nconst DEFAULT_PROJECT_SHORT_NAME = 'manager';\n\nasync function request(url, { method, body, includeAuthorization, inert }) {\n    const headers = {\n        'Content-type': 'application/json; charset=UTF-8',\n    };\n    const { session } = identification;\n    if (includeAuthorization && session) {\n        headers.Authorization = `Bearer ${session.token}`;\n    }\n\n    const response = await fetch(url, {\n        method: method,\n        cache: 'no-cache',\n        headers: headers,\n        redirect: 'follow',\n        body: body ? JSON.stringify(body) : null,\n    });\n\n    const contentType = response.headers.get('content-type');\n    if (!contentType || !contentType.includes('application/json')) {\n        throw new EpicenterError(`Response content-type '${contentType}' does not include 'application/json'`);\n    }\n\n    if ((response.status >= 200) && (response.status < 400)) {\n        return new Result(response.status, response.headers, await response.json());\n    }\n\n    const error = new Fault(response.status, await response.json());\n    if (inert) throw error;\n\n    const retry = () => request(url, { method, body, includeAuthorization, inert: true });\n    return errorManager.handle(error, retry);\n}\n\nexport default class Router {\n    get server() {\n        return this._server;\n    }\n\n    set server(value) {\n        this._server = value;\n    }\n\n    get version() {\n        return this._version;\n    }\n\n    set version(value) {\n        this._version = value;\n    }\n\n    get accountShortName() {\n        return this._accountShortName;\n    }\n\n    set accountShortName(value) {\n        this._accountShortName = value;\n    }\n\n    get projectShortName() {\n        return this._projectShortName;\n    }\n\n    set projectShortName(value) {\n        this._projectShortName = value;\n    }\n\n    get searchParams() {\n        return this._searchParams || '';\n    }\n\n    set searchParams(value) {\n        this._searchParams = toQueryString(value);\n    }\n\n    withServer(server) {\n        if (server) this.server = server;\n        return this;\n    }\n\n    withVersion(version) {\n        if (version) this.version = version;\n        return this;\n    }\n\n    withAccountShortName(accountShortName) {\n        if (accountShortName) this.accountShortName = accountShortName;\n        return this;\n    }\n\n    withProjectShortName(projectShortName) {\n        if (projectShortName) this.projectShortName = projectShortName;\n        return this;\n    }\n\n    withSearchParams(searchParams) {\n        if (!searchParams) return this;\n        const isEmpty = typeof searchParams === 'object' && Object.entries(searchParams).length === 0;\n        if (!isEmpty) this.searchParams = searchParams;\n        return this;\n    }\n\n    configure() {\n        if (!this.server) this.withServer(`${config.apiProtocol}://${config.apiHost}`);\n        if (!this.accountShortName) this.withAccountShortName(config.accountShortName);\n        if (!this.projectShortName) this.withProjectShortName(config.projectShortName);\n        if (!this.version) this.withVersion(config.apiVersion);\n    }\n\n    getURL(uriComponent) {\n        this.configure();\n        const url = new URL(`${this.server}`);\n        url.pathname = `api/v${this.version}/${this.accountShortName}/${this.projectShortName}${prefix('/', uriComponent)}`;\n        url.search = this.searchParams;\n        return url;\n    }\n\n    //Network Requests\n    async get(uriComponent, options) {\n        const url = this.getURL(uriComponent);\n        return request(url, {\n            includeAuthorization: true,\n            ...options,\n            method: 'GET',\n        });\n    }\n\n    async delete(uriComponent, options) {\n        const url = this.getURL(uriComponent);\n        return request(url, {\n            includeAuthorization: true,\n            ...options,\n            method: 'DELETE',\n        });\n    }\n\n    async patch(uriComponent, options) {\n        const url = this.getURL(uriComponent);\n        return request(url, {\n            includeAuthorization: true,\n            ...options,\n            method: 'PATCH',\n        });\n    }\n\n    async post(uriComponent, options) {\n        const url = this.getURL(uriComponent);\n        return request(url, {\n            includeAuthorization: true,\n            ...options,\n            method: 'POST',\n        });\n    }\n\n    async put(uriComponent, options) {\n        const url = this.getURL(uriComponent);\n        return request(url, {\n            includeAuthorization: true,\n            ...options,\n            method: 'PUT',\n        });\n    }\n}\n","import { EpicenterError, isBrowser, isNode } from 'utils';\n\nconst API_VERSION = 3;\nclass Config {\n    _apiVersion = API_VERSION;\n\n    constructor() {\n        if (isBrowser()) return this.loadBrowser();\n        if (isNode()) return this.loadNode();\n        throw new EpicenterError('Could not identify environment; no configuration was setup');\n    }\n\n    get apiProtocol() {\n        return this._apiProtocol;\n    }\n\n    set apiProtocol(apiProtocol) {\n        if (!apiProtocol.startsWith('http')) return;\n        if (apiProtocol.endsWith(':')) {\n            apiProtocol = apiProtocol.slice(0, -1);\n        }\n        this._apiProtocol = apiProtocol;\n    }\n\n    get apiHost() {\n        return this._apiHost;\n    }\n\n    set apiHost(apiHost) {\n        this._apiHost = apiHost;\n    }\n\n    get apiVersion() {\n        return this._apiVersion;\n    }\n\n    set apiVersion(apiVersion) {\n        this._apiVersion = apiVersion;\n    }\n\n    get accountShortName() {\n        return this._accountShortName;\n    }\n\n    set accountShortName(accountShortName) {\n        this._accountShortName = accountShortName;\n    }\n\n    get projectShortName() {\n        return this._projectShortName;\n    }\n\n    set projectShortName(projectShortName) {\n        this._projectShortName = projectShortName;\n    }\n\n    isLocal() {\n        if (!isBrowser()) return false;\n        const host = window.location.host;\n        return host === '127.0.0.1' ||\n            host.indexOf('local.') === 0 ||\n            host.indexOf('ngrok') !== -1 ||\n            host.indexOf('localhost') === 0;\n    }\n\n    getPathAccountProject(pathname) {\n        const match = pathname.match(/\\/app\\/([\\w-]+)\\/([\\w-]+)/);\n        if (match) {\n            const [account, project] = match.slice(1);\n            this.accountShortName = account;\n            this.projectShortName = project;\n        }\n    }\n\n    loadNode() {\n        // TODO -- use process env variables instead here for Node server\n        this.apiProtocol = 'https';\n        this.apiHost = 'test.forio.com';\n        return;\n    }\n\n    loadBrowser() {\n        const isLocal = this.isLocal();\n        const { protocol, pathname, host } = window.location;\n        this.apiProtocol = isLocal ? 'https' : protocol;\n        this.apiHost = isLocal ? 'forio.com' : host;\n\n        const match = pathname.match(/\\/app\\/([\\w-]+)\\/([\\w-]+)/);\n        if (match) {\n            const [account, project] = match.slice(1);\n            this.accountShortName = account;\n            this.projectShortName = project;\n        }\n    }\n}\n\nconst config = new Config();\nexport default config;\n","const version = VERSION;\nexport { default as config } from '~/config';\nexport { version };\nexport {\n    BROWSER_STORAGE_TYPE,\n    SCOPE_BOUNDARY,\n    RITUAL,\n    PUSH_CATEGORY,\n    LOCK_TYPE,\n} from 'utils/constants';\nexport {\n    errorManager,\n} from 'utils';\nexport {\n    Channel,\n    accountAdapter,\n    authAdapter,\n    presenceAdapter,\n    projectAdapter,\n    runAdapter,\n} from 'adapters';\n\n"],"sourceRoot":""}